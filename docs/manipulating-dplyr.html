<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.5 Manipulating (dplyr) | Computational Thinking for Social Scientists</title>
  <meta name="description" content="4.5 Manipulating (dplyr) | Computational Thinking for Social Scientists. An online textbook for teaching computational tools and techniques to social scientists." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="4.5 Manipulating (dplyr) | Computational Thinking for Social Scientists" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="4.5 Manipulating (dplyr) | Computational Thinking for Social Scientists. An online textbook for teaching computational tools and techniques to social scientists." />
  <meta name="github-repo" content="jaeyk/PS239T" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.5 Manipulating (dplyr) | Computational Thinking for Social Scientists" />
  <meta name="twitter:site" content="@JaeJaeykim2" />
  <meta name="twitter:description" content="4.5 Manipulating (dplyr) | Computational Thinking for Social Scientists. An online textbook for teaching computational tools and techniques to social scientists." />
  

<meta name="author" content="Jae Yeon Kim" />


<meta name="date" content="2025-04-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tidying-tidyr.html"/>
<link rel="next" href="modeling-broom.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Computational Thinking for Social Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Hello, World</a>
<ul>
<li class="chapter" data-level="1.1" data-path="part-i-fundamentals.html"><a href="part-i-fundamentals.html"><i class="fa fa-check"></i><b>1.1</b> Part I: Fundamentals</a></li>
<li class="chapter" data-level="1.2" data-path="part-ii-applications.html"><a href="part-ii-applications.html"><i class="fa fa-check"></i><b>1.2</b> Part II: Applications</a></li>
<li class="chapter" data-level="1.3" data-path="special-thanks.html"><a href="special-thanks.html"><i class="fa fa-check"></i><b>1.3</b> Special Thanks</a></li>
<li class="chapter" data-level="1.4" data-path="suggestions-questions-or-comments.html"><a href="suggestions-questions-or-comments.html"><i class="fa fa-check"></i><b>1.4</b> Suggestions, Questions, or Comments</a></li>
<li class="chapter" data-level="1.5" data-path="license.html"><a href="license.html"><i class="fa fa-check"></i><b>1.5</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Computational Thinking</a>
<ul>
<li class="chapter" data-level="2.1" data-path="why-computational-thinking.html"><a href="why-computational-thinking.html"><i class="fa fa-check"></i><b>2.1</b> Why computational thinking</a></li>
<li class="chapter" data-level="2.2" data-path="computational-thinking-in-the-age-of-generative-ai.html"><a href="computational-thinking-in-the-age-of-generative-ai.html"><i class="fa fa-check"></i><b>2.2</b> Computational thinking in the age of generative AI</a></li>
<li class="chapter" data-level="2.3" data-path="how-to-teach-and-learn-computational-thinking.html"><a href="how-to-teach-and-learn-computational-thinking.html"><i class="fa fa-check"></i><b>2.3</b> How to teach and learn computational thinking</a></li>
<li class="chapter" data-level="2.4" data-path="computational-thinking-and-a-career-in-computational-social-science.html"><a href="computational-thinking-and-a-career-in-computational-social-science.html"><i class="fa fa-check"></i><b>2.4</b> Computational thinking and a career in computational social science</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="git_bash.html"><a href="git_bash.html"><i class="fa fa-check"></i><b>3</b> Managing data and code</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-command-line.html"><a href="the-command-line.html"><i class="fa fa-check"></i><b>3.1</b> The Command Line</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="the-command-line.html"><a href="the-command-line.html#the-big-picture"><i class="fa fa-check"></i><b>3.1.1</b> The Big Picture</a></li>
<li class="chapter" data-level="3.1.2" data-path="the-command-line.html"><a href="the-command-line.html#why-bother-using-the-command-line"><i class="fa fa-check"></i><b>3.1.2</b> Why bother using the command line?</a></li>
<li class="chapter" data-level="3.1.3" data-path="the-command-line.html"><a href="the-command-line.html#unix-shell"><i class="fa fa-check"></i><b>3.1.3</b> UNIX Shell</a></li>
<li class="chapter" data-level="3.1.4" data-path="the-command-line.html"><a href="the-command-line.html#references"><i class="fa fa-check"></i><b>3.1.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="git-and-github.html"><a href="git-and-github.html"><i class="fa fa-check"></i><b>3.2</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="git-and-github.html"><a href="git-and-github.html#the-big-picture-1"><i class="fa fa-check"></i><b>3.2.1</b> The Big Picture</a></li>
<li class="chapter" data-level="3.2.2" data-path="git-and-github.html"><a href="git-and-github.html#version-control-system"><i class="fa fa-check"></i><b>3.2.2</b> Version control system</a></li>
<li class="chapter" data-level="3.2.3" data-path="git-and-github.html"><a href="git-and-github.html#setup"><i class="fa fa-check"></i><b>3.2.3</b> Setup</a></li>
<li class="chapter" data-level="3.2.4" data-path="git-and-github.html"><a href="git-and-github.html#cloning-a-repository"><i class="fa fa-check"></i><b>3.2.4</b> Cloning a repository</a></li>
<li class="chapter" data-level="3.2.5" data-path="git-and-github.html"><a href="git-and-github.html#making-a-repository"><i class="fa fa-check"></i><b>3.2.5</b> Making a repository</a></li>
<li class="chapter" data-level="3.2.6" data-path="git-and-github.html"><a href="git-and-github.html#commit-changes"><i class="fa fa-check"></i><b>3.2.6</b> Commit changes</a></li>
<li class="chapter" data-level="3.2.7" data-path="git-and-github.html"><a href="git-and-github.html#push-and-pull-or-fetch"><i class="fa fa-check"></i><b>3.2.7</b> Push and pull (or fetch)</a></li>
<li class="chapter" data-level="3.2.8" data-path="git-and-github.html"><a href="git-and-github.html#branching"><i class="fa fa-check"></i><b>3.2.8</b> Branching</a></li>
<li class="chapter" data-level="3.2.9" data-path="git-and-github.html"><a href="git-and-github.html#other-useful-commands"><i class="fa fa-check"></i><b>3.2.9</b> Other useful commands</a></li>
<li class="chapter" data-level="3.2.10" data-path="git-and-github.html"><a href="git-and-github.html#collaborations"><i class="fa fa-check"></i><b>3.2.10</b> Collaborations</a></li>
<li class="chapter" data-level="3.2.11" data-path="git-and-github.html"><a href="git-and-github.html#deployment-github-pages"><i class="fa fa-check"></i><b>3.2.11</b> Deployment: GitHub Pages</a></li>
<li class="chapter" data-level="3.2.12" data-path="git-and-github.html"><a href="git-and-github.html#tracking-progress-github-issues"><i class="fa fa-check"></i><b>3.2.12</b> Tracking progress: GitHub Issues</a></li>
<li class="chapter" data-level="3.2.13" data-path="git-and-github.html"><a href="git-and-github.html#project-management-github-dashboards"><i class="fa fa-check"></i><b>3.2.13</b> Project management: GitHub Dashboards</a></li>
<li class="chapter" data-level="3.2.14" data-path="git-and-github.html"><a href="git-and-github.html#using-git-clients"><i class="fa fa-check"></i><b>3.2.14</b> Using Git clients</a></li>
<li class="chapter" data-level="3.2.15" data-path="git-and-github.html"><a href="git-and-github.html#the-big-picture-2"><i class="fa fa-check"></i><b>3.2.15</b> The Big Picture</a></li>
<li class="chapter" data-level="3.2.16" data-path="git-and-github.html"><a href="git-and-github.html#rstudio"><i class="fa fa-check"></i><b>3.2.16</b> RStudio</a></li>
<li class="chapter" data-level="3.2.17" data-path="git-and-github.html"><a href="git-and-github.html#basic-syntax"><i class="fa fa-check"></i><b>3.2.17</b> Basic Syntax</a></li>
<li class="chapter" data-level="3.2.18" data-path="git-and-github.html"><a href="git-and-github.html#environment"><i class="fa fa-check"></i><b>3.2.18</b> Environment</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="project-oriented-research.html"><a href="project-oriented-research.html"><i class="fa fa-check"></i><b>3.3</b> Project-oriented research</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="project-oriented-research.html"><a href="project-oriented-research.html#the-big-picture-3"><i class="fa fa-check"></i><b>3.3.1</b> The Big Picture</a></li>
<li class="chapter" data-level="3.3.2" data-path="project-oriented-research.html"><a href="project-oriented-research.html#references-1"><i class="fa fa-check"></i><b>3.3.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="writing-code-how-to-code-like-a-professional.html"><a href="writing-code-how-to-code-like-a-professional.html"><i class="fa fa-check"></i><b>3.4</b> Writing code: How to code like a professional</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="writing-code-how-to-code-like-a-professional.html"><a href="writing-code-how-to-code-like-a-professional.html#the-big-picture-4"><i class="fa fa-check"></i><b>3.4.1</b> The Big Picture</a></li>
<li class="chapter" data-level="3.4.2" data-path="writing-code-how-to-code-like-a-professional.html"><a href="writing-code-how-to-code-like-a-professional.html#write-readable-code"><i class="fa fa-check"></i><b>3.4.2</b> Write readable code</a></li>
<li class="chapter" data-level="3.4.3" data-path="writing-code-how-to-code-like-a-professional.html"><a href="writing-code-how-to-code-like-a-professional.html#write-reusable-code"><i class="fa fa-check"></i><b>3.4.3</b> Write reusable code</a></li>
<li class="chapter" data-level="3.4.4" data-path="writing-code-how-to-code-like-a-professional.html"><a href="writing-code-how-to-code-like-a-professional.html#test-your-code-systematically"><i class="fa fa-check"></i><b>3.4.4</b> Test your code systematically</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="run-tests.html"><a href="run-tests.html"><i class="fa fa-check"></i><b>3.5</b> Run tests</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="run-tests.html"><a href="run-tests.html#asking-questions-minimal-reproducible-example"><i class="fa fa-check"></i><b>3.5.1</b> Asking questions: Minimal reproducible example</a></li>
<li class="chapter" data-level="3.5.2" data-path="run-tests.html"><a href="run-tests.html#references-2"><i class="fa fa-check"></i><b>3.5.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidy_data.html"><a href="tidy_data.html"><i class="fa fa-check"></i><b>4</b> Tidy data and its friends</a>
<ul>
<li class="chapter" data-level="4.1" data-path="setup-2.html"><a href="setup-2.html"><i class="fa fa-check"></i><b>4.1</b> Setup</a></li>
<li class="chapter" data-level="4.2" data-path="base-r-data-structure.html"><a href="base-r-data-structure.html"><i class="fa fa-check"></i><b>4.2</b> Base R data structure</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="base-r-data-structure.html"><a href="base-r-data-structure.html#d-data-vectors"><i class="fa fa-check"></i><b>4.2.1</b> 1D data: Vectors</a></li>
<li class="chapter" data-level="4.2.2" data-path="base-r-data-structure.html"><a href="base-r-data-structure.html#data-structures"><i class="fa fa-check"></i><b>4.2.2</b> Data structures</a></li>
<li class="chapter" data-level="4.2.3" data-path="base-r-data-structure.html"><a href="base-r-data-structure.html#attributes"><i class="fa fa-check"></i><b>4.2.3</b> Attributes</a></li>
<li class="chapter" data-level="4.2.4" data-path="base-r-data-structure.html"><a href="base-r-data-structure.html#d-data-matrices-and-dataframes"><i class="fa fa-check"></i><b>4.2.4</b> 2D data: Matrices and dataframes</a></li>
<li class="chapter" data-level="4.2.5" data-path="base-r-data-structure.html"><a href="base-r-data-structure.html#subset"><i class="fa fa-check"></i><b>4.2.5</b> Subset</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4.3</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="tidyverse.html"><a href="tidyverse.html#the-big-picture-5"><i class="fa fa-check"></i><b>4.3.1</b> The Big Picture</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tidying-tidyr.html"><a href="tidying-tidyr.html"><i class="fa fa-check"></i><b>4.4</b> Tidying (tidyr)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="tidying-tidyr.html"><a href="tidying-tidyr.html#reshaping"><i class="fa fa-check"></i><b>4.4.1</b> Reshaping</a></li>
<li class="chapter" data-level="4.4.2" data-path="tidying-tidyr.html"><a href="tidying-tidyr.html#filling"><i class="fa fa-check"></i><b>4.4.2</b> Filling</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="manipulating-dplyr.html"><a href="manipulating-dplyr.html"><i class="fa fa-check"></i><b>4.5</b> Manipulating (dplyr)</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="manipulating-dplyr.html"><a href="manipulating-dplyr.html#rearranging"><i class="fa fa-check"></i><b>4.5.1</b> Rearranging</a></li>
<li class="chapter" data-level="4.5.2" data-path="manipulating-dplyr.html"><a href="manipulating-dplyr.html#subset-observations-rows"><i class="fa fa-check"></i><b>4.5.2</b> Subset observations (rows)</a></li>
<li class="chapter" data-level="4.5.3" data-path="manipulating-dplyr.html"><a href="manipulating-dplyr.html#subset-variables-columns"><i class="fa fa-check"></i><b>4.5.3</b> Subset variables (columns)</a></li>
<li class="chapter" data-level="4.5.4" data-path="manipulating-dplyr.html"><a href="manipulating-dplyr.html#create-variables"><i class="fa fa-check"></i><b>4.5.4</b> Create variables</a></li>
<li class="chapter" data-level="4.5.5" data-path="manipulating-dplyr.html"><a href="manipulating-dplyr.html#counting"><i class="fa fa-check"></i><b>4.5.5</b> Counting</a></li>
<li class="chapter" data-level="4.5.6" data-path="manipulating-dplyr.html"><a href="manipulating-dplyr.html#summarizing"><i class="fa fa-check"></i><b>4.5.6</b> Summarizing</a></li>
<li class="chapter" data-level="4.5.7" data-path="manipulating-dplyr.html"><a href="manipulating-dplyr.html#grouping"><i class="fa fa-check"></i><b>4.5.7</b> Grouping</a></li>
<li class="chapter" data-level="4.5.8" data-path="manipulating-dplyr.html"><a href="manipulating-dplyr.html#joining"><i class="fa fa-check"></i><b>4.5.8</b> Joining</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="modeling-broom.html"><a href="modeling-broom.html"><i class="fa fa-check"></i><b>4.6</b> Modeling (broom)</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="modeling-broom.html"><a href="modeling-broom.html#nesting"><i class="fa fa-check"></i><b>4.6.1</b> Nesting</a></li>
<li class="chapter" data-level="4.6.2" data-path="modeling-broom.html"><a href="modeling-broom.html#mapping"><i class="fa fa-check"></i><b>4.6.2</b> Mapping</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html"><i class="fa fa-check"></i><b>4.7</b> Visualizing (ggplot2)</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#motivation-2"><i class="fa fa-check"></i><b>4.7.1</b> Motivation</a></li>
<li class="chapter" data-level="4.7.2" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>4.7.2</b> The grammar of graphics</a></li>
<li class="chapter" data-level="4.7.3" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#mapping-and-geom"><i class="fa fa-check"></i><b>4.7.3</b> mapping and geom</a></li>
<li class="chapter" data-level="4.7.4" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#basic-aes-x-y"><i class="fa fa-check"></i><b>4.7.4</b> basic aes (x , y)</a></li>
<li class="chapter" data-level="4.7.5" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#univariate-distribution"><i class="fa fa-check"></i><b>4.7.5</b> Univariate distribution</a></li>
<li class="chapter" data-level="4.7.6" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#advanced-aes-size-color"><i class="fa fa-check"></i><b>4.7.6</b> Advanced aes (size, color)</a></li>
<li class="chapter" data-level="4.7.7" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#co-ordinates-and-scales"><i class="fa fa-check"></i><b>4.7.7</b> Co-ordinates and scales</a></li>
<li class="chapter" data-level="4.7.8" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#labels-and-guides"><i class="fa fa-check"></i><b>4.7.8</b> Labels and guides</a></li>
<li class="chapter" data-level="4.7.9" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#ggsave"><i class="fa fa-check"></i><b>4.7.9</b> ggsave</a></li>
<li class="chapter" data-level="4.7.10" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#many-plots"><i class="fa fa-check"></i><b>4.7.10</b> Many plots</a></li>
<li class="chapter" data-level="4.7.11" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#transforming"><i class="fa fa-check"></i><b>4.7.11</b> Transforming</a></li>
<li class="chapter" data-level="4.7.12" data-path="visualizing-ggplot2.html"><a href="visualizing-ggplot2.html#ploting-models"><i class="fa fa-check"></i><b>4.7.12</b> Ploting models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functional_programming.html"><a href="functional_programming.html"><i class="fa fa-check"></i><b>5</b> Automating repeated things</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-big-picture-6.html"><a href="the-big-picture-6.html"><i class="fa fa-check"></i><b>5.1</b> The Big Picture</a></li>
<li class="chapter" data-level="5.2" data-path="objectives.html"><a href="objectives.html"><i class="fa fa-check"></i><b>5.2</b> Objectives</a></li>
<li class="chapter" data-level="5.3" data-path="setup-3.html"><a href="setup-3.html"><i class="fa fa-check"></i><b>5.3</b> Setup</a></li>
<li class="chapter" data-level="5.4" data-path="flow.html"><a href="flow.html"><i class="fa fa-check"></i><b>5.4</b> Flow control</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="flow.html"><a href="flow.html#if-one-condition"><i class="fa fa-check"></i><b>5.4.1</b> if (one condition)</a></li>
<li class="chapter" data-level="5.4.2" data-path="flow.html"><a href="flow.html#if-else-two-conditions"><i class="fa fa-check"></i><b>5.4.2</b> if + else (two conditions)</a></li>
<li class="chapter" data-level="5.4.3" data-path="flow.html"><a href="flow.html#if-else-if-else-three-conditions"><i class="fa fa-check"></i><b>5.4.3</b> if + else if + else (three conditions)</a></li>
<li class="chapter" data-level="5.4.4" data-path="flow.html"><a href="flow.html#functions"><i class="fa fa-check"></i><b>5.4.4</b> Functions</a></li>
<li class="chapter" data-level="5.4.5" data-path="flow.html"><a href="flow.html#for-loop"><i class="fa fa-check"></i><b>5.4.5</b> for loop</a></li>
<li class="chapter" data-level="5.4.6" data-path="flow.html"><a href="flow.html#apply-family"><i class="fa fa-check"></i><b>5.4.6</b> apply family</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="purrr.html"><a href="purrr.html"><i class="fa fa-check"></i><b>5.5</b> purrr</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="purrr.html"><a href="purrr.html#why-map"><i class="fa fa-check"></i><b>5.5.1</b> Why map?</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="map2.html"><a href="map2.html"><i class="fa fa-check"></i><b>5.6</b> Automate 2 or 2+ tasks</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="map2.html"><a href="map2.html#objectives-2"><i class="fa fa-check"></i><b>5.6.1</b> Objectives</a></li>
<li class="chapter" data-level="5.6.2" data-path="map2.html"><a href="map2.html#problem"><i class="fa fa-check"></i><b>5.6.2</b> Problem</a></li>
<li class="chapter" data-level="5.6.3" data-path="map2.html"><a href="map2.html#for-loop-1"><i class="fa fa-check"></i><b>5.6.3</b> For loop</a></li>
<li class="chapter" data-level="5.6.4" data-path="map2.html"><a href="map2.html#map2-pmap"><i class="fa fa-check"></i><b>5.6.4</b> map2 &amp; pmap</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="glue.html"><a href="glue.html"><i class="fa fa-check"></i><b>5.7</b> Automate plotting</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="glue.html"><a href="glue.html#objective"><i class="fa fa-check"></i><b>5.7.1</b> Objective</a></li>
<li class="chapter" data-level="5.7.2" data-path="glue.html"><a href="glue.html#problem-1"><i class="fa fa-check"></i><b>5.7.2</b> Problem</a></li>
<li class="chapter" data-level="5.7.3" data-path="glue.html"><a href="glue.html#solution"><i class="fa fa-check"></i><b>5.7.3</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="reduce.html"><a href="reduce.html"><i class="fa fa-check"></i><b>5.8</b> Automate joining</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="reduce.html"><a href="reduce.html#objective-1"><i class="fa fa-check"></i><b>5.8.1</b> Objective</a></li>
<li class="chapter" data-level="5.8.2" data-path="reduce.html"><a href="reduce.html#problem-2"><i class="fa fa-check"></i><b>5.8.2</b> Problem</a></li>
<li class="chapter" data-level="5.8.3" data-path="reduce.html"><a href="reduce.html#copy-and-paste"><i class="fa fa-check"></i><b>5.8.3</b> Copy and paste</a></li>
<li class="chapter" data-level="5.8.4" data-path="reduce.html"><a href="reduce.html#reduce-1"><i class="fa fa-check"></i><b>5.8.4</b> reduce</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="speed.html"><a href="speed.html"><i class="fa fa-check"></i><b>5.9</b> Make automation slower or faster</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="speed.html"><a href="speed.html#objectives-3"><i class="fa fa-check"></i><b>5.9.1</b> Objectives</a></li>
<li class="chapter" data-level="5.9.2" data-path="speed.html"><a href="speed.html#how-to-make-automation-slower"><i class="fa fa-check"></i><b>5.9.2</b> How to Make Automation Slower</a></li>
<li class="chapter" data-level="5.9.3" data-path="speed.html"><a href="speed.html#how-to-make-automation-faster"><i class="fa fa-check"></i><b>5.9.3</b> How to Make Automation Faster</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="robustness.html"><a href="robustness.html"><i class="fa fa-check"></i><b>5.10</b> Make error handling easier</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="robustness.html"><a href="robustness.html#learning-objective"><i class="fa fa-check"></i><b>5.10.1</b> Learning objective</a></li>
<li class="chapter" data-level="5.10.2" data-path="robustness.html"><a href="robustness.html#solution-1"><i class="fa fa-check"></i><b>5.10.2</b> Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="products.html"><a href="products.html"><i class="fa fa-check"></i><b>6</b> Developing data products</a>
<ul>
<li class="chapter" data-level="6.1" data-path="developing-r-packages.html"><a href="developing-r-packages.html"><i class="fa fa-check"></i><b>6.1</b> Developing R packages</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="developing-r-packages.html"><a href="developing-r-packages.html#the-big-picture-7"><i class="fa fa-check"></i><b>6.1.1</b> The Big Picture</a></li>
<li class="chapter" data-level="6.1.2" data-path="developing-r-packages.html"><a href="developing-r-packages.html#workflow"><i class="fa fa-check"></i><b>6.1.2</b> Workflow</a></li>
<li class="chapter" data-level="6.1.3" data-path="developing-r-packages.html"><a href="developing-r-packages.html#required-components"><i class="fa fa-check"></i><b>6.1.3</b> Required Components</a></li>
<li class="chapter" data-level="6.1.4" data-path="developing-r-packages.html"><a href="developing-r-packages.html#optional-components"><i class="fa fa-check"></i><b>6.1.4</b> Optional Components</a></li>
<li class="chapter" data-level="6.1.5" data-path="developing-r-packages.html"><a href="developing-r-packages.html#building-an-r-package"><i class="fa fa-check"></i><b>6.1.5</b> Building an R package</a></li>
<li class="chapter" data-level="6.1.6" data-path="developing-r-packages.html"><a href="developing-r-packages.html#distributing-an-r-package"><i class="fa fa-check"></i><b>6.1.6</b> Distributing an R package</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="developing-shiny-apps.html"><a href="developing-shiny-apps.html"><i class="fa fa-check"></i><b>6.2</b> Developing Shiny apps</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="developing-shiny-apps.html"><a href="developing-shiny-apps.html#workflow-1"><i class="fa fa-check"></i><b>6.2.1</b> Workflow</a></li>
<li class="chapter" data-level="6.2.2" data-path="developing-shiny-apps.html"><a href="developing-shiny-apps.html#app.r"><i class="fa fa-check"></i><b>6.2.2</b> app.r</a></li>
<li class="chapter" data-level="6.2.3" data-path="developing-shiny-apps.html"><a href="developing-shiny-apps.html#deployment"><i class="fa fa-check"></i><b>6.2.3</b> Deployment</a></li>
<li class="chapter" data-level="6.2.4" data-path="developing-shiny-apps.html"><a href="developing-shiny-apps.html#references-3"><i class="fa fa-check"></i><b>6.2.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="other-useful-data-products.html"><a href="other-useful-data-products.html"><i class="fa fa-check"></i><b>6.3</b> Other useful data products</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="semi_structured_data.html"><a href="semi_structured_data.html"><i class="fa fa-check"></i><b>7</b> Semi-structured data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="setup-4.html"><a href="setup-4.html"><i class="fa fa-check"></i><b>7.1</b> Setup</a></li>
<li class="chapter" data-level="7.2" data-path="the-big-picture-8.html"><a href="the-big-picture-8.html"><i class="fa fa-check"></i><b>7.2</b> The Big Picture</a></li>
<li class="chapter" data-level="7.3" data-path="what-is-semi-structured-data.html"><a href="what-is-semi-structured-data.html"><i class="fa fa-check"></i><b>7.3</b> What is semi-structured data?</a></li>
<li class="chapter" data-level="7.4" data-path="workflow-2.html"><a href="workflow-2.html"><i class="fa fa-check"></i><b>7.4</b> Workflow</a></li>
<li class="chapter" data-level="7.5" data-path="htmlcss-web-scraping.html"><a href="htmlcss-web-scraping.html"><i class="fa fa-check"></i><b>7.5</b> HTML/CSS: web scraping</a></li>
<li class="chapter" data-level="7.6" data-path="xmljson-government-databasesocial-media-scraping.html"><a href="xmljson-government-databasesocial-media-scraping.html"><i class="fa fa-check"></i><b>7.6</b> XML/JSON: government database/social media scraping</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="xmljson-government-databasesocial-media-scraping.html"><a href="xmljson-government-databasesocial-media-scraping.html#governemnt-database-xml"><i class="fa fa-check"></i><b>7.6.1</b> Governemnt database (XML)</a></li>
<li class="chapter" data-level="7.6.2" data-path="xmljson-government-databasesocial-media-scraping.html"><a href="xmljson-government-databasesocial-media-scraping.html#social-media-api-json"><i class="fa fa-check"></i><b>7.6.2</b> Social media API (JSON)</a></li>
<li class="chapter" data-level="7.6.3" data-path="xmljson-government-databasesocial-media-scraping.html"><a href="xmljson-government-databasesocial-media-scraping.html#next-steps"><i class="fa fa-check"></i><b>7.6.3</b> Next steps</a></li>
<li class="chapter" data-level="7.6.4" data-path="xmljson-government-databasesocial-media-scraping.html"><a href="xmljson-government-databasesocial-media-scraping.html#rtweet"><i class="fa fa-check"></i><b>7.6.4</b> rtweet</a></li>
<li class="chapter" data-level="7.6.5" data-path="xmljson-government-databasesocial-media-scraping.html"><a href="xmljson-government-databasesocial-media-scraping.html#hydrating"><i class="fa fa-check"></i><b>7.6.5</b> Hydrating</a></li>
<li class="chapter" data-level="7.6.6" data-path="xmljson-government-databasesocial-media-scraping.html"><a href="xmljson-government-databasesocial-media-scraping.html#parsing-json"><i class="fa fa-check"></i><b>7.6.6</b> Parsing JSON</a></li>
<li class="chapter" data-level="7.6.7" data-path="xmljson-government-databasesocial-media-scraping.html"><a href="xmljson-government-databasesocial-media-scraping.html#getting-api-data-from-scratch"><i class="fa fa-check"></i><b>7.6.7</b> Getting API data from scratch</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="machine_learning.html"><a href="machine_learning.html"><i class="fa fa-check"></i><b>8</b> High-dimensional data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="the-big-picture-9.html"><a href="the-big-picture-9.html"><i class="fa fa-check"></i><b>8.1</b> The Big Picture</a></li>
<li class="chapter" data-level="8.2" data-path="dataset.html"><a href="dataset.html"><i class="fa fa-check"></i><b>8.2</b> Dataset</a></li>
<li class="chapter" data-level="8.3" data-path="workflow-3.html"><a href="workflow-3.html"><i class="fa fa-check"></i><b>8.3</b> Workflow</a></li>
<li class="chapter" data-level="8.4" data-path="tidymodels.html"><a href="tidymodels.html"><i class="fa fa-check"></i><b>8.4</b> tidymodels</a></li>
<li class="chapter" data-level="8.5" data-path="pre-processing.html"><a href="pre-processing.html"><i class="fa fa-check"></i><b>8.5</b> Pre-processing</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="pre-processing.html"><a href="pre-processing.html#regression-setup"><i class="fa fa-check"></i><b>8.5.1</b> Regression setup</a></li>
<li class="chapter" data-level="8.5.2" data-path="pre-processing.html"><a href="pre-processing.html#classification-setup"><i class="fa fa-check"></i><b>8.5.2</b> Classification setup</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>8.6</b> Supervised learning</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="supervised-learning.html"><a href="supervised-learning.html#ols-and-lasso"><i class="fa fa-check"></i><b>8.6.1</b> OLS and Lasso</a></li>
<li class="chapter" data-level="8.6.2" data-path="supervised-learning.html"><a href="supervised-learning.html#decision-tree"><i class="fa fa-check"></i><b>8.6.2</b> Decision tree</a></li>
<li class="chapter" data-level="8.6.3" data-path="supervised-learning.html"><a href="supervised-learning.html#bagging-random-forest"><i class="fa fa-check"></i><b>8.6.3</b> Bagging (Random forest)</a></li>
<li class="chapter" data-level="8.6.4" data-path="supervised-learning.html"><a href="supervised-learning.html#boosting-xgboost"><i class="fa fa-check"></i><b>8.6.4</b> Boosting (XGboost)</a></li>
<li class="chapter" data-level="8.6.5" data-path="supervised-learning.html"><a href="supervised-learning.html#stacking-superlearner"><i class="fa fa-check"></i><b>8.6.5</b> Stacking (SuperLearner)</a></li>
<li class="chapter" data-level="8.6.6" data-path="supervised-learning.html"><a href="supervised-learning.html#applications-2"><i class="fa fa-check"></i><b>8.6.6</b> Applications</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>8.7</b> Unsupervised learning</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#dimension-reduction"><i class="fa fa-check"></i><b>8.7.1</b> Dimension reduction</a></li>
<li class="chapter" data-level="8.7.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#topic-modeling"><i class="fa fa-check"></i><b>8.7.2</b> Topic modeling</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="references-4.html"><a href="references-4.html"><i class="fa fa-check"></i><b>8.8</b> References</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="references-4.html"><a href="references-4.html#books"><i class="fa fa-check"></i><b>8.8.1</b> Books</a></li>
<li class="chapter" data-level="8.8.2" data-path="references-4.html"><a href="references-4.html#lecture-slides"><i class="fa fa-check"></i><b>8.8.2</b> Lecture slides</a></li>
<li class="chapter" data-level="8.8.3" data-path="references-4.html"><a href="references-4.html#blog-posts"><i class="fa fa-check"></i><b>8.8.3</b> Blog posts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="big_data.html"><a href="big_data.html"><i class="fa fa-check"></i><b>9</b> Big data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="the-big-picture-10.html"><a href="the-big-picture-10.html"><i class="fa fa-check"></i><b>9.1</b> The Big Picture</a></li>
<li class="chapter" data-level="9.2" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i><b>9.2</b> SQL</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sql.html"><a href="sql.html#learning-objectives"><i class="fa fa-check"></i><b>9.2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="9.2.2" data-path="sql.html"><a href="sql.html#sql-and-r"><i class="fa fa-check"></i><b>9.2.2</b> SQL and R</a></li>
<li class="chapter" data-level="9.2.3" data-path="sql.html"><a href="sql.html#setup-7"><i class="fa fa-check"></i><b>9.2.3</b> Setup</a></li>
<li class="chapter" data-level="9.2.4" data-path="sql.html"><a href="sql.html#packages-1"><i class="fa fa-check"></i><b>9.2.4</b> Packages</a></li>
<li class="chapter" data-level="9.2.5" data-path="sql.html"><a href="sql.html#nyc-flights-data"><i class="fa fa-check"></i><b>9.2.5</b> NYC flights data</a></li>
<li class="chapter" data-level="9.2.6" data-path="sql.html"><a href="sql.html#workflow-4"><i class="fa fa-check"></i><b>9.2.6</b> Workflow</a></li>
<li class="chapter" data-level="9.2.7" data-path="sql.html"><a href="sql.html#things-we-didnt-cover"><i class="fa fa-check"></i><b>9.2.7</b> Things we didn’t cover</a></li>
<li class="chapter" data-level="9.2.8" data-path="sql.html"><a href="sql.html#references-5"><i class="fa fa-check"></i><b>9.2.8</b> References</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/jaeyk/PS239T" target="_blank">
  Published with <code>{bookdown}</code></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Thinking for Social Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="manipulating-dplyr" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Manipulating (dplyr)<a href="manipulating-dplyr.html#manipulating-dplyr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="float">
<img src="https://education.rstudio.com/blog/2020/09/concept-maps/dplyr.png" alt="Concept map for dplyr. By Monica Alonso, Greg Wilson." />
<div class="figcaption">Concept map for dplyr. By Monica Alonso, Greg Wilson.</div>
</div>
<p><code>dplyr</code> is better than the base R approaches to data processing:</p>
<ul>
<li>fast to run (due to the C++ backed) and intuitive to type</li>
<li>works well with tidy data and databases (thanks to <a href="https://dbplyr.tidyverse.org/"><code>dbplyr</code></a>)</li>
</ul>
<div id="rearranging" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Rearranging<a href="manipulating-dplyr.html#rearranging" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Arrange</p></li>
<li><p>Order rows</p></li>
</ul>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="manipulating-dplyr.html#cb571-1" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">arrange</span>(mtcars, mpg) <span class="co"># Low to High (default)</span></span></code></pre></div>
<pre><code>##                      mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
## Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
## Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
## Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
## Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
## Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1</code></pre>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="manipulating-dplyr.html#cb573-1" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">arrange</span>(mtcars, <span class="fu">desc</span>(mpg)) <span class="co"># High to Row</span></span></code></pre></div>
<pre><code>##                      mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
## Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
## Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
## Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
## Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
## Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4</code></pre>
<ul>
<li><p>Rename</p></li>
<li><p>Rename columns</p></li>
</ul>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="manipulating-dplyr.html#cb575-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">2011</span>, <span class="dv">2012</span>, <span class="dv">2013</span>))</span>
<span id="cb575-2"><a href="manipulating-dplyr.html#cb575-2" tabindex="-1"></a></span>
<span id="cb575-3"><a href="manipulating-dplyr.html#cb575-3" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb575-4"><a href="manipulating-dplyr.html#cb575-4" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb575-5"><a href="manipulating-dplyr.html#cb575-5" tabindex="-1"></a>    <span class="at">Year =</span> <span class="co"># NEW name</span></span>
<span id="cb575-6"><a href="manipulating-dplyr.html#cb575-6" tabindex="-1"></a>      y</span>
<span id="cb575-7"><a href="manipulating-dplyr.html#cb575-7" tabindex="-1"></a>  ) <span class="co"># OLD name</span></span></code></pre></div>
<pre><code>## # A tibble: 3 × 1
##    Year
##   &lt;dbl&gt;
## 1  2011
## 2  2012
## 3  2013</code></pre>
</div>
<div id="subset-observations-rows" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Subset observations (rows)<a href="manipulating-dplyr.html#subset-observations-rows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Choose row by logical condition</p></li>
<li><p>Single condition</p></li>
</ul>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="manipulating-dplyr.html#cb577-1" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb577-2"><a href="manipulating-dplyr.html#cb577-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">&quot;feminine&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb577-3"><a href="manipulating-dplyr.html#cb577-3" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(height))</span></code></pre></div>
<pre><code>## # A tibble: 17 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Taun We     213  NA   none       grey       black             NA fema… femin…
##  2 Padmé A…    185  45   brown      light      brown             46 fema… femin…
##  3 Adi Gal…    184  50   none       dark       blue              NA fema… femin…
##  4 Ayla Se…    178  55   none       blue       hazel             48 fema… femin…
##  5 Shaak Ti    178  57   none       red, blue… black             NA fema… femin…
##  6 Luminar…    170  56.2 black      yellow     blue              58 fema… femin…
##  7 Zam Wes…    168  55   blonde     fair, gre… yellow            NA fema… femin…
##  8 Jocasta…    167  NA   white      fair       blue              NA fema… femin…
##  9 Barriss…    166  50   black      yellow     blue              40 fema… femin…
## 10 Beru Wh…    165  75   brown      light      blue              47 fema… femin…
## 11 Dormé       165  NA   brown      light      brown             NA fema… femin…
## 12 Shmi Sk…    163  NA   black      fair       brown             72 fema… femin…
## 13 Leia Or…    150  49   brown      light      brown             19 fema… femin…
## 14 Mon Mot…    150  NA   auburn     fair       blue              48 fema… femin…
## 15 R4-P17       96  NA   none       silver, r… red, blue         NA none  femin…
## 16 Rey          NA  NA   brown      light      hazel             NA fema… femin…
## 17 Captain…     NA  NA   none       none       unknown           NA fema… femin…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<p>The following filtering example was inspired by <a href="https://suzan.rbind.io/2018/02/dplyr-tutorial-3/">the suzanbert’s dplyr blog post</a>.</p>
<ul>
<li>Multiple conditions (numeric)</li>
</ul>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="manipulating-dplyr.html#cb579-1" tabindex="-1"></a><span class="co"># First example</span></span>
<span id="cb579-2"><a href="manipulating-dplyr.html#cb579-2" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb579-3"><a href="manipulating-dplyr.html#cb579-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(height <span class="sc">&lt;</span> <span class="dv">180</span>, height <span class="sc">&gt;</span> <span class="dv">160</span>) <span class="sc">%&gt;%</span></span>
<span id="cb579-4"><a href="manipulating-dplyr.html#cb579-4" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>## [1] 23</code></pre>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="manipulating-dplyr.html#cb581-1" tabindex="-1"></a><span class="co"># Same as above</span></span>
<span id="cb581-2"><a href="manipulating-dplyr.html#cb581-2" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb581-3"><a href="manipulating-dplyr.html#cb581-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(height <span class="sc">&lt;</span> <span class="dv">180</span> <span class="sc">&amp;</span> height <span class="sc">&gt;</span> <span class="dv">160</span>) <span class="sc">%&gt;%</span></span>
<span id="cb581-4"><a href="manipulating-dplyr.html#cb581-4" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>## [1] 23</code></pre>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="manipulating-dplyr.html#cb583-1" tabindex="-1"></a><span class="co"># Not same as above</span></span>
<span id="cb583-2"><a href="manipulating-dplyr.html#cb583-2" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb583-3"><a href="manipulating-dplyr.html#cb583-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(height <span class="sc">&lt;</span> <span class="dv">180</span> <span class="sc">|</span> height <span class="sc">&gt;</span> <span class="dv">160</span>) <span class="sc">%&gt;%</span></span>
<span id="cb583-4"><a href="manipulating-dplyr.html#cb583-4" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>## [1] 81</code></pre>
<p><strong>Challenge</strong></p>
<ol style="list-style-type: decimal">
<li>Use <code>filter(between())</code> to find characters whose heights are between 180 and 160 and (2) count the number of these observations.</li>
</ol>
<ul>
<li>Minimum reproducible example</li>
</ul>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="manipulating-dplyr.html#cb585-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb585-2"><a href="manipulating-dplyr.html#cb585-2" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">160</span><span class="sc">:</span><span class="dv">180</span>),</span>
<span id="cb585-3"><a href="manipulating-dplyr.html#cb585-3" tabindex="-1"></a>  <span class="at">char =</span> <span class="fu">rep</span>(<span class="st">&quot;none&quot;</span>, <span class="fu">length</span>(<span class="fu">c</span>(<span class="dv">160</span><span class="sc">:</span><span class="dv">180</span>)))</span>
<span id="cb585-4"><a href="manipulating-dplyr.html#cb585-4" tabindex="-1"></a>)</span>
<span id="cb585-5"><a href="manipulating-dplyr.html#cb585-5" tabindex="-1"></a></span>
<span id="cb585-6"><a href="manipulating-dplyr.html#cb585-6" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb585-7"><a href="manipulating-dplyr.html#cb585-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">between</span>(heights, <span class="dv">161</span>, <span class="dv">179</span>))</span></code></pre></div>
<pre><code>## # A tibble: 19 × 2
##    heights char 
##      &lt;int&gt; &lt;chr&gt;
##  1     161 none 
##  2     162 none 
##  3     163 none 
##  4     164 none 
##  5     165 none 
##  6     166 none 
##  7     167 none 
##  8     168 none 
##  9     169 none 
## 10     170 none 
## 11     171 none 
## 12     172 none 
## 13     173 none 
## 14     174 none 
## 15     175 none 
## 16     176 none 
## 17     177 none 
## 18     178 none 
## 19     179 none</code></pre>
<ul>
<li>Multiple conditions (character)</li>
</ul>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="manipulating-dplyr.html#cb587-1" tabindex="-1"></a><span class="co"># Filter names include ars; `grepl` is a base R function</span></span>
<span id="cb587-2"><a href="manipulating-dplyr.html#cb587-2" tabindex="-1"></a></span>
<span id="cb587-3"><a href="manipulating-dplyr.html#cb587-3" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb587-4"><a href="manipulating-dplyr.html#cb587-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;ars&quot;</span>, <span class="fu">tolower</span>(name)))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 14
##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Owen Lars    178   120 brown, gr… light      blue              52 male  mascu…
## 2 Beru Whi…    165    75 brown      light      blue              47 fema… femin…
## 3 Quarsh P…    183    NA black      dark       brown             62 male  mascu…
## 4 Cliegg L…    183    NA brown      fair       blue              82 male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="manipulating-dplyr.html#cb589-1" tabindex="-1"></a><span class="co"># Or, if you prefer dplyr way</span></span>
<span id="cb589-2"><a href="manipulating-dplyr.html#cb589-2" tabindex="-1"></a></span>
<span id="cb589-3"><a href="manipulating-dplyr.html#cb589-3" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb589-4"><a href="manipulating-dplyr.html#cb589-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(<span class="fu">tolower</span>(name), <span class="st">&quot;ars&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 14
##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Owen Lars    178   120 brown, gr… light      blue              52 male  mascu…
## 2 Beru Whi…    165    75 brown      light      blue              47 fema… femin…
## 3 Quarsh P…    183    NA black      dark       brown             62 male  mascu…
## 4 Cliegg L…    183    NA brown      fair       blue              82 male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="manipulating-dplyr.html#cb591-1" tabindex="-1"></a><span class="co"># Filter brown and black hair_color</span></span>
<span id="cb591-2"><a href="manipulating-dplyr.html#cb591-2" tabindex="-1"></a></span>
<span id="cb591-3"><a href="manipulating-dplyr.html#cb591-3" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb591-4"><a href="manipulating-dplyr.html#cb591-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(hair_color <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;brown&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 31 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Leia Or…    150  49   brown      light      brown           19   fema… femin…
##  2 Beru Wh…    165  75   brown      light      blue            47   fema… femin…
##  3 Biggs D…    183  84   black      light      brown           24   male  mascu…
##  4 Chewbac…    228 112   brown      unknown    blue           200   male  mascu…
##  5 Han Solo    180  80   brown      fair       brown           29   male  mascu…
##  6 Wedge A…    170  77   brown      fair       hazel           21   male  mascu…
##  7 Jek Ton…    180 110   brown      fair       blue            NA   &lt;NA&gt;  &lt;NA&gt;  
##  8 Boba Fe…    183  78.2 black      fair       brown           31.5 male  mascu…
##  9 Lando C…    177  79   black      dark       brown           31   male  mascu…
## 10 Arvel C…     NA  NA   brown      fair       brown           NA   male  mascu…
## # ℹ 21 more rows
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<p><strong>Challenge</strong></p>
<p>Use <code>str_detect()</code> to find characters whose names include “Han”.</p>
<ul>
<li>Choose row by position (row index)</li>
</ul>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="manipulating-dplyr.html#cb593-1" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb593-2"><a href="manipulating-dplyr.html#cb593-2" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(height)) <span class="sc">%&gt;%</span></span>
<span id="cb593-3"><a href="manipulating-dplyr.html#cb593-3" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 14
##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Yarael P…    264    NA none       white      yellow            NA male  mascu…
## 2 Tarfful      234   136 brown      brown      blue              NA male  mascu…
## 3 Lama Su      229    88 none       grey       black             NA male  mascu…
## 4 Chewbacca    228   112 brown      unknown    blue             200 male  mascu…
## 5 Roos Tar…    224    82 none       grey       orange            NA male  mascu…
## 6 Grievous     216   159 none       brown, wh… green, y…         NA male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<ul>
<li>Sample by a fraction</li>
</ul>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="manipulating-dplyr.html#cb595-1" tabindex="-1"></a><span class="co"># For reproducibility</span></span>
<span id="cb595-2"><a href="manipulating-dplyr.html#cb595-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb595-3"><a href="manipulating-dplyr.html#cb595-3" tabindex="-1"></a></span>
<span id="cb595-4"><a href="manipulating-dplyr.html#cb595-4" tabindex="-1"></a><span class="co"># Old way</span></span>
<span id="cb595-5"><a href="manipulating-dplyr.html#cb595-5" tabindex="-1"></a></span>
<span id="cb595-6"><a href="manipulating-dplyr.html#cb595-6" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb595-7"><a href="manipulating-dplyr.html#cb595-7" tabindex="-1"></a>  <span class="fu">sample_frac</span>(<span class="fl">0.10</span>,</span>
<span id="cb595-8"><a href="manipulating-dplyr.html#cb595-8" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">FALSE</span></span>
<span id="cb595-9"><a href="manipulating-dplyr.html#cb595-9" tabindex="-1"></a>  ) <span class="co"># Without replacement</span></span></code></pre></div>
<pre><code>## # A tibble: 9 × 14
##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Arvel Cr…     NA    NA brown      fair       brown           NA   male  mascu…
## 2 Raymus A…    188    79 brown      light      brown           NA   male  mascu…
## 3 IG-88        200   140 none       metal      red             15   none  mascu…
## 4 Biggs Da…    183    84 black      light      brown           24   male  mascu…
## 5 Leia Org…    150    49 brown      light      brown           19   fema… femin…
## 6 Ric Olié     183    NA brown      fair       blue            NA   male  mascu…
## 7 Jabba De…    175  1358 &lt;NA&gt;       green-tan… orange         600   herm… mascu…
## 8 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
## 9 Dexter J…    198   102 none       brown      yellow          NA   male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="manipulating-dplyr.html#cb597-1" tabindex="-1"></a><span class="co"># New way</span></span>
<span id="cb597-2"><a href="manipulating-dplyr.html#cb597-2" tabindex="-1"></a></span>
<span id="cb597-3"><a href="manipulating-dplyr.html#cb597-3" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb597-4"><a href="manipulating-dplyr.html#cb597-4" tabindex="-1"></a>  <span class="fu">slice_sample</span>(</span>
<span id="cb597-5"><a href="manipulating-dplyr.html#cb597-5" tabindex="-1"></a>    <span class="at">prop =</span> <span class="fl">0.10</span>,</span>
<span id="cb597-6"><a href="manipulating-dplyr.html#cb597-6" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">FALSE</span></span>
<span id="cb597-7"><a href="manipulating-dplyr.html#cb597-7" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 8 × 14
##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Tarfful      234 136   brown      brown      blue            NA   male  mascu…
## 2 Grievous     216 159   none       brown, wh… green, y…       NA   male  mascu…
## 3 Han Solo     180  80   brown      fair       brown           29   male  mascu…
## 4 Yarael P…    264  NA   none       white      yellow          NA   male  mascu…
## 5 Poggle t…    183  80   none       green      yellow          NA   male  mascu…
## 6 Darth Va…    202 136   none       white      yellow          41.9 male  mascu…
## 7 Tion Med…    206  80   none       grey       black           NA   male  mascu…
## 8 Boba Fett    183  78.2 black      fair       brown           31.5 male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<ul>
<li>Sample by number</li>
</ul>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="manipulating-dplyr.html#cb599-1" tabindex="-1"></a><span class="co"># Old way</span></span>
<span id="cb599-2"><a href="manipulating-dplyr.html#cb599-2" tabindex="-1"></a></span>
<span id="cb599-3"><a href="manipulating-dplyr.html#cb599-3" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb599-4"><a href="manipulating-dplyr.html#cb599-4" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">20</span>,</span>
<span id="cb599-5"><a href="manipulating-dplyr.html#cb599-5" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">FALSE</span></span>
<span id="cb599-6"><a href="manipulating-dplyr.html#cb599-6" tabindex="-1"></a>  ) <span class="co"># Without replacement</span></span></code></pre></div>
<pre><code>## # A tibble: 20 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Sebulba     112    40 none       grey, red  orange            NA male  mascu…
##  2 Rey          NA    NA brown      light      hazel             NA fema… femin…
##  3 Yarael …    264    NA none       white      yellow            NA male  mascu…
##  4 Bail Pr…    191    NA black      tan        brown             67 male  mascu…
##  5 Leia Or…    150    49 brown      light      brown             19 fema… femin…
##  6 Dooku       193    80 white      fair       brown            102 male  mascu…
##  7 Dud Bolt     94    45 none       blue, grey yellow            NA male  mascu…
##  8 Captain…     NA    NA none       none       unknown           NA fema… femin…
##  9 Gasgano     122    NA none       white, bl… black             NA male  mascu…
## 10 R2-D2        96    32 &lt;NA&gt;       white, bl… red               33 none  mascu…
## 11 Quarsh …    183    NA black      dark       brown             62 male  mascu…
## 12 Taun We     213    NA none       grey       black             NA fema… femin…
## 13 Nute Gu…    191    90 none       mottled g… red               NA male  mascu…
## 14 Shmi Sk…    163    NA black      fair       brown             72 fema… femin…
## 15 Darth M…    175    80 none       red        yellow            54 male  mascu…
## 16 C-3PO       167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
## 17 Adi Gal…    184    50 none       dark       blue              NA fema… femin…
## 18 Ben Qua…    163    65 none       grey, gre… orange            NA male  mascu…
## 19 Poe Dam…     NA    NA brown      light      brown             NA male  mascu…
## 20 Ki-Adi-…    198    82 white      pale       yellow            92 male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="manipulating-dplyr.html#cb601-1" tabindex="-1"></a><span class="co"># New way</span></span>
<span id="cb601-2"><a href="manipulating-dplyr.html#cb601-2" tabindex="-1"></a></span>
<span id="cb601-3"><a href="manipulating-dplyr.html#cb601-3" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb601-4"><a href="manipulating-dplyr.html#cb601-4" tabindex="-1"></a>  <span class="fu">slice_sample</span>(</span>
<span id="cb601-5"><a href="manipulating-dplyr.html#cb601-5" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">20</span>,</span>
<span id="cb601-6"><a href="manipulating-dplyr.html#cb601-6" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">FALSE</span></span>
<span id="cb601-7"><a href="manipulating-dplyr.html#cb601-7" tabindex="-1"></a>  ) <span class="co"># Without replacement</span></span></code></pre></div>
<pre><code>## # A tibble: 20 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Owen La…    178 120   brown, gr… light      blue              52 male  mascu…
##  2 Ben Qua…    163  65   none       grey, gre… orange            NA male  mascu…
##  3 BB8          NA  NA   none       none       black             NA none  mascu…
##  4 Plo Koon    188  80   none       orange     black             22 male  mascu…
##  5 R5-D4        97  32   &lt;NA&gt;       white, red red               NA none  mascu…
##  6 Ackbar      180  83   none       brown mot… orange            41 male  mascu…
##  7 Wedge A…    170  77   brown      fair       hazel             21 male  mascu…
##  8 Luminar…    170  56.2 black      yellow     blue              58 fema… femin…
##  9 Finn         NA  NA   black      dark       dark              NA male  mascu…
## 10 IG-88       200 140   none       metal      red               15 none  mascu…
## 11 Jar Jar…    196  66   none       orange     orange            52 male  mascu…
## 12 Quarsh …    183  NA   black      dark       brown             62 male  mascu…
## 13 R2-D2        96  32   &lt;NA&gt;       white, bl… red               33 none  mascu…
## 14 Rey          NA  NA   brown      light      hazel             NA fema… femin…
## 15 Obi-Wan…    182  77   auburn, w… fair       blue-gray         57 male  mascu…
## 16 Saesee …    188  NA   none       pale       orange            NA male  mascu…
## 17 Grievous    216 159   none       brown, wh… green, y…         NA male  mascu…
## 18 Lobot       175  79   none       light      blue              37 male  mascu…
## 19 Wat Tam…    193  48   none       green, gr… unknown           NA male  mascu…
## 20 Mace Wi…    188  84   none       dark       brown             72 male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<ul>
<li>Top 10 rows orderd by height</li>
</ul>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="manipulating-dplyr.html#cb603-1" tabindex="-1"></a><span class="co"># Old way</span></span>
<span id="cb603-2"><a href="manipulating-dplyr.html#cb603-2" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb603-3"><a href="manipulating-dplyr.html#cb603-3" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, height)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
##  2 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…
##  3 Roos Ta…    224    82 none       grey       orange          NA   male  mascu…
##  4 Rugor N…    206    NA none       green      orange          NA   male  mascu…
##  5 Yarael …    264    NA none       white      yellow          NA   male  mascu…
##  6 Lama Su     229    88 none       grey       black           NA   male  mascu…
##  7 Taun We     213    NA none       grey       black           NA   fema… femin…
##  8 Grievous    216   159 none       brown, wh… green, y…       NA   male  mascu…
##  9 Tarfful     234   136 brown      brown      blue            NA   male  mascu…
## 10 Tion Me…    206    80 none       grey       black           NA   male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="manipulating-dplyr.html#cb605-1" tabindex="-1"></a><span class="co"># New way</span></span>
<span id="cb605-2"><a href="manipulating-dplyr.html#cb605-2" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb605-3"><a href="manipulating-dplyr.html#cb605-3" tabindex="-1"></a>  <span class="fu">slice_max</span>(height, <span class="at">n =</span> <span class="dv">10</span>) <span class="co"># Variable first, Argument second</span></span></code></pre></div>
<pre><code>## # A tibble: 10 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Yarael …    264    NA none       white      yellow          NA   male  mascu…
##  2 Tarfful     234   136 brown      brown      blue            NA   male  mascu…
##  3 Lama Su     229    88 none       grey       black           NA   male  mascu…
##  4 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…
##  5 Roos Ta…    224    82 none       grey       orange          NA   male  mascu…
##  6 Grievous    216   159 none       brown, wh… green, y…       NA   male  mascu…
##  7 Taun We     213    NA none       grey       black           NA   fema… femin…
##  8 Rugor N…    206    NA none       green      orange          NA   male  mascu…
##  9 Tion Me…    206    80 none       grey       black           NA   male  mascu…
## 10 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
<div id="subset-variables-columns" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Subset variables (columns)<a href="manipulating-dplyr.html#subset-variables-columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="manipulating-dplyr.html#cb607-1" tabindex="-1"></a><span class="fu">names</span>(msleep)</span></code></pre></div>
<pre><code>##  [1] &quot;name&quot;         &quot;genus&quot;        &quot;vore&quot;         &quot;order&quot;        &quot;conservation&quot;
##  [6] &quot;sleep_total&quot;  &quot;sleep_rem&quot;    &quot;sleep_cycle&quot;  &quot;awake&quot;        &quot;brainwt&quot;     
## [11] &quot;bodywt&quot;</code></pre>
<ul>
<li>Select only numeric columns</li>
</ul>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="manipulating-dplyr.html#cb609-1" tabindex="-1"></a><span class="co"># Only numeric</span></span>
<span id="cb609-2"><a href="manipulating-dplyr.html#cb609-2" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb609-3"><a href="manipulating-dplyr.html#cb609-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 6
##    sleep_total sleep_rem sleep_cycle awake  brainwt  bodywt
##          &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
##  1        12.1      NA        NA      11.9 NA        50    
##  2        17         1.8      NA       7    0.0155    0.48 
##  3        14.4       2.4      NA       9.6 NA         1.35 
##  4        14.9       2.3       0.133   9.1  0.00029   0.019
##  5         4         0.7       0.667  20    0.423   600    
##  6        14.4       2.2       0.767   9.6 NA         3.85 
##  7         8.7       1.4       0.383  15.3 NA        20.5  
##  8         7        NA        NA      17   NA         0.045
##  9        10.1       2.9       0.333  13.9  0.07     14    
## 10         3        NA        NA      21    0.0982   14.8  
## # ℹ 73 more rows</code></pre>
<p><strong>Challenge</strong></p>
<p>Use <code>select(where())</code> to find only non-numeric columns</p>
<ul>
<li>Select the columns that include “sleep” in their names</li>
</ul>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="manipulating-dplyr.html#cb611-1" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb611-2"><a href="manipulating-dplyr.html#cb611-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;sleep&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 3
##    sleep_total sleep_rem sleep_cycle
##          &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
##  1        12.1      NA        NA    
##  2        17         1.8      NA    
##  3        14.4       2.4      NA    
##  4        14.9       2.3       0.133
##  5         4         0.7       0.667
##  6        14.4       2.2       0.767
##  7         8.7       1.4       0.383
##  8         7        NA        NA    
##  9        10.1       2.9       0.333
## 10         3        NA        NA    
## # ℹ 73 more rows</code></pre>
<ul>
<li><p>Select the columns that include either “sleep” or “wt” in their names</p></li>
<li><p>Basic R way</p></li>
</ul>
<p><code>grepl</code> is one of the R base pattern matching functions.</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="manipulating-dplyr.html#cb613-1" tabindex="-1"></a>msleep[<span class="fu">grepl</span>(<span class="st">&quot;sleep|wt&quot;</span>, <span class="fu">names</span>(msleep))]</span></code></pre></div>
<pre><code>## # A tibble: 83 × 5
##    sleep_total sleep_rem sleep_cycle  brainwt  bodywt
##          &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
##  1        12.1      NA        NA     NA        50    
##  2        17         1.8      NA      0.0155    0.48 
##  3        14.4       2.4      NA     NA         1.35 
##  4        14.9       2.3       0.133  0.00029   0.019
##  5         4         0.7       0.667  0.423   600    
##  6        14.4       2.2       0.767 NA         3.85 
##  7         8.7       1.4       0.383 NA        20.5  
##  8         7        NA        NA     NA         0.045
##  9        10.1       2.9       0.333  0.07     14    
## 10         3        NA        NA      0.0982   14.8  
## # ℹ 73 more rows</code></pre>
<p><strong>Challenge</strong></p>
<p>Use <code>select(match())</code> to find columns whose names include either “sleep” or “wt”.</p>
<ul>
<li>Select the columns that start with “b”</li>
</ul>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="manipulating-dplyr.html#cb615-1" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb615-2"><a href="manipulating-dplyr.html#cb615-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;b&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 2
##     brainwt  bodywt
##       &lt;dbl&gt;   &lt;dbl&gt;
##  1 NA        50    
##  2  0.0155    0.48 
##  3 NA         1.35 
##  4  0.00029   0.019
##  5  0.423   600    
##  6 NA         3.85 
##  7 NA        20.5  
##  8 NA         0.045
##  9  0.07     14    
## 10  0.0982   14.8  
## # ℹ 73 more rows</code></pre>
<ul>
<li>Select the columns that end with “wt”</li>
</ul>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="manipulating-dplyr.html#cb617-1" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb617-2"><a href="manipulating-dplyr.html#cb617-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;wt&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 2
##     brainwt  bodywt
##       &lt;dbl&gt;   &lt;dbl&gt;
##  1 NA        50    
##  2  0.0155    0.48 
##  3 NA         1.35 
##  4  0.00029   0.019
##  5  0.423   600    
##  6 NA         3.85 
##  7 NA        20.5  
##  8 NA         0.045
##  9  0.07     14    
## 10  0.0982   14.8  
## # ℹ 73 more rows</code></pre>
<ul>
<li>Select the columns using both beginning and end string patterns</li>
</ul>
<p>The key idea is you can use Boolean operators (<code>!</code>, <code>&amp;</code>, <code>|</code>)to combine different string pattern matching statements.</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="manipulating-dplyr.html#cb619-1" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb619-2"><a href="manipulating-dplyr.html#cb619-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;b&quot;</span>) <span class="sc">&amp;</span> <span class="fu">ends_with</span>(<span class="st">&quot;wt&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 2
##     brainwt  bodywt
##       &lt;dbl&gt;   &lt;dbl&gt;
##  1 NA        50    
##  2  0.0155    0.48 
##  3 NA         1.35 
##  4  0.00029   0.019
##  5  0.423   600    
##  6 NA         3.85 
##  7 NA        20.5  
##  8 NA         0.045
##  9  0.07     14    
## 10  0.0982   14.8  
## # ℹ 73 more rows</code></pre>
<ul>
<li>Select the order and move it before everything</li>
</ul>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="manipulating-dplyr.html#cb621-1" tabindex="-1"></a><span class="co"># By specifying a column</span></span>
<span id="cb621-2"><a href="manipulating-dplyr.html#cb621-2" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb621-3"><a href="manipulating-dplyr.html#cb621-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(order, <span class="fu">everything</span>())</span></code></pre></div>
<pre><code>## # A tibble: 83 × 11
##    order  name  genus vore  conservation sleep_total sleep_rem sleep_cycle awake
##    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
##  1 Carni… Chee… Acin… carni lc                  12.1      NA        NA      11.9
##  2 Prima… Owl … Aotus omni  &lt;NA&gt;                17         1.8      NA       7  
##  3 Roden… Moun… Aplo… herbi nt                  14.4       2.4      NA       9.6
##  4 Soric… Grea… Blar… omni  lc                  14.9       2.3       0.133   9.1
##  5 Artio… Cow   Bos   herbi domesticated         4         0.7       0.667  20  
##  6 Pilosa Thre… Brad… herbi &lt;NA&gt;                14.4       2.2       0.767   9.6
##  7 Carni… Nort… Call… carni vu                   8.7       1.4       0.383  15.3
##  8 Roden… Vesp… Calo… &lt;NA&gt;  &lt;NA&gt;                 7        NA        NA      17  
##  9 Carni… Dog   Canis carni domesticated        10.1       2.9       0.333  13.9
## 10 Artio… Roe … Capr… herbi lc                   3        NA        NA      21  
## # ℹ 73 more rows
## # ℹ 2 more variables: brainwt &lt;dbl&gt;, bodywt &lt;dbl&gt;</code></pre>
<ul>
<li>Select variables from a character vector.</li>
</ul>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="manipulating-dplyr.html#cb623-1" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb623-2"><a href="manipulating-dplyr.html#cb623-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;order&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb623-3"><a href="manipulating-dplyr.html#cb623-3" tabindex="-1"></a>  <span class="fu">colnames</span>()</span></code></pre></div>
<pre><code>## [1] &quot;name&quot;  &quot;order&quot;</code></pre>
<ul>
<li>Select the variables named in character + number pattern</li>
</ul>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="manipulating-dplyr.html#cb625-1" tabindex="-1"></a>msleep<span class="sc">$</span>week8 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb625-2"><a href="manipulating-dplyr.html#cb625-2" tabindex="-1"></a></span>
<span id="cb625-3"><a href="manipulating-dplyr.html#cb625-3" tabindex="-1"></a>msleep<span class="sc">$</span>week12 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb625-4"><a href="manipulating-dplyr.html#cb625-4" tabindex="-1"></a></span>
<span id="cb625-5"><a href="manipulating-dplyr.html#cb625-5" tabindex="-1"></a>msleep<span class="sc">$</span>week_extra <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb625-6"><a href="manipulating-dplyr.html#cb625-6" tabindex="-1"></a></span>
<span id="cb625-7"><a href="manipulating-dplyr.html#cb625-7" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb625-8"><a href="manipulating-dplyr.html#cb625-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">num_range</span>(<span class="st">&quot;week&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 2
##    week8 week12
##    &lt;lgl&gt; &lt;lgl&gt; 
##  1 NA    NA    
##  2 NA    NA    
##  3 NA    NA    
##  4 NA    NA    
##  5 NA    NA    
##  6 NA    NA    
##  7 NA    NA    
##  8 NA    NA    
##  9 NA    NA    
## 10 NA    NA    
## # ℹ 73 more rows</code></pre>
<p><strong>Additional tips</strong></p>
<p><code>msleep</code> data has nicely cleaned column names. But real-world data are usually messier. The <code>janitor</code> package is useful to fix this kind of problem.</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="manipulating-dplyr.html#cb627-1" tabindex="-1"></a>messy_df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb627-2"><a href="manipulating-dplyr.html#cb627-2" tabindex="-1"></a>  <span class="sc">~</span><span class="st">&quot;ColNum1&quot;</span>, <span class="sc">~</span><span class="st">&quot;COLNUM2&quot;</span>, <span class="sc">~</span><span class="st">&quot;COL &amp; NUM3&quot;</span>,</span>
<span id="cb627-3"><a href="manipulating-dplyr.html#cb627-3" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span></span>
<span id="cb627-4"><a href="manipulating-dplyr.html#cb627-4" tabindex="-1"></a>)</span>
<span id="cb627-5"><a href="manipulating-dplyr.html#cb627-5" tabindex="-1"></a></span>
<span id="cb627-6"><a href="manipulating-dplyr.html#cb627-6" tabindex="-1"></a>messy_df</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   ColNum1 COLNUM2 `COL &amp; NUM3`
##     &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;
## 1       1       2            3</code></pre>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="manipulating-dplyr.html#cb629-1" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(janitor)</span>
<span id="cb629-2"><a href="manipulating-dplyr.html#cb629-2" tabindex="-1"></a></span>
<span id="cb629-3"><a href="manipulating-dplyr.html#cb629-3" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">clean_names</span>(messy_df)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   col_num1 colnum2 col_num3
##      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1        1       2        3</code></pre>
<p><code>janitor::tabyl()</code> is helpful for doing crosstabulation and a nice alternative to <code>table()</code> function.</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="manipulating-dplyr.html#cb631-1" tabindex="-1"></a><span class="co"># Frequency table; The default output class is table</span></span>
<span id="cb631-2"><a href="manipulating-dplyr.html#cb631-2" tabindex="-1"></a><span class="fu">table</span>(gapminder<span class="sc">$</span>country)</span></code></pre></div>
<pre><code>## 
##              Afghanistan                  Albania                  Algeria 
##                       12                       12                       12 
##                   Angola                Argentina                Australia 
##                       12                       12                       12 
##                  Austria                  Bahrain               Bangladesh 
##                       12                       12                       12 
##                  Belgium                    Benin                  Bolivia 
##                       12                       12                       12 
##   Bosnia and Herzegovina                 Botswana                   Brazil 
##                       12                       12                       12 
##                 Bulgaria             Burkina Faso                  Burundi 
##                       12                       12                       12 
##                 Cambodia                 Cameroon                   Canada 
##                       12                       12                       12 
## Central African Republic                     Chad                    Chile 
##                       12                       12                       12 
##                    China                 Colombia                  Comoros 
##                       12                       12                       12 
##         Congo, Dem. Rep.              Congo, Rep.               Costa Rica 
##                       12                       12                       12 
##            Cote d&#39;Ivoire                  Croatia                     Cuba 
##                       12                       12                       12 
##           Czech Republic                  Denmark                 Djibouti 
##                       12                       12                       12 
##       Dominican Republic                  Ecuador                    Egypt 
##                       12                       12                       12 
##              El Salvador        Equatorial Guinea                  Eritrea 
##                       12                       12                       12 
##                 Ethiopia                  Finland                   France 
##                       12                       12                       12 
##                    Gabon                   Gambia                  Germany 
##                       12                       12                       12 
##                    Ghana                   Greece                Guatemala 
##                       12                       12                       12 
##                   Guinea            Guinea-Bissau                    Haiti 
##                       12                       12                       12 
##                 Honduras         Hong Kong, China                  Hungary 
##                       12                       12                       12 
##                  Iceland                    India                Indonesia 
##                       12                       12                       12 
##                     Iran                     Iraq                  Ireland 
##                       12                       12                       12 
##                   Israel                    Italy                  Jamaica 
##                       12                       12                       12 
##                    Japan                   Jordan                    Kenya 
##                       12                       12                       12 
##         Korea, Dem. Rep.              Korea, Rep.                   Kuwait 
##                       12                       12                       12 
##                  Lebanon                  Lesotho                  Liberia 
##                       12                       12                       12 
##                    Libya               Madagascar                   Malawi 
##                       12                       12                       12 
##                 Malaysia                     Mali               Mauritania 
##                       12                       12                       12 
##                Mauritius                   Mexico                 Mongolia 
##                       12                       12                       12 
##               Montenegro                  Morocco               Mozambique 
##                       12                       12                       12 
##                  Myanmar                  Namibia                    Nepal 
##                       12                       12                       12 
##              Netherlands              New Zealand                Nicaragua 
##                       12                       12                       12 
##                    Niger                  Nigeria                   Norway 
##                       12                       12                       12 
##                     Oman                 Pakistan                   Panama 
##                       12                       12                       12 
##                 Paraguay                     Peru              Philippines 
##                       12                       12                       12 
##                   Poland                 Portugal              Puerto Rico 
##                       12                       12                       12 
##                  Reunion                  Romania                   Rwanda 
##                       12                       12                       12 
##    Sao Tome and Principe             Saudi Arabia                  Senegal 
##                       12                       12                       12 
##                   Serbia             Sierra Leone                Singapore 
##                       12                       12                       12 
##          Slovak Republic                 Slovenia                  Somalia 
##                       12                       12                       12 
##             South Africa                    Spain                Sri Lanka 
##                       12                       12                       12 
##                    Sudan                Swaziland                   Sweden 
##                       12                       12                       12 
##              Switzerland                    Syria                   Taiwan 
##                       12                       12                       12 
##                 Tanzania                 Thailand                     Togo 
##                       12                       12                       12 
##      Trinidad and Tobago                  Tunisia                   Turkey 
##                       12                       12                       12 
##                   Uganda           United Kingdom            United States 
##                       12                       12                       12 
##                  Uruguay                Venezuela                  Vietnam 
##                       12                       12                       12 
##       West Bank and Gaza              Yemen, Rep.                   Zambia 
##                       12                       12                       12 
##                 Zimbabwe 
##                       12</code></pre>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="manipulating-dplyr.html#cb633-1" tabindex="-1"></a><span class="co"># Frequency table (unique value, n, percentage)</span></span>
<span id="cb633-2"><a href="manipulating-dplyr.html#cb633-2" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">tabyl</span>(gapminder<span class="sc">$</span>country)</span></code></pre></div>
<pre><code>##         gapminder$country  n     percent
##               Afghanistan 12 0.007042254
##                   Albania 12 0.007042254
##                   Algeria 12 0.007042254
##                    Angola 12 0.007042254
##                 Argentina 12 0.007042254
##                 Australia 12 0.007042254
##                   Austria 12 0.007042254
##                   Bahrain 12 0.007042254
##                Bangladesh 12 0.007042254
##                   Belgium 12 0.007042254
##                     Benin 12 0.007042254
##                   Bolivia 12 0.007042254
##    Bosnia and Herzegovina 12 0.007042254
##                  Botswana 12 0.007042254
##                    Brazil 12 0.007042254
##                  Bulgaria 12 0.007042254
##              Burkina Faso 12 0.007042254
##                   Burundi 12 0.007042254
##                  Cambodia 12 0.007042254
##                  Cameroon 12 0.007042254
##                    Canada 12 0.007042254
##  Central African Republic 12 0.007042254
##                      Chad 12 0.007042254
##                     Chile 12 0.007042254
##                     China 12 0.007042254
##                  Colombia 12 0.007042254
##                   Comoros 12 0.007042254
##          Congo, Dem. Rep. 12 0.007042254
##               Congo, Rep. 12 0.007042254
##                Costa Rica 12 0.007042254
##             Cote d&#39;Ivoire 12 0.007042254
##                   Croatia 12 0.007042254
##                      Cuba 12 0.007042254
##            Czech Republic 12 0.007042254
##                   Denmark 12 0.007042254
##                  Djibouti 12 0.007042254
##        Dominican Republic 12 0.007042254
##                   Ecuador 12 0.007042254
##                     Egypt 12 0.007042254
##               El Salvador 12 0.007042254
##         Equatorial Guinea 12 0.007042254
##                   Eritrea 12 0.007042254
##                  Ethiopia 12 0.007042254
##                   Finland 12 0.007042254
##                    France 12 0.007042254
##                     Gabon 12 0.007042254
##                    Gambia 12 0.007042254
##                   Germany 12 0.007042254
##                     Ghana 12 0.007042254
##                    Greece 12 0.007042254
##                 Guatemala 12 0.007042254
##                    Guinea 12 0.007042254
##             Guinea-Bissau 12 0.007042254
##                     Haiti 12 0.007042254
##                  Honduras 12 0.007042254
##          Hong Kong, China 12 0.007042254
##                   Hungary 12 0.007042254
##                   Iceland 12 0.007042254
##                     India 12 0.007042254
##                 Indonesia 12 0.007042254
##                      Iran 12 0.007042254
##                      Iraq 12 0.007042254
##                   Ireland 12 0.007042254
##                    Israel 12 0.007042254
##                     Italy 12 0.007042254
##                   Jamaica 12 0.007042254
##                     Japan 12 0.007042254
##                    Jordan 12 0.007042254
##                     Kenya 12 0.007042254
##          Korea, Dem. Rep. 12 0.007042254
##               Korea, Rep. 12 0.007042254
##                    Kuwait 12 0.007042254
##                   Lebanon 12 0.007042254
##                   Lesotho 12 0.007042254
##                   Liberia 12 0.007042254
##                     Libya 12 0.007042254
##                Madagascar 12 0.007042254
##                    Malawi 12 0.007042254
##                  Malaysia 12 0.007042254
##                      Mali 12 0.007042254
##                Mauritania 12 0.007042254
##                 Mauritius 12 0.007042254
##                    Mexico 12 0.007042254
##                  Mongolia 12 0.007042254
##                Montenegro 12 0.007042254
##                   Morocco 12 0.007042254
##                Mozambique 12 0.007042254
##                   Myanmar 12 0.007042254
##                   Namibia 12 0.007042254
##                     Nepal 12 0.007042254
##               Netherlands 12 0.007042254
##               New Zealand 12 0.007042254
##                 Nicaragua 12 0.007042254
##                     Niger 12 0.007042254
##                   Nigeria 12 0.007042254
##                    Norway 12 0.007042254
##                      Oman 12 0.007042254
##                  Pakistan 12 0.007042254
##                    Panama 12 0.007042254
##                  Paraguay 12 0.007042254
##                      Peru 12 0.007042254
##               Philippines 12 0.007042254
##                    Poland 12 0.007042254
##                  Portugal 12 0.007042254
##               Puerto Rico 12 0.007042254
##                   Reunion 12 0.007042254
##                   Romania 12 0.007042254
##                    Rwanda 12 0.007042254
##     Sao Tome and Principe 12 0.007042254
##              Saudi Arabia 12 0.007042254
##                   Senegal 12 0.007042254
##                    Serbia 12 0.007042254
##              Sierra Leone 12 0.007042254
##                 Singapore 12 0.007042254
##           Slovak Republic 12 0.007042254
##                  Slovenia 12 0.007042254
##                   Somalia 12 0.007042254
##              South Africa 12 0.007042254
##                     Spain 12 0.007042254
##                 Sri Lanka 12 0.007042254
##                     Sudan 12 0.007042254
##                 Swaziland 12 0.007042254
##                    Sweden 12 0.007042254
##               Switzerland 12 0.007042254
##                     Syria 12 0.007042254
##                    Taiwan 12 0.007042254
##                  Tanzania 12 0.007042254
##                  Thailand 12 0.007042254
##                      Togo 12 0.007042254
##       Trinidad and Tobago 12 0.007042254
##                   Tunisia 12 0.007042254
##                    Turkey 12 0.007042254
##                    Uganda 12 0.007042254
##            United Kingdom 12 0.007042254
##             United States 12 0.007042254
##                   Uruguay 12 0.007042254
##                 Venezuela 12 0.007042254
##                   Vietnam 12 0.007042254
##        West Bank and Gaza 12 0.007042254
##               Yemen, Rep. 12 0.007042254
##                    Zambia 12 0.007042254
##                  Zimbabwe 12 0.007042254</code></pre>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="manipulating-dplyr.html#cb635-1" tabindex="-1"></a><span class="co"># If you want to add percentage ...</span></span>
<span id="cb635-2"><a href="manipulating-dplyr.html#cb635-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb635-3"><a href="manipulating-dplyr.html#cb635-3" tabindex="-1"></a>  <span class="fu">tabyl</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb635-4"><a href="manipulating-dplyr.html#cb635-4" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>(<span class="at">digits =</span> <span class="dv">0</span>, <span class="at">affix_sign =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##                   country  n percent
##               Afghanistan 12      1%
##                   Albania 12      1%
##                   Algeria 12      1%
##                    Angola 12      1%
##                 Argentina 12      1%
##                 Australia 12      1%
##                   Austria 12      1%
##                   Bahrain 12      1%
##                Bangladesh 12      1%
##                   Belgium 12      1%
##                     Benin 12      1%
##                   Bolivia 12      1%
##    Bosnia and Herzegovina 12      1%
##                  Botswana 12      1%
##                    Brazil 12      1%
##                  Bulgaria 12      1%
##              Burkina Faso 12      1%
##                   Burundi 12      1%
##                  Cambodia 12      1%
##                  Cameroon 12      1%
##                    Canada 12      1%
##  Central African Republic 12      1%
##                      Chad 12      1%
##                     Chile 12      1%
##                     China 12      1%
##                  Colombia 12      1%
##                   Comoros 12      1%
##          Congo, Dem. Rep. 12      1%
##               Congo, Rep. 12      1%
##                Costa Rica 12      1%
##             Cote d&#39;Ivoire 12      1%
##                   Croatia 12      1%
##                      Cuba 12      1%
##            Czech Republic 12      1%
##                   Denmark 12      1%
##                  Djibouti 12      1%
##        Dominican Republic 12      1%
##                   Ecuador 12      1%
##                     Egypt 12      1%
##               El Salvador 12      1%
##         Equatorial Guinea 12      1%
##                   Eritrea 12      1%
##                  Ethiopia 12      1%
##                   Finland 12      1%
##                    France 12      1%
##                     Gabon 12      1%
##                    Gambia 12      1%
##                   Germany 12      1%
##                     Ghana 12      1%
##                    Greece 12      1%
##                 Guatemala 12      1%
##                    Guinea 12      1%
##             Guinea-Bissau 12      1%
##                     Haiti 12      1%
##                  Honduras 12      1%
##          Hong Kong, China 12      1%
##                   Hungary 12      1%
##                   Iceland 12      1%
##                     India 12      1%
##                 Indonesia 12      1%
##                      Iran 12      1%
##                      Iraq 12      1%
##                   Ireland 12      1%
##                    Israel 12      1%
##                     Italy 12      1%
##                   Jamaica 12      1%
##                     Japan 12      1%
##                    Jordan 12      1%
##                     Kenya 12      1%
##          Korea, Dem. Rep. 12      1%
##               Korea, Rep. 12      1%
##                    Kuwait 12      1%
##                   Lebanon 12      1%
##                   Lesotho 12      1%
##                   Liberia 12      1%
##                     Libya 12      1%
##                Madagascar 12      1%
##                    Malawi 12      1%
##                  Malaysia 12      1%
##                      Mali 12      1%
##                Mauritania 12      1%
##                 Mauritius 12      1%
##                    Mexico 12      1%
##                  Mongolia 12      1%
##                Montenegro 12      1%
##                   Morocco 12      1%
##                Mozambique 12      1%
##                   Myanmar 12      1%
##                   Namibia 12      1%
##                     Nepal 12      1%
##               Netherlands 12      1%
##               New Zealand 12      1%
##                 Nicaragua 12      1%
##                     Niger 12      1%
##                   Nigeria 12      1%
##                    Norway 12      1%
##                      Oman 12      1%
##                  Pakistan 12      1%
##                    Panama 12      1%
##                  Paraguay 12      1%
##                      Peru 12      1%
##               Philippines 12      1%
##                    Poland 12      1%
##                  Portugal 12      1%
##               Puerto Rico 12      1%
##                   Reunion 12      1%
##                   Romania 12      1%
##                    Rwanda 12      1%
##     Sao Tome and Principe 12      1%
##              Saudi Arabia 12      1%
##                   Senegal 12      1%
##                    Serbia 12      1%
##              Sierra Leone 12      1%
##                 Singapore 12      1%
##           Slovak Republic 12      1%
##                  Slovenia 12      1%
##                   Somalia 12      1%
##              South Africa 12      1%
##                     Spain 12      1%
##                 Sri Lanka 12      1%
##                     Sudan 12      1%
##                 Swaziland 12      1%
##                    Sweden 12      1%
##               Switzerland 12      1%
##                     Syria 12      1%
##                    Taiwan 12      1%
##                  Tanzania 12      1%
##                  Thailand 12      1%
##                      Togo 12      1%
##       Trinidad and Tobago 12      1%
##                   Tunisia 12      1%
##                    Turkey 12      1%
##                    Uganda 12      1%
##            United Kingdom 12      1%
##             United States 12      1%
##                   Uruguay 12      1%
##                 Venezuela 12      1%
##                   Vietnam 12      1%
##        West Bank and Gaza 12      1%
##               Yemen, Rep. 12      1%
##                    Zambia 12      1%
##                  Zimbabwe 12      1%</code></pre>
</div>
<div id="create-variables" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Create variables<a href="manipulating-dplyr.html#create-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="change-values-using-conditions" class="section level4 hasAnchor" number="4.5.4.1">
<h4><span class="header-section-number">4.5.4.1</span> Change values using conditions<a href="manipulating-dplyr.html#change-values-using-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can think of <code>case_when()</code> (multiple conditions) as an extended version of <code>ifelse()</code> (binary conditions).</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="manipulating-dplyr.html#cb637-1" tabindex="-1"></a>mtcars <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb637-2"><a href="manipulating-dplyr.html#cb637-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cyl_dummy =</span> <span class="fu">case_when</span>(</span>
<span id="cb637-3"><a href="manipulating-dplyr.html#cb637-3" tabindex="-1"></a>    cyl <span class="sc">&gt;</span> <span class="fu">median</span>(cyl) <span class="sc">~</span> <span class="st">&quot;High&quot;</span>, <span class="co"># if condition</span></span>
<span id="cb637-4"><a href="manipulating-dplyr.html#cb637-4" tabindex="-1"></a>    cyl <span class="sc">&lt;</span> <span class="fu">median</span>(cyl) <span class="sc">~</span> <span class="st">&quot;Low&quot;</span>, <span class="co"># else if condition</span></span>
<span id="cb637-5"><a href="manipulating-dplyr.html#cb637-5" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Median&quot;</span></span>
<span id="cb637-6"><a href="manipulating-dplyr.html#cb637-6" tabindex="-1"></a>  )) <span class="co"># else condition</span></span>
<span id="cb637-7"><a href="manipulating-dplyr.html#cb637-7" tabindex="-1"></a></span>
<span id="cb637-8"><a href="manipulating-dplyr.html#cb637-8" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">pull</span>(cyl_dummy)</span></code></pre></div>
<pre><code>##  [1] &quot;Median&quot; &quot;Median&quot; &quot;Low&quot;    &quot;Median&quot; &quot;High&quot;   &quot;Median&quot; &quot;High&quot;   &quot;Low&quot;   
##  [9] &quot;Low&quot;    &quot;Median&quot; &quot;Median&quot; &quot;High&quot;   &quot;High&quot;   &quot;High&quot;   &quot;High&quot;   &quot;High&quot;  
## [17] &quot;High&quot;   &quot;Low&quot;    &quot;Low&quot;    &quot;Low&quot;    &quot;Low&quot;    &quot;High&quot;   &quot;High&quot;   &quot;High&quot;  
## [25] &quot;High&quot;   &quot;Low&quot;    &quot;Low&quot;    &quot;Low&quot;    &quot;High&quot;   &quot;Median&quot; &quot;High&quot;   &quot;Low&quot;</code></pre>
</div>
<div id="change-values-manually" class="section level4 hasAnchor" number="4.5.4.2">
<h4><span class="header-section-number">4.5.4.2</span> Change values manually<a href="manipulating-dplyr.html#change-values-manually" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="manipulating-dplyr.html#cb639-1" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span></span>
<span id="cb639-2"><a href="manipulating-dplyr.html#cb639-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cyl_dummy =</span> <span class="fu">recode</span>(cyl_dummy, <span class="co"># Target column</span></span>
<span id="cb639-3"><a href="manipulating-dplyr.html#cb639-3" tabindex="-1"></a>    <span class="st">&quot;High&quot;</span> <span class="ot">=</span> <span class="st">&quot;2&quot;</span>, <span class="co"># Old - New</span></span>
<span id="cb639-4"><a href="manipulating-dplyr.html#cb639-4" tabindex="-1"></a>    <span class="st">&quot;Low&quot;</span> <span class="ot">=</span> <span class="st">&quot;0&quot;</span>,</span>
<span id="cb639-5"><a href="manipulating-dplyr.html#cb639-5" tabindex="-1"></a>    <span class="st">&quot;Median&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span></span>
<span id="cb639-6"><a href="manipulating-dplyr.html#cb639-6" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb639-7"><a href="manipulating-dplyr.html#cb639-7" tabindex="-1"></a>  <span class="fu">pull</span>(cyl_dummy)</span></code></pre></div>
<pre><code>##  [1] &quot;1&quot; &quot;1&quot; &quot;0&quot; &quot;1&quot; &quot;2&quot; &quot;1&quot; &quot;2&quot; &quot;0&quot; &quot;0&quot; &quot;1&quot; &quot;1&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;0&quot; &quot;0&quot;
## [20] &quot;0&quot; &quot;0&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;2&quot; &quot;1&quot; &quot;2&quot; &quot;0&quot;</code></pre>
</div>
</div>
<div id="counting" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> Counting<a href="manipulating-dplyr.html#counting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>How many countries are in each continent?</li>
</ul>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="manipulating-dplyr.html#cb641-1" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb641-2"><a href="manipulating-dplyr.html#cb641-2" tabindex="-1"></a>  <span class="fu">count</span>(continent)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent     n
##   &lt;fct&gt;     &lt;int&gt;
## 1 Africa      624
## 2 Americas    300
## 3 Asia        396
## 4 Europe      360
## 5 Oceania      24</code></pre>
<ul>
<li>Let’s arrange the result.</li>
</ul>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="manipulating-dplyr.html#cb643-1" tabindex="-1"></a><span class="co"># Just add a new argument `sort = TRUE`</span></span>
<span id="cb643-2"><a href="manipulating-dplyr.html#cb643-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb643-3"><a href="manipulating-dplyr.html#cb643-3" tabindex="-1"></a>  <span class="fu">count</span>(continent, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent     n
##   &lt;fct&gt;     &lt;int&gt;
## 1 Africa      624
## 2 Asia        396
## 3 Europe      360
## 4 Americas    300
## 5 Oceania      24</code></pre>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="manipulating-dplyr.html#cb645-1" tabindex="-1"></a><span class="co"># Same as above; How nice!</span></span>
<span id="cb645-2"><a href="manipulating-dplyr.html#cb645-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb645-3"><a href="manipulating-dplyr.html#cb645-3" tabindex="-1"></a>  <span class="fu">count</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb645-4"><a href="manipulating-dplyr.html#cb645-4" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent     n
##   &lt;fct&gt;     &lt;int&gt;
## 1 Africa      624
## 2 Asia        396
## 3 Europe      360
## 4 Americas    300
## 5 Oceania      24</code></pre>
<p><strong>Challenge</strong></p>
<p>Count the number of observations per <code>continent</code> and <code>year</code> and arrange them in descending order.</p>
<p>Let’s take a deeper look at how things work under the hood.</p>
<ul>
<li><p><code>tally()</code> works similar to <code>nrow()</code>: Calculate the total number of cases in a dataframe</p></li>
<li><p><code>count</code> = <code>group_by()</code> + <code>tally()</code></p></li>
</ul>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="manipulating-dplyr.html#cb647-1" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb647-2"><a href="manipulating-dplyr.html#cb647-2" tabindex="-1"></a>  <span class="fu">tally</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1  1704</code></pre>
<ul>
<li><code>add_tally()</code> = <code>mutate(n = n())</code></li>
</ul>
<p><strong>Challenge</strong></p>
<p>What does n in the below example represent?</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="manipulating-dplyr.html#cb649-1" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb649-2"><a href="manipulating-dplyr.html#cb649-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(continent, country) <span class="sc">%&gt;%</span></span>
<span id="cb649-3"><a href="manipulating-dplyr.html#cb649-3" tabindex="-1"></a>  <span class="fu">add_tally</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1,704 × 3
##    continent country         n
##    &lt;fct&gt;     &lt;fct&gt;       &lt;int&gt;
##  1 Asia      Afghanistan  1704
##  2 Asia      Afghanistan  1704
##  3 Asia      Afghanistan  1704
##  4 Asia      Afghanistan  1704
##  5 Asia      Afghanistan  1704
##  6 Asia      Afghanistan  1704
##  7 Asia      Afghanistan  1704
##  8 Asia      Afghanistan  1704
##  9 Asia      Afghanistan  1704
## 10 Asia      Afghanistan  1704
## # ℹ 1,694 more rows</code></pre>
<ul>
<li><code>add_count</code></li>
</ul>
<p>Add count as a column.</p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="manipulating-dplyr.html#cb651-1" tabindex="-1"></a><span class="co"># Add count as a column</span></span>
<span id="cb651-2"><a href="manipulating-dplyr.html#cb651-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb651-3"><a href="manipulating-dplyr.html#cb651-3" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb651-4"><a href="manipulating-dplyr.html#cb651-4" tabindex="-1"></a>  <span class="fu">add_count</span>(year)</span></code></pre></div>
<pre><code>## # A tibble: 1,704 × 7
## # Groups:   continent [5]
##    country     continent  year lifeExp      pop gdpPercap     n
##    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;
##  1 Afghanistan Asia       1952    28.8  8425333      779.    33
##  2 Afghanistan Asia       1957    30.3  9240934      821.    33
##  3 Afghanistan Asia       1962    32.0 10267083      853.    33
##  4 Afghanistan Asia       1967    34.0 11537966      836.    33
##  5 Afghanistan Asia       1972    36.1 13079460      740.    33
##  6 Afghanistan Asia       1977    38.4 14880372      786.    33
##  7 Afghanistan Asia       1982    39.9 12881816      978.    33
##  8 Afghanistan Asia       1987    40.8 13867957      852.    33
##  9 Afghanistan Asia       1992    41.7 16317921      649.    33
## 10 Afghanistan Asia       1997    41.8 22227415      635.    33
## # ℹ 1,694 more rows</code></pre>
<p><strong>Challenge</strong></p>
<p>Do cases 1 and 2 in the below code chunk produce the same outputs? If so, why?</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="manipulating-dplyr.html#cb653-1" tabindex="-1"></a><span class="co"># Case 1</span></span>
<span id="cb653-2"><a href="manipulating-dplyr.html#cb653-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb653-3"><a href="manipulating-dplyr.html#cb653-3" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">%&gt;%</span></span>
<span id="cb653-4"><a href="manipulating-dplyr.html#cb653-4" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 60 × 3
## # Groups:   continent, year [60]
##    continent  year     n
##    &lt;fct&gt;     &lt;int&gt; &lt;int&gt;
##  1 Africa     1952    52
##  2 Africa     1957    52
##  3 Africa     1962    52
##  4 Africa     1967    52
##  5 Africa     1972    52
##  6 Africa     1977    52
##  7 Africa     1982    52
##  8 Africa     1987    52
##  9 Africa     1992    52
## 10 Africa     1997    52
## # ℹ 50 more rows</code></pre>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="manipulating-dplyr.html#cb655-1" tabindex="-1"></a><span class="co"># Case 2</span></span>
<span id="cb655-2"><a href="manipulating-dplyr.html#cb655-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb655-3"><a href="manipulating-dplyr.html#cb655-3" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb655-4"><a href="manipulating-dplyr.html#cb655-4" tabindex="-1"></a>  <span class="fu">count</span>(year)</span></code></pre></div>
<pre><code>## # A tibble: 60 × 3
## # Groups:   continent [5]
##    continent  year     n
##    &lt;fct&gt;     &lt;int&gt; &lt;int&gt;
##  1 Africa     1952    52
##  2 Africa     1957    52
##  3 Africa     1962    52
##  4 Africa     1967    52
##  5 Africa     1972    52
##  6 Africa     1977    52
##  7 Africa     1982    52
##  8 Africa     1987    52
##  9 Africa     1992    52
## 10 Africa     1997    52
## # ℹ 50 more rows</code></pre>
<p><code>count()</code> is a simple function, but it is still helpful to learn an essential concept underlying complex data wrangling: split-apply-combine strategy. For more information, read Wickham’s article (2011) <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.182.5667&amp;rep=rep1&amp;type=pdf">“The Split-Apply-Combine Strategy for Data Analysis”</a> published in the <em>Journal of Statistical Software</em> (especially pages 7-8). <a href="https://github.com/hadley/plyr"><code>plyr</code></a> was the package (retired) that demonstrated this idea, which has evolved into two directions: <a href="https://dplyr.tidyverse.org/">dplyr</a> (for data frames) and <a href="https://purrr.tidyverse.org/">purrr</a> (for lists)</p>
</div>
<div id="summarizing" class="section level3 hasAnchor" number="4.5.6">
<h3><span class="header-section-number">4.5.6</span> Summarizing<a href="manipulating-dplyr.html#summarizing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="basic" class="section level4 hasAnchor" number="4.5.6.1">
<h4><span class="header-section-number">4.5.6.1</span> Basic<a href="manipulating-dplyr.html#basic" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Create a summary</li>
<li>Think of <code>summarise()</code> as an extended version of <code>count()</code>.</li>
</ul>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="manipulating-dplyr.html#cb657-1" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb657-2"><a href="manipulating-dplyr.html#cb657-2" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb657-3"><a href="manipulating-dplyr.html#cb657-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb657-4"><a href="manipulating-dplyr.html#cb657-4" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb657-5"><a href="manipulating-dplyr.html#cb657-5" tabindex="-1"></a>    <span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb657-6"><a href="manipulating-dplyr.html#cb657-6" tabindex="-1"></a>    <span class="at">sd_gdp =</span> <span class="fu">sd</span>(gdpPercap)</span>
<span id="cb657-7"><a href="manipulating-dplyr.html#cb657-7" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   continent     n mean_gdp sd_gdp
##   &lt;fct&gt;     &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 Africa      624    2194.  2828.
## 2 Americas    300    7136.  6397.
## 3 Asia        396    7902. 14045.
## 4 Europe      360   14469.  9355.
## 5 Oceania      24   18622.  6359.</code></pre>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="manipulating-dplyr.html#cb659-1" tabindex="-1"></a>tablea <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb659-2"><a href="manipulating-dplyr.html#cb659-2" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb659-3"><a href="manipulating-dplyr.html#cb659-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb659-4"><a href="manipulating-dplyr.html#cb659-4" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb659-5"><a href="manipulating-dplyr.html#cb659-5" tabindex="-1"></a>    <span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb659-6"><a href="manipulating-dplyr.html#cb659-6" tabindex="-1"></a>    <span class="at">sd_gdp =</span> <span class="fu">sd</span>(gdpPercap)</span>
<span id="cb659-7"><a href="manipulating-dplyr.html#cb659-7" tabindex="-1"></a>  )</span></code></pre></div>
<ul>
<li>Produce publishable tables</li>
</ul>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="manipulating-dplyr.html#cb660-1" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb660-2"><a href="manipulating-dplyr.html#cb660-2" tabindex="-1"></a>  kableExtra,</span>
<span id="cb660-3"><a href="manipulating-dplyr.html#cb660-3" tabindex="-1"></a>  flextable</span>
<span id="cb660-4"><a href="manipulating-dplyr.html#cb660-4" tabindex="-1"></a>)</span>
<span id="cb660-5"><a href="manipulating-dplyr.html#cb660-5" tabindex="-1"></a></span>
<span id="cb660-6"><a href="manipulating-dplyr.html#cb660-6" tabindex="-1"></a><span class="co"># For HTML and LaTeX</span></span>
<span id="cb660-7"><a href="manipulating-dplyr.html#cb660-7" tabindex="-1"></a>tablea <span class="sc">%&gt;%</span> kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">continent</th>
<th align="right">n</th>
<th align="right">mean_gdp</th>
<th align="right">sd_gdp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Africa</td>
<td align="right">624</td>
<td align="right">2193.755</td>
<td align="right">2827.930</td>
</tr>
<tr class="even">
<td align="left">Americas</td>
<td align="right">300</td>
<td align="right">7136.110</td>
<td align="right">6396.764</td>
</tr>
<tr class="odd">
<td align="left">Asia</td>
<td align="right">396</td>
<td align="right">7902.150</td>
<td align="right">14045.373</td>
</tr>
<tr class="even">
<td align="left">Europe</td>
<td align="right">360</td>
<td align="right">14469.476</td>
<td align="right">9355.213</td>
</tr>
<tr class="odd">
<td align="left">Oceania</td>
<td align="right">24</td>
<td align="right">18621.609</td>
<td align="right">6358.983</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="manipulating-dplyr.html#cb661-1" tabindex="-1"></a><span class="co"># For HTML and MS Office suite</span></span>
<span id="cb661-2"><a href="manipulating-dplyr.html#cb661-2" tabindex="-1"></a>tablea <span class="sc">%&gt;%</span> flextable<span class="sc">::</span><span class="fu">flextable</span>()</span></code></pre></div>
<div class="tabwid"><style>.cl-23cd1012{}.cl-23ca0462{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-23cb480e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-23cb4818{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-23cb560a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23cb560b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23cb560c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23cb5614{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23cb5615{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-23cb5616{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-23cd1012'><thead><tr style="overflow-wrap:break-word;"><th class="cl-23cb560a"><p class="cl-23cb480e"><span class="cl-23ca0462">continent</span></p></th><th class="cl-23cb560b"><p class="cl-23cb4818"><span class="cl-23ca0462">n</span></p></th><th class="cl-23cb560b"><p class="cl-23cb4818"><span class="cl-23ca0462">mean_gdp</span></p></th><th class="cl-23cb560b"><p class="cl-23cb4818"><span class="cl-23ca0462">sd_gdp</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-23cb560c"><p class="cl-23cb480e"><span class="cl-23ca0462">Africa</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">624</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">2,193.755</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">2,827.930</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-23cb560c"><p class="cl-23cb480e"><span class="cl-23ca0462">Americas</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">300</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">7,136.110</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">6,396.764</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-23cb560c"><p class="cl-23cb480e"><span class="cl-23ca0462">Asia</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">396</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">7,902.150</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">14,045.373</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-23cb560c"><p class="cl-23cb480e"><span class="cl-23ca0462">Europe</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">360</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">14,469.476</span></p></td><td class="cl-23cb5614"><p class="cl-23cb4818"><span class="cl-23ca0462">9,355.213</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-23cb5615"><p class="cl-23cb480e"><span class="cl-23ca0462">Oceania</span></p></td><td class="cl-23cb5616"><p class="cl-23cb4818"><span class="cl-23ca0462">24</span></p></td><td class="cl-23cb5616"><p class="cl-23cb4818"><span class="cl-23ca0462">18,621.609</span></p></td><td class="cl-23cb5616"><p class="cl-23cb4818"><span class="cl-23ca0462">6,358.983</span></p></td></tr></tbody></table></div>
</div>
<div id="scoped-summaries" class="section level4 hasAnchor" number="4.5.6.2">
<h4><span class="header-section-number">4.5.6.2</span> Scoped summaries<a href="manipulating-dplyr.html#scoped-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Old way</p></li>
<li><p><code>summarise_all()</code></p></li>
</ul>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="manipulating-dplyr.html#cb662-1" tabindex="-1"></a><span class="co"># Create a wide-shaped data example</span></span>
<span id="cb662-2"><a href="manipulating-dplyr.html#cb662-2" tabindex="-1"></a>wide_gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb662-3"><a href="manipulating-dplyr.html#cb662-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb662-4"><a href="manipulating-dplyr.html#cb662-4" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb662-5"><a href="manipulating-dplyr.html#cb662-5" tabindex="-1"></a>    <span class="at">names_from =</span> country,</span>
<span id="cb662-6"><a href="manipulating-dplyr.html#cb662-6" tabindex="-1"></a>    <span class="at">values_from =</span> gdpPercap</span>
<span id="cb662-7"><a href="manipulating-dplyr.html#cb662-7" tabindex="-1"></a>  )</span>
<span id="cb662-8"><a href="manipulating-dplyr.html#cb662-8" tabindex="-1"></a></span>
<span id="cb662-9"><a href="manipulating-dplyr.html#cb662-9" tabindex="-1"></a><span class="co"># Apply summarise_all</span></span>
<span id="cb662-10"><a href="manipulating-dplyr.html#cb662-10" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb662-11"><a href="manipulating-dplyr.html#cb662-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb662-12"><a href="manipulating-dplyr.html#cb662-12" tabindex="-1"></a>  <span class="fu">summarise_all</span>(mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 30
##   Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<ul>
<li><code>summarise_if()</code>: using a logical condition</li>
</ul>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="manipulating-dplyr.html#cb664-1" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb664-2"><a href="manipulating-dplyr.html#cb664-2" tabindex="-1"></a>  <span class="fu">summarise_if</span>(is.double, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 31
##   lifeExp Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1    71.9   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<ul>
<li><p><code>summarise_at()</code></p></li>
<li><p><code>vars() = select()</code></p></li>
</ul>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="manipulating-dplyr.html#cb666-1" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb666-2"><a href="manipulating-dplyr.html#cb666-2" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb666-3"><a href="manipulating-dplyr.html#cb666-3" tabindex="-1"></a>    mean,</span>
<span id="cb666-4"><a href="manipulating-dplyr.html#cb666-4" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb666-5"><a href="manipulating-dplyr.html#cb666-5" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 30
##   Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="manipulating-dplyr.html#cb668-1" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb668-2"><a href="manipulating-dplyr.html#cb668-2" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="fu">contains</span>(<span class="st">&quot;life&quot;</span>)),</span>
<span id="cb668-3"><a href="manipulating-dplyr.html#cb668-3" tabindex="-1"></a>    mean,</span>
<span id="cb668-4"><a href="manipulating-dplyr.html#cb668-4" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb668-5"><a href="manipulating-dplyr.html#cb668-5" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   lifeExp
##     &lt;dbl&gt;
## 1    71.9</code></pre>
<p><strong>Additional tips</strong></p>
<div class="float">
<img src="https://github.com/rstudio/concept-maps/raw/master/en/regular-expressions.svg" alt="Concept map for regular expressions. By Monica Alonso, Greg Wilson." />
<div class="figcaption">Concept map for regular expressions. By Monica Alonso, Greg Wilson.</div>
</div>
<ul>
<li><p>New way</p></li>
<li><p><code>summarise()</code> + <code>across()</code></p></li>
</ul>
<div class="float">
<img src="https://github.com/rstudio/concept-maps/raw/master/en/across.svg" alt="Concept map for across. By Emma Vestesson" />
<div class="figcaption">Concept map for across. By Emma Vestesson</div>
</div>
<ul>
<li><p>If you find using <code>summarise_all()</code>, <code>summarise_if()</code> and <code>summarise_at()</code> confusing, here’s a solution: use <code>summarise()</code> with <code>across()</code>.</p></li>
<li><p><code>summarise_all()</code></p></li>
</ul>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="manipulating-dplyr.html#cb670-1" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb670-2"><a href="manipulating-dplyr.html#cb670-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(Albania<span class="sc">:</span><span class="st">`</span><span class="at">United Kingdom</span><span class="st">`</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `summarise()`.
## ℹ In argument: `across(Albania:`United Kingdom`, mean, na.rm = TRUE)`.
## Caused by warning:
## ! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.
## Supply arguments directly to `.fns` through an anonymous function instead.
## 
##   # Previously
##   across(a:b, mean, na.rm = TRUE)
## 
##   # Now
##   across(a:b, \(x) mean(x, na.rm = TRUE))</code></pre>
<pre><code>## # A tibble: 1 × 30
##   Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="manipulating-dplyr.html#cb673-1" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb673-2"><a href="manipulating-dplyr.html#cb673-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 30
##   Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<ul>
<li><code>summarise_if()</code></li>
</ul>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="manipulating-dplyr.html#cb675-1" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb675-2"><a href="manipulating-dplyr.html#cb675-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(is.double, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `summarise()`.
## ℹ In argument: `across(is.double, mean, na.rm = TRUE)`.
## Caused by warning:
## ! Use of bare predicate functions was deprecated in tidyselect 1.1.0.
## ℹ Please use wrap predicates in `where()` instead.
##   # Was:
##   data %&gt;% select(is.double)
## 
##   # Now:
##   data %&gt;% select(where(is.double))</code></pre>
<pre><code>## # A tibble: 1 × 31
##   lifeExp Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1    71.9   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<ul>
<li><code>summarise_at()</code></li>
</ul>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="manipulating-dplyr.html#cb678-1" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb678-2"><a href="manipulating-dplyr.html#cb678-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb678-3"><a href="manipulating-dplyr.html#cb678-3" tabindex="-1"></a>    mean,</span>
<span id="cb678-4"><a href="manipulating-dplyr.html#cb678-4" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb678-5"><a href="manipulating-dplyr.html#cb678-5" tabindex="-1"></a>  ))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 30
##   Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="manipulating-dplyr.html#cb680-1" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb680-2"><a href="manipulating-dplyr.html#cb680-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">&quot;life&quot;</span>),</span>
<span id="cb680-3"><a href="manipulating-dplyr.html#cb680-3" tabindex="-1"></a>    mean,</span>
<span id="cb680-4"><a href="manipulating-dplyr.html#cb680-4" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb680-5"><a href="manipulating-dplyr.html#cb680-5" tabindex="-1"></a>  ))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   lifeExp
##     &lt;dbl&gt;
## 1    71.9</code></pre>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="manipulating-dplyr.html#cb682-1" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb682-2"><a href="manipulating-dplyr.html#cb682-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">&quot;A&quot;</span>, <span class="at">ignore.case =</span> <span class="cn">FALSE</span>)))</span></code></pre></div>
<pre><code>## Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in dplyr 1.1.0.
## ℹ Please use `reframe()` instead.
## ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()` always returns an ungrouped data frame and adjust accordingly.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<pre><code>## # A tibble: 360 × 2
##    Albania Austria
##      &lt;dbl&gt;   &lt;dbl&gt;
##  1   1601.      NA
##  2   1942.      NA
##  3   2313.      NA
##  4   2760.      NA
##  5   3313.      NA
##  6   3533.      NA
##  7   3631.      NA
##  8   3739.      NA
##  9   2497.      NA
## 10   3193.      NA
## # ℹ 350 more rows</code></pre>
<p>Note that this workshop does not cover creating and manipulating variables using <code>mutate()</code> because many techniques you learned from playing with <code>summarise()</code> can be directly applied to <code>mutate()</code>.</p>
<p><strong>Challenge</strong></p>
<ol style="list-style-type: decimal">
<li><p>Summarize the average GDP of countries whose names start with the alphabet “A.”</p></li>
<li><p>Turn the summary dataframe into a publishable table using either <code>kableExtra</code> or <code>flextable</code> package.</p></li>
</ol>
</div>
<div id="tabulation-tbd" class="section level4 hasAnchor" number="4.5.6.3">
<h4><span class="header-section-number">4.5.6.3</span> Tabulation (TBD)<a href="manipulating-dplyr.html#tabulation-tbd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="grouping" class="section level3 hasAnchor" number="4.5.7">
<h3><span class="header-section-number">4.5.7</span> Grouping<a href="manipulating-dplyr.html#grouping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="grouped-summaries" class="section level4 hasAnchor" number="4.5.7.1">
<h4><span class="header-section-number">4.5.7.1</span> Grouped summaries<a href="manipulating-dplyr.html#grouped-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Calculate the mean of <code>gdpPercap</code>.</p></li>
<li><p>Some functions are designed to work together. For instance, the <code>group_by()</code> function defines the strata you will use for summary statistics. Then, use <code>summarise()</code> to obtain summary statistics.</p></li>
</ul>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="manipulating-dplyr.html#cb685-1" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb685-2"><a href="manipulating-dplyr.html#cb685-2" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb685-3"><a href="manipulating-dplyr.html#cb685-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent mean_gdp
##   &lt;fct&gt;        &lt;dbl&gt;
## 1 Africa       2194.
## 2 Americas     7136.
## 3 Asia         7902.
## 4 Europe      14469.
## 5 Oceania     18622.</code></pre>
<ul>
<li>Calculate multiple summary statistics.</li>
</ul>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="manipulating-dplyr.html#cb687-1" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb687-2"><a href="manipulating-dplyr.html#cb687-2" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb687-3"><a href="manipulating-dplyr.html#cb687-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb687-4"><a href="manipulating-dplyr.html#cb687-4" tabindex="-1"></a>    <span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb687-5"><a href="manipulating-dplyr.html#cb687-5" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>()</span>
<span id="cb687-6"><a href="manipulating-dplyr.html#cb687-6" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   continent mean_gdp count
##   &lt;fct&gt;        &lt;dbl&gt; &lt;int&gt;
## 1 Africa       2194.   624
## 2 Americas     7136.   300
## 3 Asia         7902.   396
## 4 Europe      14469.   360
## 5 Oceania     18622.    24</code></pre>
<p><strong>Optional</strong></p>
<ul>
<li>Other summary statistics</li>
</ul>
<ol style="list-style-type: decimal">
<li>Measures of spread: <code>median(x)</code>, <code>sd(x)</code>, <code>IQR(x)</code>, <code>mad(x)</code> (the median absolute deviation)</li>
</ol>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="manipulating-dplyr.html#cb689-1" tabindex="-1"></a><span class="co"># The Interquartile Range = The Difference Between 75t and 25t Percentiles</span></span>
<span id="cb689-2"><a href="manipulating-dplyr.html#cb689-2" tabindex="-1"></a></span>
<span id="cb689-3"><a href="manipulating-dplyr.html#cb689-3" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb689-4"><a href="manipulating-dplyr.html#cb689-4" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb689-5"><a href="manipulating-dplyr.html#cb689-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">IQR_gdp =</span> <span class="fu">IQR</span>(gdpPercap))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent IQR_gdp
##   &lt;fct&gt;       &lt;dbl&gt;
## 1 Africa      1616.
## 2 Americas    4402.
## 3 Asia        7492.
## 4 Europe     13248.
## 5 Oceania     8072.</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Measures of rank: <code>min(x)</code>, <code>quantile(x, 0.25)</code>, <code>max(x)</code></li>
</ol>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="manipulating-dplyr.html#cb691-1" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb691-2"><a href="manipulating-dplyr.html#cb691-2" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb691-3"><a href="manipulating-dplyr.html#cb691-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb691-4"><a href="manipulating-dplyr.html#cb691-4" tabindex="-1"></a>    <span class="at">min_gdp =</span> <span class="fu">min</span>(gdpPercap),</span>
<span id="cb691-5"><a href="manipulating-dplyr.html#cb691-5" tabindex="-1"></a>    <span class="at">max_gdp =</span> <span class="fu">max</span>(gdpPercap)</span>
<span id="cb691-6"><a href="manipulating-dplyr.html#cb691-6" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   continent min_gdp max_gdp
##   &lt;fct&gt;       &lt;dbl&gt;   &lt;dbl&gt;
## 1 Africa       241.  21951.
## 2 Americas    1202.  42952.
## 3 Asia         331  113523.
## 4 Europe       974.  49357.
## 5 Oceania    10040.  34435.</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Measures of position: <code>first(x)</code>, <code>last(x)</code>, <code>nth(x, 2)</code></li>
</ol>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="manipulating-dplyr.html#cb693-1" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb693-2"><a href="manipulating-dplyr.html#cb693-2" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb693-3"><a href="manipulating-dplyr.html#cb693-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb693-4"><a href="manipulating-dplyr.html#cb693-4" tabindex="-1"></a>    <span class="at">first_gdp =</span> <span class="fu">first</span>(gdpPercap),</span>
<span id="cb693-5"><a href="manipulating-dplyr.html#cb693-5" tabindex="-1"></a>    <span class="at">last_gdp =</span> <span class="fu">last</span>(gdpPercap)</span>
<span id="cb693-6"><a href="manipulating-dplyr.html#cb693-6" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   continent first_gdp last_gdp
##   &lt;fct&gt;         &lt;dbl&gt;    &lt;dbl&gt;
## 1 Africa        2449.     470.
## 2 Americas      5911.   11416.
## 3 Asia           779.    2281.
## 4 Europe        1601.   33203.
## 5 Oceania      10040.   25185.</code></pre>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="manipulating-dplyr.html#cb695-1" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb695-2"><a href="manipulating-dplyr.html#cb695-2" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb695-3"><a href="manipulating-dplyr.html#cb695-3" tabindex="-1"></a>  <span class="fu">arrange</span>(gdpPercap) <span class="sc">%&gt;%</span> <span class="co"># Adding arrange</span></span>
<span id="cb695-4"><a href="manipulating-dplyr.html#cb695-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb695-5"><a href="manipulating-dplyr.html#cb695-5" tabindex="-1"></a>    <span class="at">first_gdp =</span> <span class="fu">first</span>(gdpPercap),</span>
<span id="cb695-6"><a href="manipulating-dplyr.html#cb695-6" tabindex="-1"></a>    <span class="at">last_gdp =</span> <span class="fu">last</span>(gdpPercap)</span>
<span id="cb695-7"><a href="manipulating-dplyr.html#cb695-7" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   continent first_gdp last_gdp
##   &lt;fct&gt;         &lt;dbl&gt;    &lt;dbl&gt;
## 1 Africa         241.   21951.
## 2 Americas      1202.   42952.
## 3 Asia           331   113523.
## 4 Europe         974.   49357.
## 5 Oceania      10040.   34435.</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Measures of counts: <code>n(x)</code> (all rows), <code>sum(!is.na(x))</code> (only non-missing rows) = <code>n_distinct(x)</code></li>
</ol>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="manipulating-dplyr.html#cb697-1" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb697-2"><a href="manipulating-dplyr.html#cb697-2" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb697-3"><a href="manipulating-dplyr.html#cb697-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ns =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent    ns
##   &lt;fct&gt;     &lt;int&gt;
## 1 Africa      624
## 2 Americas    300
## 3 Asia        396
## 4 Europe      360
## 5 Oceania      24</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Counts and proportions of logical values: <code>sum(condition about x)</code> (the number of TRUEs in x), <code>mean(condition about x)</code> (the proportion of TRUEs in x)</li>
</ol>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="manipulating-dplyr.html#cb699-1" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb699-2"><a href="manipulating-dplyr.html#cb699-2" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb699-3"><a href="manipulating-dplyr.html#cb699-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rich_countries =</span> <span class="fu">mean</span>(gdpPercap <span class="sc">&gt;</span> <span class="dv">20000</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent rich_countries
##   &lt;fct&gt;              &lt;dbl&gt;
## 1 Africa           0.00481
## 2 Americas         0.05   
## 3 Asia             0.111  
## 4 Europe           0.261  
## 5 Oceania          0.333</code></pre>
<p><strong>Additional tips</strong></p>
<p>Also, check out window functions such as <code>cumsum()</code> and <code>lag()</code>. Window functions are a variant of aggregate functions that take a vector as input then return a vector of the same length as an output.</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="manipulating-dplyr.html#cb701-1" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb701-2"><a href="manipulating-dplyr.html#cb701-2" tabindex="-1"></a></span>
<span id="cb701-3"><a href="manipulating-dplyr.html#cb701-3" tabindex="-1"></a><span class="co"># Typical aggregate function</span></span>
<span id="cb701-4"><a href="manipulating-dplyr.html#cb701-4" tabindex="-1"></a><span class="fu">sum</span>(vec) <span class="co"># The output length is one</span></span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="manipulating-dplyr.html#cb703-1" tabindex="-1"></a><span class="co"># Window function</span></span>
<span id="cb703-2"><a href="manipulating-dplyr.html#cb703-2" tabindex="-1"></a><span class="fu">cumsum</span>(vec) <span class="co"># The output length is ten</span></span></code></pre></div>
<pre><code>##  [1]  1  3  6 10 15 21 28 36 45 55</code></pre>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="manipulating-dplyr.html#cb705-1" tabindex="-1"></a><span class="co"># Let&#39;s compare them side-by-side</span></span>
<span id="cb705-2"><a href="manipulating-dplyr.html#cb705-2" tabindex="-1"></a><span class="fu">compare</span>(</span>
<span id="cb705-3"><a href="manipulating-dplyr.html#cb705-3" tabindex="-1"></a>  <span class="fu">sum</span>(vec),</span>
<span id="cb705-4"><a href="manipulating-dplyr.html#cb705-4" tabindex="-1"></a>  <span class="fu">cumsum</span>(vec)</span>
<span id="cb705-5"><a href="manipulating-dplyr.html#cb705-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## `old`: 55                         
## `new`:  1 3 6 10 15 21 28 36 45 55</code></pre>
</div>
</div>
<div id="joining" class="section level3 hasAnchor" number="4.5.8">
<h3><span class="header-section-number">4.5.8</span> Joining<a href="manipulating-dplyr.html#joining" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Relational data = multiple tables of data</p>
<div class="float">
<img src="https://d33wubrfki0l68.cloudfront.net/245292d1ea724f6c3fd8a92063dcd7bfb9758d02/5751b/diagrams/relational-nycflights.png" alt="Relational data example" />
<div class="figcaption">Relational data example</div>
</div>
<p><strong>Key ideas</strong></p>
<ul>
<li>A <strong>primary key</strong> “uniquely identifies an observation in its table”</li>
</ul>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="manipulating-dplyr.html#cb707-1" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb707-2"><a href="manipulating-dplyr.html#cb707-2" tabindex="-1"></a>planes<span class="sc">$</span>tailnum <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## [1] &quot;N10156&quot; &quot;N102UW&quot; &quot;N103US&quot; &quot;N104UW&quot; &quot;N10575&quot; &quot;N105UW&quot;</code></pre>
<p>Verify primary key</p>
<p><code>tailnum</code> should be unique.</p>
<p><strong>Challenge</strong></p>
<p>What do you expect the outcome?</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="manipulating-dplyr.html#cb709-1" tabindex="-1"></a>planes <span class="sc">%&gt;%</span></span>
<span id="cb709-2"><a href="manipulating-dplyr.html#cb709-2" tabindex="-1"></a>  <span class="fu">count</span>(tailnum) <span class="sc">%&gt;%</span></span>
<span id="cb709-3"><a href="manipulating-dplyr.html#cb709-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 0 × 2
## # ℹ 2 variables: tailnum &lt;chr&gt;, n &lt;int&gt;</code></pre>
<p><strong>Optional</strong></p>
<p>If a dataframe doesn’t have a primary key, you can add one called a <strong>surrogate</strong> key.</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="manipulating-dplyr.html#cb711-1" tabindex="-1"></a><span class="co"># Toy example</span></span>
<span id="cb711-2"><a href="manipulating-dplyr.html#cb711-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb711-3"><a href="manipulating-dplyr.html#cb711-3" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb711-4"><a href="manipulating-dplyr.html#cb711-4" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb711-5"><a href="manipulating-dplyr.html#cb711-5" tabindex="-1"></a>)</span>
<span id="cb711-6"><a href="manipulating-dplyr.html#cb711-6" tabindex="-1"></a></span>
<span id="cb711-7"><a href="manipulating-dplyr.html#cb711-7" tabindex="-1"></a><span class="co"># Add a row_index column</span></span>
<span id="cb711-8"><a href="manipulating-dplyr.html#cb711-8" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">rowid_to_column</span>(<span class="st">&quot;ID&quot;</span>)</span></code></pre></div>
<ul>
<li>A <strong>foreign</strong> key “uniquely identifies an observation in another table.”</li>
</ul>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="manipulating-dplyr.html#cb712-1" tabindex="-1"></a>flights<span class="sc">$</span>tailnum <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## [1] &quot;N14228&quot; &quot;N24211&quot; &quot;N619AA&quot; &quot;N804JB&quot; &quot;N668DN&quot; &quot;N39463&quot;</code></pre>
<p>For joining, don’t be distracted by other details and focus on KEYS!</p>
<div id="mutating-joins" class="section level4 hasAnchor" number="4.5.8.1">
<h4><span class="header-section-number">4.5.8.1</span> Mutating joins<a href="manipulating-dplyr.html#mutating-joins" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Add new variables to one data frame from matching observations in another”</p>
</blockquote>
<p>Using a simple toy example is great because it is easy to see how things work in that much narrow context.</p>
<ul>
<li>Toy example</li>
</ul>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="manipulating-dplyr.html#cb714-1" tabindex="-1"></a><span class="co"># Table 1</span></span>
<span id="cb714-2"><a href="manipulating-dplyr.html#cb714-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb714-3"><a href="manipulating-dplyr.html#cb714-3" tabindex="-1"></a>  <span class="at">key =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb714-4"><a href="manipulating-dplyr.html#cb714-4" tabindex="-1"></a>  <span class="at">val_x =</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>, <span class="st">&quot;x4&quot;</span>)</span>
<span id="cb714-5"><a href="manipulating-dplyr.html#cb714-5" tabindex="-1"></a>)</span>
<span id="cb714-6"><a href="manipulating-dplyr.html#cb714-6" tabindex="-1"></a></span>
<span id="cb714-7"><a href="manipulating-dplyr.html#cb714-7" tabindex="-1"></a><span class="co"># Table 2</span></span>
<span id="cb714-8"><a href="manipulating-dplyr.html#cb714-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb714-9"><a href="manipulating-dplyr.html#cb714-9" tabindex="-1"></a>  <span class="at">key =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb714-10"><a href="manipulating-dplyr.html#cb714-10" tabindex="-1"></a>  <span class="at">val_y =</span> <span class="fu">c</span>(<span class="st">&quot;y1&quot;</span>, <span class="st">&quot;y2&quot;</span>, <span class="st">&quot;y3&quot;</span>, <span class="st">&quot;y4&quot;</span>, <span class="st">&quot;y5&quot;</span>)</span>
<span id="cb714-11"><a href="manipulating-dplyr.html#cb714-11" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li>Inner Join</li>
</ul>
<p><code>inner_join()</code> keeps the matched values in both tables. If the left table is a subset of the right table, then <code>left_join()</code> is the same as <code>inner_join()</code>.</p>
<p><strong>Challenge</strong></p>
<p>What is going to be the shared keys?</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="manipulating-dplyr.html#cb715-1" tabindex="-1"></a><span class="fu">inner_join</span>(x, y)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(key)`</code></pre>
<pre><code>## # A tibble: 4 × 3
##     key val_x val_y
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1   
## 2     2 x2    y2   
## 3     3 x3    y3   
## 4     4 x4    y4</code></pre>
<div class="float">
<img src="https://d33wubrfki0l68.cloudfront.net/aeab386461820b029b7e7606ccff1286f623bae1/ef0d4/diagrams/join-venn.png" alt="Mutating joins" />
<div class="figcaption">Mutating joins</div>
</div>
<ul>
<li>Left Join</li>
</ul>
<p><code>left_join()</code>, <code>right_join()</code> and <code>full_join()</code> are outer join functions. Unlike <code>inner_join()</code>, outer join functions keep observations that appear in at least one of the tables.</p>
<p><code>left_join()</code> keeps only the matched observations in the right table.</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="manipulating-dplyr.html#cb718-1" tabindex="-1"></a><span class="fu">left_join</span>(x, y)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(key)`</code></pre>
<pre><code>## # A tibble: 4 × 3
##     key val_x val_y
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1   
## 2     2 x2    y2   
## 3     3 x3    y3   
## 4     4 x4    y4</code></pre>
<ul>
<li>Right Join</li>
</ul>
<p><code>right_join()</code> does the opposite.</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="manipulating-dplyr.html#cb721-1" tabindex="-1"></a><span class="fu">right_join</span>(x, y)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(key)`</code></pre>
<pre><code>## # A tibble: 5 × 3
##     key val_x val_y
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1   
## 2     2 x2    y2   
## 3     3 x3    y3   
## 4     4 x4    y4   
## 5     5 &lt;NA&gt;  y5</code></pre>
<ul>
<li>Full Join</li>
</ul>
<p><code>full_join()</code> keeps the observations from both tables. NAs were recorded in one of the two tables if they were unmatched.</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="manipulating-dplyr.html#cb724-1" tabindex="-1"></a><span class="fu">full_join</span>(x, y)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(key)`</code></pre>
<pre><code>## # A tibble: 5 × 3
##     key val_x val_y
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1   
## 2     2 x2    y2   
## 3     3 x3    y3   
## 4     4 x4    y4   
## 5     5 &lt;NA&gt;  y5</code></pre>
</div>
<div id="filtering-joins" class="section level4 hasAnchor" number="4.5.8.2">
<h4><span class="header-section-number">4.5.8.2</span> Filtering joins<a href="manipulating-dplyr.html#filtering-joins" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Filter observations from one data frame based on whether they match an observation in the other table.</p>
</blockquote>
<ul>
<li>Semi Join</li>
</ul>
<p>In SQL, this type of query is also called subqueries.</p>
<ul>
<li>Filtering without joining</li>
</ul>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="manipulating-dplyr.html#cb727-1" tabindex="-1"></a><span class="co"># Create the list of the top 10 destinations</span></span>
<span id="cb727-2"><a href="manipulating-dplyr.html#cb727-2" tabindex="-1"></a>top_dest <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb727-3"><a href="manipulating-dplyr.html#cb727-3" tabindex="-1"></a>  <span class="fu">count</span>(dest, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb727-4"><a href="manipulating-dplyr.html#cb727-4" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Selecting by n</code></pre>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="manipulating-dplyr.html#cb729-1" tabindex="-1"></a><span class="co"># Filter</span></span>
<span id="cb729-2"><a href="manipulating-dplyr.html#cb729-2" tabindex="-1"></a>filtered <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb729-3"><a href="manipulating-dplyr.html#cb729-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dest <span class="sc">%in%</span> top_dest<span class="sc">$</span>dest)</span></code></pre></div>
<ul>
<li>Using semi join: only keep (INCLUDE) the rows that were matched between the two tables</li>
</ul>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="manipulating-dplyr.html#cb730-1" tabindex="-1"></a>joined <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb730-2"><a href="manipulating-dplyr.html#cb730-2" tabindex="-1"></a>  <span class="fu">semi_join</span>(top_dest)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(dest)`</code></pre>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="manipulating-dplyr.html#cb732-1" tabindex="-1"></a><span class="fu">head</span>(filtered <span class="sc">==</span> joined)</span></code></pre></div>
<pre><code>##      year month  day dep_time sched_dep_time dep_delay arr_time sched_arr_time
## [1,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
## [2,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
## [3,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
## [4,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
## [5,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
## [6,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
##      arr_delay carrier flight tailnum origin dest air_time distance hour minute
## [1,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
## [2,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
## [3,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
## [4,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
## [5,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
## [6,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
##      time_hour
## [1,]      TRUE
## [2,]      TRUE
## [3,]      TRUE
## [4,]      TRUE
## [5,]      TRUE
## [6,]      TRUE</code></pre>
<ul>
<li>Anti Join</li>
</ul>
<p><code>anti_join()</code> does the opposite. Exclude the rows that were matched between the two tables. A great technique to filter stopwords when you do computational text analysis.</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="manipulating-dplyr.html#cb734-1" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb734-2"><a href="manipulating-dplyr.html#cb734-2" tabindex="-1"></a>  <span class="fu">anti_join</span>(planes, <span class="at">by =</span> <span class="st">&quot;tailnum&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb734-3"><a href="manipulating-dplyr.html#cb734-3" tabindex="-1"></a>  <span class="fu">count</span>(tailnum, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 722 × 2
##    tailnum     n
##    &lt;chr&gt;   &lt;int&gt;
##  1 &lt;NA&gt;     2512
##  2 N725MQ    575
##  3 N722MQ    513
##  4 N723MQ    507
##  5 N713MQ    483
##  6 N735MQ    396
##  7 N0EGMQ    371
##  8 N534MQ    364
##  9 N542MQ    363
## 10 N531MQ    349
## # ℹ 712 more rows</code></pre>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tidying-tidyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-broom.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/jaeyk/PS239T/edit/main/03_tidy_data.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": [
    ["pdf", "PS239T.pdf"],
    ["epub", "PS239T.epub"]
  ],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  },
  "toolbar": {
    "position": "fixed"
  },
  "code_copy": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
