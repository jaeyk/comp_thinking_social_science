<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Tidy data and its friends | Computational Thinking for Social Scientists</title>
  <meta name="description" content="Chapter 4 Tidy data and its friends | Computational Thinking for Social Scientists. Online textbook for Teaching Computational Tools and Techniques for Social Scientists." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Tidy data and its friends | Computational Thinking for Social Scientists" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 4 Tidy data and its friends | Computational Thinking for Social Scientists. Online textbook for Teaching Computational Tools and Techniques for Social Scientists." />
  <meta name="github-repo" content="jaeyk/PS239T" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Tidy data and its friends | Computational Thinking for Social Scientists" />
  <meta name="twitter:site" content="@JaeJaeykim2" />
  <meta name="twitter:description" content="Chapter 4 Tidy data and its friends | Computational Thinking for Social Scientists. Online textbook for Teaching Computational Tools and Techniques for Social Scientists." />
  

<meta name="author" content="Jae Yeon Kim" />


<meta name="date" content="2023-03-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="git_bash.html"/>
<link rel="next" href="functional_programming.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Computational Thinking for Social Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Hello World</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#part-i-fundamentals"><i class="fa fa-check"></i><b>1.1</b> Part I Fundamentals</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#part-ii-applications"><i class="fa fa-check"></i><b>1.2</b> Part II Applications</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#special-thanks"><i class="fa fa-check"></i><b>1.3</b> Special thanks</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#suggestions-questions-or-comments"><i class="fa fa-check"></i><b>1.4</b> Suggestions, questions, or comments</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.5</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Computational thinking</a>
<ul>
<li class="chapter" data-level="2.1" data-path="motivation.html"><a href="motivation.html#why-computational-thinking"><i class="fa fa-check"></i><b>2.1</b> Why computational thinking</a></li>
<li class="chapter" data-level="2.2" data-path="motivation.html"><a href="motivation.html#how-to-teach-and-learn-computational-thinking"><i class="fa fa-check"></i><b>2.2</b> How to teach and learn computational thinking</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="git_bash.html"><a href="git_bash.html"><i class="fa fa-check"></i><b>3</b> Managing data and code</a>
<ul>
<li class="chapter" data-level="3.1" data-path="git_bash.html"><a href="git_bash.html#the-command-line"><i class="fa fa-check"></i><b>3.1</b> The Command Line</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="git_bash.html"><a href="git_bash.html#the-big-picture"><i class="fa fa-check"></i><b>3.1.1</b> The Big Picture</a></li>
<li class="chapter" data-level="3.1.2" data-path="git_bash.html"><a href="git_bash.html#why-bother-using-the-command-line"><i class="fa fa-check"></i><b>3.1.2</b> Why bother using the command line?</a></li>
<li class="chapter" data-level="3.1.3" data-path="git_bash.html"><a href="git_bash.html#unix-shell"><i class="fa fa-check"></i><b>3.1.3</b> UNIX Shell</a></li>
<li class="chapter" data-level="3.1.4" data-path="git_bash.html"><a href="git_bash.html#references"><i class="fa fa-check"></i><b>3.1.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="git_bash.html"><a href="git_bash.html#git-and-github"><i class="fa fa-check"></i><b>3.2</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="git_bash.html"><a href="git_bash.html#the-big-picture-1"><i class="fa fa-check"></i><b>3.2.1</b> The Big Picture</a></li>
<li class="chapter" data-level="3.2.2" data-path="git_bash.html"><a href="git_bash.html#version-control-system"><i class="fa fa-check"></i><b>3.2.2</b> Version control system</a></li>
<li class="chapter" data-level="3.2.3" data-path="git_bash.html"><a href="git_bash.html#setup"><i class="fa fa-check"></i><b>3.2.3</b> Setup</a></li>
<li class="chapter" data-level="3.2.4" data-path="git_bash.html"><a href="git_bash.html#cloning-a-repository"><i class="fa fa-check"></i><b>3.2.4</b> Cloning a repository</a></li>
<li class="chapter" data-level="3.2.5" data-path="git_bash.html"><a href="git_bash.html#making-a-repository"><i class="fa fa-check"></i><b>3.2.5</b> Making a repository</a></li>
<li class="chapter" data-level="3.2.6" data-path="git_bash.html"><a href="git_bash.html#commit-changes"><i class="fa fa-check"></i><b>3.2.6</b> Commit changes</a></li>
<li class="chapter" data-level="3.2.7" data-path="git_bash.html"><a href="git_bash.html#push-and-pull-or-fetch"><i class="fa fa-check"></i><b>3.2.7</b> Push and pull (or fetch)</a></li>
<li class="chapter" data-level="3.2.8" data-path="git_bash.html"><a href="git_bash.html#branching"><i class="fa fa-check"></i><b>3.2.8</b> Branching</a></li>
<li class="chapter" data-level="3.2.9" data-path="git_bash.html"><a href="git_bash.html#other-useful-commands"><i class="fa fa-check"></i><b>3.2.9</b> Other useful commands</a></li>
<li class="chapter" data-level="3.2.10" data-path="git_bash.html"><a href="git_bash.html#collaborations"><i class="fa fa-check"></i><b>3.2.10</b> Collaborations</a></li>
<li class="chapter" data-level="3.2.11" data-path="git_bash.html"><a href="git_bash.html#deployment-github-pages"><i class="fa fa-check"></i><b>3.2.11</b> Deployment: GitHub Pages</a></li>
<li class="chapter" data-level="3.2.12" data-path="git_bash.html"><a href="git_bash.html#tracking-progress-github-issues"><i class="fa fa-check"></i><b>3.2.12</b> Tracking progress: GitHub Issues</a></li>
<li class="chapter" data-level="3.2.13" data-path="git_bash.html"><a href="git_bash.html#project-management-github-dashboards"><i class="fa fa-check"></i><b>3.2.13</b> Project management: GitHub Dashboards</a></li>
<li class="chapter" data-level="3.2.14" data-path="git_bash.html"><a href="git_bash.html#using-git-clients"><i class="fa fa-check"></i><b>3.2.14</b> Using Git clients</a></li>
<li class="chapter" data-level="3.2.15" data-path="git_bash.html"><a href="git_bash.html#the-big-picture-2"><i class="fa fa-check"></i><b>3.2.15</b> The Big Picture</a></li>
<li class="chapter" data-level="3.2.16" data-path="git_bash.html"><a href="git_bash.html#rstudio"><i class="fa fa-check"></i><b>3.2.16</b> RStudio</a></li>
<li class="chapter" data-level="3.2.17" data-path="git_bash.html"><a href="git_bash.html#basic-syntax"><i class="fa fa-check"></i><b>3.2.17</b> Basic Syntax</a></li>
<li class="chapter" data-level="3.2.18" data-path="git_bash.html"><a href="git_bash.html#environment"><i class="fa fa-check"></i><b>3.2.18</b> Environment</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="git_bash.html"><a href="git_bash.html#project-oriented-research"><i class="fa fa-check"></i><b>3.3</b> Project-oriented research</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="git_bash.html"><a href="git_bash.html#the-big-picture-3"><i class="fa fa-check"></i><b>3.3.1</b> The Big Picture</a></li>
<li class="chapter" data-level="3.3.2" data-path="git_bash.html"><a href="git_bash.html#references-1"><i class="fa fa-check"></i><b>3.3.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="git_bash.html"><a href="git_bash.html#writing-code-how-to-code-like-a-professional"><i class="fa fa-check"></i><b>3.4</b> Writing code: How to code like a professional</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="git_bash.html"><a href="git_bash.html#the-bic-piture"><i class="fa fa-check"></i><b>3.4.1</b> The Bic Piture</a></li>
<li class="chapter" data-level="3.4.2" data-path="git_bash.html"><a href="git_bash.html#write-readable-code"><i class="fa fa-check"></i><b>3.4.2</b> Write readable code</a></li>
<li class="chapter" data-level="3.4.3" data-path="git_bash.html"><a href="git_bash.html#write-reusable-code"><i class="fa fa-check"></i><b>3.4.3</b> Write reusable code</a></li>
<li class="chapter" data-level="3.4.4" data-path="git_bash.html"><a href="git_bash.html#test-your-code-systematically"><i class="fa fa-check"></i><b>3.4.4</b> Test your code systematically</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="git_bash.html"><a href="git_bash.html#run-tests"><i class="fa fa-check"></i><b>3.5</b> Run tests</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="git_bash.html"><a href="git_bash.html#asking-questions-minimal-reproducible-example"><i class="fa fa-check"></i><b>3.5.1</b> Asking questions: Minimal reproducible example</a></li>
<li class="chapter" data-level="3.5.2" data-path="git_bash.html"><a href="git_bash.html#references-2"><i class="fa fa-check"></i><b>3.5.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidy_data.html"><a href="tidy_data.html"><i class="fa fa-check"></i><b>4</b> Tidy data and its friends</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidy_data.html"><a href="tidy_data.html#setup-2"><i class="fa fa-check"></i><b>4.1</b> Setup</a></li>
<li class="chapter" data-level="4.2" data-path="tidy_data.html"><a href="tidy_data.html#base-r-data-structure"><i class="fa fa-check"></i><b>4.2</b> Base R data structure</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="tidy_data.html"><a href="tidy_data.html#d-data-vectors"><i class="fa fa-check"></i><b>4.2.1</b> 1D data: Vectors</a></li>
<li class="chapter" data-level="4.2.2" data-path="tidy_data.html"><a href="tidy_data.html#data-structures"><i class="fa fa-check"></i><b>4.2.2</b> Data structures</a></li>
<li class="chapter" data-level="4.2.3" data-path="tidy_data.html"><a href="tidy_data.html#attributes"><i class="fa fa-check"></i><b>4.2.3</b> Attributes</a></li>
<li class="chapter" data-level="4.2.4" data-path="tidy_data.html"><a href="tidy_data.html#d-data-matrices-and-dataframes"><i class="fa fa-check"></i><b>4.2.4</b> 2D data: Matrices and dataframes</a></li>
<li class="chapter" data-level="4.2.5" data-path="tidy_data.html"><a href="tidy_data.html#subset"><i class="fa fa-check"></i><b>4.2.5</b> Subset</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tidy_data.html"><a href="tidy_data.html#tidyverse"><i class="fa fa-check"></i><b>4.3</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="tidy_data.html"><a href="tidy_data.html#the-big-picture-4"><i class="fa fa-check"></i><b>4.3.1</b> The Big Picture</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tidy_data.html"><a href="tidy_data.html#tidying-tidyr"><i class="fa fa-check"></i><b>4.4</b> Tidying (tidyr)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="tidy_data.html"><a href="tidy_data.html#reshaping"><i class="fa fa-check"></i><b>4.4.1</b> Reshaping</a></li>
<li class="chapter" data-level="4.4.2" data-path="tidy_data.html"><a href="tidy_data.html#filling"><i class="fa fa-check"></i><b>4.4.2</b> Filling</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="tidy_data.html"><a href="tidy_data.html#manipulating-dplyr"><i class="fa fa-check"></i><b>4.5</b> Manipulating (dplyr)</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="tidy_data.html"><a href="tidy_data.html#rearranging"><i class="fa fa-check"></i><b>4.5.1</b> Rearranging</a></li>
<li class="chapter" data-level="4.5.2" data-path="tidy_data.html"><a href="tidy_data.html#subset-observations-rows"><i class="fa fa-check"></i><b>4.5.2</b> Subset observations (rows)</a></li>
<li class="chapter" data-level="4.5.3" data-path="tidy_data.html"><a href="tidy_data.html#subset-variables-columns"><i class="fa fa-check"></i><b>4.5.3</b> Subset variables (columns)</a></li>
<li class="chapter" data-level="4.5.4" data-path="tidy_data.html"><a href="tidy_data.html#create-variables"><i class="fa fa-check"></i><b>4.5.4</b> Create variables</a></li>
<li class="chapter" data-level="4.5.5" data-path="tidy_data.html"><a href="tidy_data.html#counting"><i class="fa fa-check"></i><b>4.5.5</b> Counting</a></li>
<li class="chapter" data-level="4.5.6" data-path="tidy_data.html"><a href="tidy_data.html#summarizing"><i class="fa fa-check"></i><b>4.5.6</b> Summarizing</a></li>
<li class="chapter" data-level="4.5.7" data-path="tidy_data.html"><a href="tidy_data.html#grouping"><i class="fa fa-check"></i><b>4.5.7</b> Grouping</a></li>
<li class="chapter" data-level="4.5.8" data-path="tidy_data.html"><a href="tidy_data.html#joining"><i class="fa fa-check"></i><b>4.5.8</b> Joining</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tidy_data.html"><a href="tidy_data.html#modeling-broom"><i class="fa fa-check"></i><b>4.6</b> Modeling (broom)</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="tidy_data.html"><a href="tidy_data.html#nesting"><i class="fa fa-check"></i><b>4.6.1</b> Nesting</a></li>
<li class="chapter" data-level="4.6.2" data-path="tidy_data.html"><a href="tidy_data.html#mapping"><i class="fa fa-check"></i><b>4.6.2</b> Mapping</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="tidy_data.html"><a href="tidy_data.html#visualizing-ggplot2"><i class="fa fa-check"></i><b>4.7</b> Visualizing (ggplot2)</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="tidy_data.html"><a href="tidy_data.html#motivation-2"><i class="fa fa-check"></i><b>4.7.1</b> Motivation</a></li>
<li class="chapter" data-level="4.7.2" data-path="tidy_data.html"><a href="tidy_data.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>4.7.2</b> The grammar of graphics</a></li>
<li class="chapter" data-level="4.7.3" data-path="tidy_data.html"><a href="tidy_data.html#mapping-and-geom"><i class="fa fa-check"></i><b>4.7.3</b> mapping and geom</a></li>
<li class="chapter" data-level="4.7.4" data-path="tidy_data.html"><a href="tidy_data.html#basic-aes-x-y"><i class="fa fa-check"></i><b>4.7.4</b> basic aes (x , y)</a></li>
<li class="chapter" data-level="4.7.5" data-path="tidy_data.html"><a href="tidy_data.html#univariate-distribution"><i class="fa fa-check"></i><b>4.7.5</b> Univariate distribution</a></li>
<li class="chapter" data-level="4.7.6" data-path="tidy_data.html"><a href="tidy_data.html#advanced-aes-size-color"><i class="fa fa-check"></i><b>4.7.6</b> Advanced aes (size, color)</a></li>
<li class="chapter" data-level="4.7.7" data-path="tidy_data.html"><a href="tidy_data.html#co-ordinates-and-scales"><i class="fa fa-check"></i><b>4.7.7</b> Co-ordinates and scales</a></li>
<li class="chapter" data-level="4.7.8" data-path="tidy_data.html"><a href="tidy_data.html#labels-and-guides"><i class="fa fa-check"></i><b>4.7.8</b> Labels and guides</a></li>
<li class="chapter" data-level="4.7.9" data-path="tidy_data.html"><a href="tidy_data.html#ggsave"><i class="fa fa-check"></i><b>4.7.9</b> ggsave</a></li>
<li class="chapter" data-level="4.7.10" data-path="tidy_data.html"><a href="tidy_data.html#many-plots"><i class="fa fa-check"></i><b>4.7.10</b> Many plots</a></li>
<li class="chapter" data-level="4.7.11" data-path="tidy_data.html"><a href="tidy_data.html#transforming"><i class="fa fa-check"></i><b>4.7.11</b> Transforming</a></li>
<li class="chapter" data-level="4.7.12" data-path="tidy_data.html"><a href="tidy_data.html#ploting-models"><i class="fa fa-check"></i><b>4.7.12</b> Ploting models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functional_programming.html"><a href="functional_programming.html"><i class="fa fa-check"></i><b>5</b> Automating repeated things</a>
<ul>
<li class="chapter" data-level="5.1" data-path="functional_programming.html"><a href="functional_programming.html#the-big-picture-5"><i class="fa fa-check"></i><b>5.1</b> The Big Picture</a></li>
<li class="chapter" data-level="5.2" data-path="functional_programming.html"><a href="functional_programming.html#objectives"><i class="fa fa-check"></i><b>5.2</b> Objectives</a></li>
<li class="chapter" data-level="5.3" data-path="functional_programming.html"><a href="functional_programming.html#setup-3"><i class="fa fa-check"></i><b>5.3</b> Setup</a></li>
<li class="chapter" data-level="5.4" data-path="functional_programming.html"><a href="functional_programming.html#flow"><i class="fa fa-check"></i><b>5.4</b> Flow control</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="functional_programming.html"><a href="functional_programming.html#if-one-condition"><i class="fa fa-check"></i><b>5.4.1</b> if (one condition)</a></li>
<li class="chapter" data-level="5.4.2" data-path="functional_programming.html"><a href="functional_programming.html#if-else-two-conditions"><i class="fa fa-check"></i><b>5.4.2</b> if + else (two conditions)</a></li>
<li class="chapter" data-level="5.4.3" data-path="functional_programming.html"><a href="functional_programming.html#if-else-if-else-three-conditions"><i class="fa fa-check"></i><b>5.4.3</b> if + else if + else (three conditions)</a></li>
<li class="chapter" data-level="5.4.4" data-path="functional_programming.html"><a href="functional_programming.html#functions"><i class="fa fa-check"></i><b>5.4.4</b> Functions</a></li>
<li class="chapter" data-level="5.4.5" data-path="functional_programming.html"><a href="functional_programming.html#for-loop"><i class="fa fa-check"></i><b>5.4.5</b> for loop</a></li>
<li class="chapter" data-level="5.4.6" data-path="functional_programming.html"><a href="functional_programming.html#apply-family"><i class="fa fa-check"></i><b>5.4.6</b> apply family</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="functional_programming.html"><a href="functional_programming.html#purrr"><i class="fa fa-check"></i><b>5.5</b> purrr</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="functional_programming.html"><a href="functional_programming.html#why-map"><i class="fa fa-check"></i><b>5.5.1</b> Why map?</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="functional_programming.html"><a href="functional_programming.html#map2"><i class="fa fa-check"></i><b>5.6</b> Automate 2 or 2+ tasks</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="functional_programming.html"><a href="functional_programming.html#objectives-2"><i class="fa fa-check"></i><b>5.6.1</b> Objectives</a></li>
<li class="chapter" data-level="5.6.2" data-path="functional_programming.html"><a href="functional_programming.html#problem"><i class="fa fa-check"></i><b>5.6.2</b> Problem</a></li>
<li class="chapter" data-level="5.6.3" data-path="functional_programming.html"><a href="functional_programming.html#for-loop-1"><i class="fa fa-check"></i><b>5.6.3</b> For loop</a></li>
<li class="chapter" data-level="5.6.4" data-path="functional_programming.html"><a href="functional_programming.html#map2-pmap"><i class="fa fa-check"></i><b>5.6.4</b> map2 &amp; pmap</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="functional_programming.html"><a href="functional_programming.html#glue"><i class="fa fa-check"></i><b>5.7</b> Automate plotting</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="functional_programming.html"><a href="functional_programming.html#objective"><i class="fa fa-check"></i><b>5.7.1</b> Objective</a></li>
<li class="chapter" data-level="5.7.2" data-path="functional_programming.html"><a href="functional_programming.html#problem-1"><i class="fa fa-check"></i><b>5.7.2</b> Problem</a></li>
<li class="chapter" data-level="5.7.3" data-path="functional_programming.html"><a href="functional_programming.html#solution"><i class="fa fa-check"></i><b>5.7.3</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="functional_programming.html"><a href="functional_programming.html#reduce"><i class="fa fa-check"></i><b>5.8</b> Automate joining</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="functional_programming.html"><a href="functional_programming.html#objective-1"><i class="fa fa-check"></i><b>5.8.1</b> Objective</a></li>
<li class="chapter" data-level="5.8.2" data-path="functional_programming.html"><a href="functional_programming.html#problem-2"><i class="fa fa-check"></i><b>5.8.2</b> Problem</a></li>
<li class="chapter" data-level="5.8.3" data-path="functional_programming.html"><a href="functional_programming.html#copy-and-paste"><i class="fa fa-check"></i><b>5.8.3</b> Copy and paste</a></li>
<li class="chapter" data-level="5.8.4" data-path="functional_programming.html"><a href="functional_programming.html#reduce-1"><i class="fa fa-check"></i><b>5.8.4</b> reduce</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="functional_programming.html"><a href="functional_programming.html#speed"><i class="fa fa-check"></i><b>5.9</b> Make automation slower or faster</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="functional_programming.html"><a href="functional_programming.html#objectives-3"><i class="fa fa-check"></i><b>5.9.1</b> Objectives</a></li>
<li class="chapter" data-level="5.9.2" data-path="functional_programming.html"><a href="functional_programming.html#how-to-make-automation-slower"><i class="fa fa-check"></i><b>5.9.2</b> How to Make Automation Slower</a></li>
<li class="chapter" data-level="5.9.3" data-path="functional_programming.html"><a href="functional_programming.html#how-to-make-automation-faster"><i class="fa fa-check"></i><b>5.9.3</b> How to Make Automation Faster</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="functional_programming.html"><a href="functional_programming.html#robustness"><i class="fa fa-check"></i><b>5.10</b> Make error handling easier</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="functional_programming.html"><a href="functional_programming.html#learning-objective"><i class="fa fa-check"></i><b>5.10.1</b> Learning objective</a></li>
<li class="chapter" data-level="5.10.2" data-path="functional_programming.html"><a href="functional_programming.html#solution-1"><i class="fa fa-check"></i><b>5.10.2</b> Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="products.html"><a href="products.html"><i class="fa fa-check"></i><b>6</b> Developing data products</a>
<ul>
<li class="chapter" data-level="6.1" data-path="products.html"><a href="products.html#developing-r-packages"><i class="fa fa-check"></i><b>6.1</b> Developing R packages</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="products.html"><a href="products.html#the-big-picture-6"><i class="fa fa-check"></i><b>6.1.1</b> The Big Picture</a></li>
<li class="chapter" data-level="6.1.2" data-path="products.html"><a href="products.html#workflow"><i class="fa fa-check"></i><b>6.1.2</b> Workflow</a></li>
<li class="chapter" data-level="6.1.3" data-path="products.html"><a href="products.html#required-components"><i class="fa fa-check"></i><b>6.1.3</b> Required Components</a></li>
<li class="chapter" data-level="6.1.4" data-path="products.html"><a href="products.html#optional-components"><i class="fa fa-check"></i><b>6.1.4</b> Optional Components</a></li>
<li class="chapter" data-level="6.1.5" data-path="products.html"><a href="products.html#building-an-r-package"><i class="fa fa-check"></i><b>6.1.5</b> Building an R package</a></li>
<li class="chapter" data-level="6.1.6" data-path="products.html"><a href="products.html#distributing-an-r-package"><i class="fa fa-check"></i><b>6.1.6</b> Distributing an R package</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="products.html"><a href="products.html#developing-shiny-apps"><i class="fa fa-check"></i><b>6.2</b> Developing Shiny apps</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="products.html"><a href="products.html#workflow-1"><i class="fa fa-check"></i><b>6.2.1</b> Workflow</a></li>
<li class="chapter" data-level="6.2.2" data-path="products.html"><a href="products.html#app.r"><i class="fa fa-check"></i><b>6.2.2</b> app.r</a></li>
<li class="chapter" data-level="6.2.3" data-path="products.html"><a href="products.html#deployment"><i class="fa fa-check"></i><b>6.2.3</b> Deployment</a></li>
<li class="chapter" data-level="6.2.4" data-path="products.html"><a href="products.html#references-3"><i class="fa fa-check"></i><b>6.2.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="products.html"><a href="products.html#other-useful-data-products"><i class="fa fa-check"></i><b>6.3</b> Other useful data products</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="semi_structured_data.html"><a href="semi_structured_data.html"><i class="fa fa-check"></i><b>7</b> Semi-structured data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="semi_structured_data.html"><a href="semi_structured_data.html#setup-4"><i class="fa fa-check"></i><b>7.1</b> Setup</a></li>
<li class="chapter" data-level="7.2" data-path="semi_structured_data.html"><a href="semi_structured_data.html#the-big-picture-7"><i class="fa fa-check"></i><b>7.2</b> The Big Picture</a></li>
<li class="chapter" data-level="7.3" data-path="semi_structured_data.html"><a href="semi_structured_data.html#what-is-semi-structured-data"><i class="fa fa-check"></i><b>7.3</b> What is semi-structured data?</a></li>
<li class="chapter" data-level="7.4" data-path="semi_structured_data.html"><a href="semi_structured_data.html#workflow-2"><i class="fa fa-check"></i><b>7.4</b> Workflow</a></li>
<li class="chapter" data-level="7.5" data-path="semi_structured_data.html"><a href="semi_structured_data.html#htmlcss-web-scraping"><i class="fa fa-check"></i><b>7.5</b> HTML/CSS: web scraping</a></li>
<li class="chapter" data-level="7.6" data-path="semi_structured_data.html"><a href="semi_structured_data.html#xmljson-government-databasesocial-media-scraping"><i class="fa fa-check"></i><b>7.6</b> XML/JSON: government database/social media scraping</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="semi_structured_data.html"><a href="semi_structured_data.html#governemnt-database-xml"><i class="fa fa-check"></i><b>7.6.1</b> Governemnt database (XML)</a></li>
<li class="chapter" data-level="7.6.2" data-path="semi_structured_data.html"><a href="semi_structured_data.html#social-media-api-json"><i class="fa fa-check"></i><b>7.6.2</b> Social media API (JSON)</a></li>
<li class="chapter" data-level="7.6.3" data-path="semi_structured_data.html"><a href="semi_structured_data.html#next-steps"><i class="fa fa-check"></i><b>7.6.3</b> Next steps</a></li>
<li class="chapter" data-level="7.6.4" data-path="semi_structured_data.html"><a href="semi_structured_data.html#rtweet"><i class="fa fa-check"></i><b>7.6.4</b> rtweet</a></li>
<li class="chapter" data-level="7.6.5" data-path="semi_structured_data.html"><a href="semi_structured_data.html#hydrating"><i class="fa fa-check"></i><b>7.6.5</b> Hydrating</a></li>
<li class="chapter" data-level="7.6.6" data-path="semi_structured_data.html"><a href="semi_structured_data.html#parsing-json"><i class="fa fa-check"></i><b>7.6.6</b> Parsing JSON</a></li>
<li class="chapter" data-level="7.6.7" data-path="semi_structured_data.html"><a href="semi_structured_data.html#getting-api-data-from-scratch"><i class="fa fa-check"></i><b>7.6.7</b> Getting API data from scratch</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="machine_learning.html"><a href="machine_learning.html"><i class="fa fa-check"></i><b>8</b> High-dimensional data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="machine_learning.html"><a href="machine_learning.html#the-big-picture-8"><i class="fa fa-check"></i><b>8.1</b> The Big Picture</a></li>
<li class="chapter" data-level="8.2" data-path="machine_learning.html"><a href="machine_learning.html#dataset"><i class="fa fa-check"></i><b>8.2</b> Dataset</a></li>
<li class="chapter" data-level="8.3" data-path="machine_learning.html"><a href="machine_learning.html#workflow-3"><i class="fa fa-check"></i><b>8.3</b> Workflow</a></li>
<li class="chapter" data-level="8.4" data-path="machine_learning.html"><a href="machine_learning.html#tidymodels"><i class="fa fa-check"></i><b>8.4</b> tidymodels</a></li>
<li class="chapter" data-level="8.5" data-path="machine_learning.html"><a href="machine_learning.html#pre-processing"><i class="fa fa-check"></i><b>8.5</b> Pre-processing</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="machine_learning.html"><a href="machine_learning.html#regression-setup"><i class="fa fa-check"></i><b>8.5.1</b> Regression setup</a></li>
<li class="chapter" data-level="8.5.2" data-path="machine_learning.html"><a href="machine_learning.html#classification-setup"><i class="fa fa-check"></i><b>8.5.2</b> Classification setup</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="machine_learning.html"><a href="machine_learning.html#supervised-learning"><i class="fa fa-check"></i><b>8.6</b> Supervised learning</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="machine_learning.html"><a href="machine_learning.html#ols-and-lasso"><i class="fa fa-check"></i><b>8.6.1</b> OLS and Lasso</a></li>
<li class="chapter" data-level="8.6.2" data-path="machine_learning.html"><a href="machine_learning.html#decision-tree"><i class="fa fa-check"></i><b>8.6.2</b> Decision tree</a></li>
<li class="chapter" data-level="8.6.3" data-path="machine_learning.html"><a href="machine_learning.html#bagging-random-forest"><i class="fa fa-check"></i><b>8.6.3</b> Bagging (Random forest)</a></li>
<li class="chapter" data-level="8.6.4" data-path="machine_learning.html"><a href="machine_learning.html#boosting-xgboost"><i class="fa fa-check"></i><b>8.6.4</b> Boosting (XGboost)</a></li>
<li class="chapter" data-level="8.6.5" data-path="machine_learning.html"><a href="machine_learning.html#stacking-superlearner"><i class="fa fa-check"></i><b>8.6.5</b> Stacking (SuperLearner)</a></li>
<li class="chapter" data-level="8.6.6" data-path="machine_learning.html"><a href="machine_learning.html#applications-2"><i class="fa fa-check"></i><b>8.6.6</b> Applications</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="machine_learning.html"><a href="machine_learning.html#unsupervised-learning"><i class="fa fa-check"></i><b>8.7</b> Unsupervised learning</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="machine_learning.html"><a href="machine_learning.html#dimension-reduction"><i class="fa fa-check"></i><b>8.7.1</b> Dimension reduction</a></li>
<li class="chapter" data-level="8.7.2" data-path="machine_learning.html"><a href="machine_learning.html#topic-modeling"><i class="fa fa-check"></i><b>8.7.2</b> Topic modeling</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="machine_learning.html"><a href="machine_learning.html#references-4"><i class="fa fa-check"></i><b>8.8</b> References</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="machine_learning.html"><a href="machine_learning.html#books"><i class="fa fa-check"></i><b>8.8.1</b> Books</a></li>
<li class="chapter" data-level="8.8.2" data-path="machine_learning.html"><a href="machine_learning.html#lecture-slides"><i class="fa fa-check"></i><b>8.8.2</b> Lecture slides</a></li>
<li class="chapter" data-level="8.8.3" data-path="machine_learning.html"><a href="machine_learning.html#blog-posts"><i class="fa fa-check"></i><b>8.8.3</b> Blog posts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="big_data.html"><a href="big_data.html"><i class="fa fa-check"></i><b>9</b> Big data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="big_data.html"><a href="big_data.html#the-big-picture-9"><i class="fa fa-check"></i><b>9.1</b> The Big Picture</a></li>
<li class="chapter" data-level="9.2" data-path="big_data.html"><a href="big_data.html#sql"><i class="fa fa-check"></i><b>9.2</b> SQL</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="big_data.html"><a href="big_data.html#learning-objectives"><i class="fa fa-check"></i><b>9.2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="9.2.2" data-path="big_data.html"><a href="big_data.html#sql-and-r"><i class="fa fa-check"></i><b>9.2.2</b> SQL and R</a></li>
<li class="chapter" data-level="9.2.3" data-path="big_data.html"><a href="big_data.html#setup-7"><i class="fa fa-check"></i><b>9.2.3</b> Setup</a></li>
<li class="chapter" data-level="9.2.4" data-path="big_data.html"><a href="big_data.html#packages-1"><i class="fa fa-check"></i><b>9.2.4</b> Packages</a></li>
<li class="chapter" data-level="9.2.5" data-path="big_data.html"><a href="big_data.html#nyc-flights-data"><i class="fa fa-check"></i><b>9.2.5</b> NYC flights data</a></li>
<li class="chapter" data-level="9.2.6" data-path="big_data.html"><a href="big_data.html#workflow-4"><i class="fa fa-check"></i><b>9.2.6</b> Workflow</a></li>
<li class="chapter" data-level="9.2.7" data-path="big_data.html"><a href="big_data.html#things-we-didnt-cover"><i class="fa fa-check"></i><b>9.2.7</b> Things we didn’t cover</a></li>
<li class="chapter" data-level="9.2.8" data-path="big_data.html"><a href="big_data.html#references-5"><i class="fa fa-check"></i><b>9.2.8</b> References</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/jaeyk/PS239T/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Thinking for Social Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidy_data" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Tidy data and its friends<a href="tidy_data.html#tidy_data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="setup-2" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Setup<a href="tidy_data.html#setup-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Check your <code>dplyr</code> package is up-to-date by typing <code>packageVersion("dplyr")</code>. If the current installed version is less than 1.0, then update by typing <code>update.packages("dplyr")</code>. You may need to restart R to make it work.</li>
</ul>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="tidy_data.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">packageVersion</span>(<span class="st">&quot;dplyr&quot;</span>) <span class="sc">&gt;=</span> <span class="dv">1</span>,</span>
<span id="cb131-2"><a href="tidy_data.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;The installed version of dplyr package is greater than or equal to 1.0.0&quot;</span>, <span class="fu">update.packages</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb131-3"><a href="tidy_data.html#cb131-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] &quot;The installed version of dplyr package is greater than or equal to 1.0.0&quot;</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="tidy_data.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;pacman&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;pacman&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: pacman</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="tidy_data.html#cb135-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb135-2"><a href="tidy_data.html#cb135-2" aria-hidden="true" tabindex="-1"></a>  tidyverse, <span class="co"># the tidyverse framework</span></span>
<span id="cb135-3"><a href="tidy_data.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  skimr, <span class="co"># skimming data</span></span>
<span id="cb135-4"><a href="tidy_data.html#cb135-4" aria-hidden="true" tabindex="-1"></a>  here, <span class="co"># computational reproducibility</span></span>
<span id="cb135-5"><a href="tidy_data.html#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#infer, # statistical inference</span></span>
<span id="cb135-6"><a href="tidy_data.html#cb135-6" aria-hidden="true" tabindex="-1"></a>  tidymodels, <span class="co"># statistical modeling</span></span>
<span id="cb135-7"><a href="tidy_data.html#cb135-7" aria-hidden="true" tabindex="-1"></a>  gapminder, <span class="co"># toy data</span></span>
<span id="cb135-8"><a href="tidy_data.html#cb135-8" aria-hidden="true" tabindex="-1"></a>  nycflights13, <span class="co"># for exercise</span></span>
<span id="cb135-9"><a href="tidy_data.html#cb135-9" aria-hidden="true" tabindex="-1"></a>  ggthemes, <span class="co"># additional themes</span></span>
<span id="cb135-10"><a href="tidy_data.html#cb135-10" aria-hidden="true" tabindex="-1"></a>  ggrepel, <span class="co"># arranging ggplots</span></span>
<span id="cb135-11"><a href="tidy_data.html#cb135-11" aria-hidden="true" tabindex="-1"></a>  patchwork, <span class="co"># arranging ggplots</span></span>
<span id="cb135-12"><a href="tidy_data.html#cb135-12" aria-hidden="true" tabindex="-1"></a>  broom, <span class="co"># tidying model outputs</span></span>
<span id="cb135-13"><a href="tidy_data.html#cb135-13" aria-hidden="true" tabindex="-1"></a>  waldo <span class="co"># side-by-side code comparison</span></span>
<span id="cb135-14"><a href="tidy_data.html#cb135-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="base-r-data-structure" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Base R data structure<a href="tidy_data.html#base-r-data-structure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The rest of the chapter follows the basic structure in <a href="https://rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">the Data Wrangling Cheat Sheet</a> created by RStudio.</p>
<p>To make the best use of the R language, you’ll need a strong understanding of the basic data types and data structures and how to operate on those. R is an <strong>object-oriented</strong> language, so the importance of this cannot be understated.</p>
<p>It is <strong>critical</strong> to understand because these are the objects you will manipulate on a day-to-day basis in R, and they are not always as easy to work with as they sound at the outset. Dealing with object conversions is one of the most common sources of frustration for beginners.</p>
<blockquote>
<p>To understand computations in R, two slogans are helpful:
- Everything that exists is an object.
- Everything that happens is a function call.</p>
</blockquote>
<blockquote>
<p>__John Chambers__the creator of S (the mother of R)</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><p><a href="#main-classes">Main Classes</a> introduces you to R’s one-dimensional or atomic classes and data structures. R has five basic atomic classes: logical, integer, numeric, complex, character. Social scientists don’t use complex classes.</p></li>
<li><p><a href="tidy_data.html#attributes">Attributes</a> takes a small detour to discuss attributes, R’s flexible metadata specification. Here, you’ll learn about factors, an important data structure created by setting attributes of an atomic vector. R has many data structures: vector, list, matrix, data frame, factors, tables.</p></li>
</ol>
<div class="figure">
<img src="https://github.com/rstudio/concept-maps/raw/master/en/data-types.svg" alt="" />
<p class="caption">Concept map for data types. By Meghan Sposato, Brendan Cullen, Monica Alonso.</p>
</div>
<div id="d-data-vectors" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> 1D data: Vectors<a href="tidy_data.html#d-data-vectors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="atomic-classes" class="section level4 hasAnchor" number="4.2.1.1">
<h4><span class="header-section-number">4.2.1.1</span> Atomic classes<a href="tidy_data.html#atomic-classes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>R</code>’s main atomic classes are:</p>
<ul>
<li>character (or a “string” in Python and Stata)</li>
<li>numeric (integer or float)</li>
<li>integer (just integer)</li>
<li>logical (booleans)</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Example</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“a”, “swc”</td>
<td>character</td>
</tr>
<tr class="even">
<td>2, 15.5</td>
<td>numeric</td>
</tr>
<tr class="odd">
<td>2 (Must add a <code>L</code> at end to denote integer)</td>
<td>integer</td>
</tr>
<tr class="even">
<td><code>TRUE</code>, <code>FALSE</code></td>
<td>logical</td>
</tr>
</tbody>
</table>
<p>Like Python, R is dynamically typed. There are a few differences in terminology, however, that are pertinent.</p>
<ul>
<li>First, “types” in Python are referred to as “classes” in R.</li>
</ul>
<p>What is a class?</p>
<div class="figure">
<img src="https://ds055uzetaobb.cloudfront.net/brioche/uploads/pJZt3mh3Ht-prettycars.png?width=2400" alt="" />
<p class="caption">from <a href="https://brilliant.org/" class="uri">https://brilliant.org/</a></p>
</div>
<ul>
<li>Second, R has different names for the types string, integer, and float — specifically <strong>character</strong>, <strong>integer</strong> (not different), and <strong>numeric</strong>. Because there is no “float” class in R, users tend to default to the “numeric” class when working with numerical data.</li>
</ul>
<p>The function for recovering object classes is <code>class()</code>. L suffix to qualify any number with the intent of making it an explicit integer. See more from the <a href="https://cran.r-project.org/doc/manuals/R-lang.html">R language definition</a>.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="tidy_data.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="tidy_data.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(3L)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="tidy_data.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="st">&quot;Three&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="tidy_data.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(F)</span></code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
</div>
</div>
<div id="data-structures" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Data structures<a href="tidy_data.html#data-structures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R’s base data structures can be organized by their dimensionality (1d, 2d, or nd) and whether they’re homogeneous (all contents must be of the same type) or heterogeneous (the contents can be of different types). This gives rise to the five data types most often used in data analysis:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Homogeneous</th>
<th>Heterogeneous</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1d</td>
<td>Atomic vector</td>
<td>List</td>
</tr>
<tr class="even">
<td>2d</td>
<td>Matrix</td>
<td>Data frame</td>
</tr>
<tr class="odd">
<td>nd</td>
<td>Array</td>
<td></td>
</tr>
</tbody>
</table>
<p>Each data structure has its specifications and behavior. For our purposes, an important thing to remember is that R is always <strong>faster</strong> (more efficient) working with homogeneous (<strong>vectorized</strong>) data.</p>
<div id="vector-properties" class="section level4 hasAnchor" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> Vector properties<a href="tidy_data.html#vector-properties" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Vectors have three common properties:</p>
<ul>
<li>Class, <code>class()</code>, or what type of object it is (same as <code>type()</code> in Python).</li>
<li>Length, <code>length()</code>, how many elements it contains (same as <code>len()</code> in Python).</li>
<li>Attributes, <code>attributes()</code>, additional arbitrary metadata.</li>
</ul>
<p>They differ in the types of their elements: all atomic vector elements must be the same type, whereas the elements of a list can have different types.</p>
</div>
<div id="creating-different-types-of-atomic-vectors" class="section level4 hasAnchor" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> Creating different types of atomic vectors<a href="tidy_data.html#creating-different-types-of-atomic-vectors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Remember, there are four common types of vectors:
* <code>logical</code>
* <code>integer</code>
* <code>numeric</code> (same as <code>double</code>)
* <code>character</code>.</p>
<p>You can create an empty vector with <code>vector()</code> (By default, the mode is <code>logical.</code> You can be more explicit as shown in the examples below.) It is more common to use direct constructors such as <code>character()</code>, <code>numeric()</code>, etc.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="tidy_data.html#cb144-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb144-2"><a href="tidy_data.html#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="tidy_data.html#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="co"># with a length and type</span></span>
<span id="cb144-4"><a href="tidy_data.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>, <span class="at">length =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="tidy_data.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="do">## character vector of length 5</span></span>
<span id="cb146-2"><a href="tidy_data.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">character</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="tidy_data.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">numeric</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0 0 0 0 0</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="tidy_data.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logical</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>Atomic vectors are usually created with <code>c()</code>, which is short for concatenate:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="tidy_data.html#cb152-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb152-2"><a href="tidy_data.html#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="tidy_data.html#cb152-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="tidy_data.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(x)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p><code>x</code> is a numeric vector. These are the most common kind. You can also have logical vectors.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="tidy_data.html#cb156-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb156-2"><a href="tidy_data.html#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="tidy_data.html#cb156-3" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE FALSE</code></pre>
<p>Finally, you can have character vectors:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="tidy_data.html#cb158-1" aria-hidden="true" tabindex="-1"></a>kim_family <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Jae&quot;</span>, <span class="st">&quot;Sun&quot;</span>, <span class="st">&quot;Jane&quot;</span>)</span>
<span id="cb158-2"><a href="tidy_data.html#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="tidy_data.html#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">is.integer</span>(kim_family) <span class="co"># integer?</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="tidy_data.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.character</span>(kim_family) <span class="co"># character?</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="tidy_data.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.atomic</span>(kim_family) <span class="co"># atomic?</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="tidy_data.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(kim_family) <span class="co"># what&#39;s the type?</span></span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p><strong>Short exercise: Create and examine your vector</strong></p>
<p>Create a character vector called <code>fruit</code> containing 4 of your favorite fruits. Then evaluate its structure using the commands below.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="tidy_data.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, create your fruit vector</span></span>
<span id="cb166-2"><a href="tidy_data.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span>
<span id="cb166-3"><a href="tidy_data.html#cb166-3" aria-hidden="true" tabindex="-1"></a>fruit <span class="ot">&lt;-</span></span>
<span id="cb166-4"><a href="tidy_data.html#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Examine your vector</span></span>
<span id="cb166-5"><a href="tidy_data.html#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>(fruit)</span>
<span id="cb166-6"><a href="tidy_data.html#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(fruit)</span>
<span id="cb166-7"><a href="tidy_data.html#cb166-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fruit)</span></code></pre></div>
<p><strong>Add elements</strong></p>
<p>You can add elements to the end of a vector by passing the original vector into the <code>c</code> function, like the following:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="tidy_data.html#cb167-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Beyonce&quot;</span>, <span class="st">&quot;Kelly&quot;</span>, <span class="st">&quot;Michelle&quot;</span>, <span class="st">&quot;LeToya&quot;</span>)</span>
<span id="cb167-2"><a href="tidy_data.html#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="tidy_data.html#cb167-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(z, <span class="st">&quot;Farrah&quot;</span>)</span>
<span id="cb167-4"><a href="tidy_data.html#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="tidy_data.html#cb167-5" aria-hidden="true" tabindex="-1"></a>z</span></code></pre></div>
<pre><code>## [1] &quot;Beyonce&quot;  &quot;Kelly&quot;    &quot;Michelle&quot; &quot;LeToya&quot;   &quot;Farrah&quot;</code></pre>
<p>More examples of vectors</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="tidy_data.html#cb169-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.7</span>)</span>
<span id="cb169-2"><a href="tidy_data.html#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="tidy_data.html#cb169-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb169-4"><a href="tidy_data.html#cb169-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-5"><a href="tidy_data.html#cb169-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>)</span>
<span id="cb169-6"><a href="tidy_data.html#cb169-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-7"><a href="tidy_data.html#cb169-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">100</span></span></code></pre></div>
<p>You can also create vectors as a sequence of numbers:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="tidy_data.html#cb170-1" aria-hidden="true" tabindex="-1"></a>series <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb170-2"><a href="tidy_data.html#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="tidy_data.html#cb170-3" aria-hidden="true" tabindex="-1"></a>series</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="tidy_data.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="tidy_data.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>##  [1]  1.0  1.1  1.2  1.3  1.4  1.5  1.6  1.7  1.8  1.9  2.0  2.1  2.2  2.3  2.4
## [16]  2.5  2.6  2.7  2.8  2.9  3.0  3.1  3.2  3.3  3.4  3.5  3.6  3.7  3.8  3.9
## [31]  4.0  4.1  4.2  4.3  4.4  4.5  4.6  4.7  4.8  4.9  5.0  5.1  5.2  5.3  5.4
## [46]  5.5  5.6  5.7  5.8  5.9  6.0  6.1  6.2  6.3  6.4  6.5  6.6  6.7  6.8  6.9
## [61]  7.0  7.1  7.2  7.3  7.4  7.5  7.6  7.7  7.8  7.9  8.0  8.1  8.2  8.3  8.4
## [76]  8.5  8.6  8.7  8.8  8.9  9.0  9.1  9.2  9.3  9.4  9.5  9.6  9.7  9.8  9.9
## [91] 10.0</code></pre>
<p>Atomic vectors are always flat, even if you nest <code>c()</code>’s:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="tidy_data.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">2</span>, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="tidy_data.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the same as</span></span>
<span id="cb178-2"><a href="tidy_data.html#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<p><strong>Types and Tests</strong></p>
<p>Given a vector, you can determine its class with <code>class</code>, or check if it’s a specific type with an “is” function: <code>is.character()</code>, <code>is.numeric()</code>, <code>is.integer()</code>, <code>is.logical()</code>, or, more generally, <code>is.atomic()</code>.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="tidy_data.html#cb180-1" aria-hidden="true" tabindex="-1"></a>char_var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;harry&quot;</span>, <span class="st">&quot;sally&quot;</span>)</span>
<span id="cb180-2"><a href="tidy_data.html#cb180-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-3"><a href="tidy_data.html#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(char_var)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="tidy_data.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.character</span>(char_var)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="tidy_data.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.atomic</span>(char_var)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="tidy_data.html#cb186-1" aria-hidden="true" tabindex="-1"></a>num_var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="fl">4.5</span>)</span>
<span id="cb186-2"><a href="tidy_data.html#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="tidy_data.html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(num_var)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="tidy_data.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(num_var)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="tidy_data.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.atomic</span>(num_var)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>NB: <code>is.vector()</code> does not test if an object is a vector. Instead, it returns <code>TRUE</code> only if the object is a vector with no attributes apart from names. Use <code>is.atomic(x) || is.list(x)</code> to test if an object is actually a vector.</p>
<p><strong>Coercion</strong></p>
<p>All atomic vector elements must be the same type, so when you attempt to combine different types, they will be <strong>coerced</strong> to the <strong>most flexible type.</strong> Types from least to most flexible are: logical &gt; integer &gt; double &gt; character.</p>
<p>For example, combining a character and an integer yields a character:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="tidy_data.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##  chr [1:2] &quot;a&quot; &quot;1&quot;</code></pre>
<p><strong>Guess what the following do without running them first</strong></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="tidy_data.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">1.7</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb194-2"><a href="tidy_data.html#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="tidy_data.html#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="dv">2</span>)</span>
<span id="cb194-4"><a href="tidy_data.html#cb194-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5"><a href="tidy_data.html#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Notice that when a logical vector is coerced to an integer or double, <code>TRUE</code> becomes 1, and <code>FALSE</code> becomes 0. This is very useful in conjunction with <code>sum()</code> and <code>mean()</code></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="tidy_data.html#cb195-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb195-2"><a href="tidy_data.html#cb195-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-3"><a href="tidy_data.html#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(x)</span></code></pre></div>
<pre><code>## [1] 0 0 1</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="tidy_data.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of TRUEs</span></span>
<span id="cb197-2"><a href="tidy_data.html#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="tidy_data.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion that is TRUE</span></span>
<span id="cb199-2"><a href="tidy_data.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] 0.3333333</code></pre>
<p>Coercion often happens automatically. This is called implicit coercion. Most mathematical functions (<code>+</code>, <code>log</code>, <code>abs</code>, etc.) will coerce to a numeric or integer, and most logical operations (<code>&amp;</code>, <code>|</code>, <code>any</code>, etc) will coerce to a logical. You will usually get a warning message if the coercion might lose information.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="tidy_data.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">&lt;</span> <span class="st">&quot;2&quot;</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="tidy_data.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;1&quot;</span> <span class="sc">&gt;</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>You can also coerce vectors explicitly coerce with <code>as.character()</code>, <code>as.numeric()</code>, <code>as.integer()</code>, or <code>as.logical()</code>. Example:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="tidy_data.html#cb205-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb205-2"><a href="tidy_data.html#cb205-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-3"><a href="tidy_data.html#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(x)</span></code></pre></div>
<pre><code>## [1] 0 1 2 3 4 5 6</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="tidy_data.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.logical</span>(x)</span></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="tidy_data.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;0&quot; &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot;</code></pre>
<p>Sometimes coercions, especially nonsensical ones, won’t work.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="tidy_data.html#cb211-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)</span>
<span id="cb211-2"><a href="tidy_data.html#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="tidy_data.html#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(x)</span></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<pre><code>## [1] NA NA NA</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="tidy_data.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.logical</span>(x)</span></code></pre></div>
<pre><code>## [1] NA NA NA</code></pre>
<p><strong>Short Exercise</strong></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="tidy_data.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create a vector of a sequence of numbers between 1 to 10.</span></span>
<span id="cb216-2"><a href="tidy_data.html#cb216-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-3"><a href="tidy_data.html#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Coerce that vector into a character vector</span></span>
<span id="cb216-4"><a href="tidy_data.html#cb216-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-5"><a href="tidy_data.html#cb216-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Add the element &quot;11&quot; to the end of the vector</span></span>
<span id="cb216-6"><a href="tidy_data.html#cb216-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-7"><a href="tidy_data.html#cb216-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Coerce it back to a numeric vector.</span></span></code></pre></div>
</div>
<div id="lists" class="section level4 hasAnchor" number="4.2.2.3">
<h4><span class="header-section-number">4.2.2.3</span> Lists<a href="tidy_data.html#lists" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Lists are also vectors, but different from atomic vectors because their elements can be of any type. In short, they are generic vectors. For example, you construct lists by using <code>list()</code> instead of <code>c()</code>:</p>
<p>Lists are sometimes called recursive vectors, because a list can contain other lists. This makes them fundamentally different from atomic vectors.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="tidy_data.html#cb217-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="st">&quot;a&quot;</span>, <span class="cn">TRUE</span>, <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb217-2"><a href="tidy_data.html#cb217-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-3"><a href="tidy_data.html#cb217-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] &quot;a&quot;
## 
## [[3]]
## [1] TRUE
## 
## [[4]]
## [1] 4 5 6</code></pre>
<p>You can coerce other objects using <code>as.list()</code>. You can test for a list with <code>is.list()</code></p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="tidy_data.html#cb219-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb219-2"><a href="tidy_data.html#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="tidy_data.html#cb219-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.list</span>(x)</span>
<span id="cb219-4"><a href="tidy_data.html#cb219-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-5"><a href="tidy_data.html#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="fu">is.list</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="tidy_data.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(x)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p><code>c()</code> will combine several lists into one. If given a combination of atomic vectors and lists, <code>c()</code> (con<strong>c</strong>atenate) will coerce the vectors to lists before combining them. Compare the results of <code>list()</code> and <code>c()</code>:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="tidy_data.html#cb223-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb223-2"><a href="tidy_data.html#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="tidy_data.html#cb223-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb223-4"><a href="tidy_data.html#cb223-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-5"><a href="tidy_data.html#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code></pre></div>
<pre><code>## List of 2
##  $ :List of 2
##   ..$ : num 1
##   ..$ : num 2
##  $ : num [1:2] 3 4</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="tidy_data.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(y)</span></code></pre></div>
<pre><code>## List of 4
##  $ : num 1
##  $ : num 2
##  $ : num 3
##  $ : num 4</code></pre>
<p>You can turn a list into an atomic vector with <code>unlist()</code>. If the elements of a list have different types, <code>unlist()</code> uses the same coercion rules as <code>c()</code>.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="tidy_data.html#cb227-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb227-2"><a href="tidy_data.html#cb227-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-3"><a href="tidy_data.html#cb227-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [[1]]
## [[1]][[1]]
## [1] 1
## 
## [[1]][[2]]
## [1] 2
## 
## 
## [[2]]
## [1] 3 4</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="tidy_data.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(x)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<p>Lists are used to build up many of the more complicated data structures in R. For example, both data frames and linear models objects (as produced by <code>lm()</code>) are lists:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="tidy_data.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.list</span>(mtcars)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="tidy_data.html#cb233-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb233-2"><a href="tidy_data.html#cb233-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-3"><a href="tidy_data.html#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="fu">is.list</span>(mod)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>For this reason, lists are handy inside functions. You can “staple” together many different kinds of results into a single object that a function can return.</p>
<p>A list does not print to the console like a vector. Instead, each element of the list starts on a new line.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="tidy_data.html#cb235-1" aria-hidden="true" tabindex="-1"></a>x.vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb235-2"><a href="tidy_data.html#cb235-2" aria-hidden="true" tabindex="-1"></a>x.list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb235-3"><a href="tidy_data.html#cb235-3" aria-hidden="true" tabindex="-1"></a>x.vec</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="tidy_data.html#cb237-1" aria-hidden="true" tabindex="-1"></a>x.list</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 2
## 
## [[3]]
## [1] 3</code></pre>
<p>For lists, elements are <strong>indexed by double brackets</strong>. Single brackets will still return a(nother) list. (We’ll talk more about subsetting and indexing in the fourth lesson.)</p>
<p><strong>Exercises</strong></p>
<ol style="list-style-type: decimal">
<li><p>What are the four basic types of atomic vectors? How does a list differ from an atomic vector?</p></li>
<li><p>Why is <code>1 == "1"</code> true? Why is <code>-1 &lt; FALSE</code> true? Why is <code>"one" &lt; 2</code> false?</p></li>
<li><p>Create three vectors and then combine them into a list.</p></li>
<li><p>If <code>x</code> is a list, what is the class of <code>x[1]</code>? How about <code>x[[1]]</code>?</p></li>
</ol>
</div>
</div>
<div id="attributes" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Attributes<a href="tidy_data.html#attributes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Attributes provide additional information about the data to you, the user, and to R. We’ve already seen the following three attributes in action:</p>
<ul>
<li><p>Names (<code>names(x)</code>), a character vector giving each element a name.</p></li>
<li><p>Dimensions (<code>dim(x)</code>), used to turn vectors into matrices.</p></li>
<li><p>Class (<code>class(x)</code>), used to implement the S3 object system.</p></li>
</ul>
<p><strong>Additional tips</strong></p>
<p>In an object-oriented system, a <a href="https://www.google.com/search?q=what+is+class+programming&amp;oq=what+is+class+programming&amp;aqs=chrome.0.0l6.3543j0j4&amp;sourceid=chrome&amp;ie=UTF-8">class</a> (an extensible problem-code-template) defines a type of object like what its properties are, how it behaves, and how it relates to other types of objects. Therefore, technically, an object is an <a href="https://en.wikipedia.org/wiki/Instance_(computer_science)">instance</a> (or occurrence) of a class. A method is a function associated with a particular type of object.</p>
<div id="names" class="section level4 hasAnchor" number="4.2.3.1">
<h4><span class="header-section-number">4.2.3.1</span> Names<a href="tidy_data.html#names" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can name a vector when you create it:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="tidy_data.html#cb239-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">c =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>You can also modify an existing vector:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="tidy_data.html#cb240-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb240-2"><a href="tidy_data.html#cb240-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-3"><a href="tidy_data.html#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="tidy_data.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;e&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;g&quot;</span>)</span>
<span id="cb242-2"><a href="tidy_data.html#cb242-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-3"><a href="tidy_data.html#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;e&quot; &quot;f&quot; &quot;g&quot;</code></pre>
<p>Names don’t have to be unique. However, character subsetting, described in the next lesson, is the most important reason to use names, and it is most useful when the names are unique. (For Python users: when names are unique, a vector behaves like a Python dictionary key.)</p>
<p>Not all elements of a vector need to have a name. If some names are missing, <code>names()</code> will return an empty string for those elements. If all names are missing, <code>names()</code> will return <code>NULL</code>.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="tidy_data.html#cb244-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb244-2"><a href="tidy_data.html#cb244-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-3"><a href="tidy_data.html#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(y)</span></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;&quot;  &quot;&quot;</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="tidy_data.html#cb246-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb246-2"><a href="tidy_data.html#cb246-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-3"><a href="tidy_data.html#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(z)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>You can create a new vector without names using <code>unname(x)</code>, or remove names in place with <code>names(x) &lt;- NULL</code>.</p>
</div>
<div id="factors" class="section level4 hasAnchor" number="4.2.3.2">
<h4><span class="header-section-number">4.2.3.2</span> Factors<a href="tidy_data.html#factors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Factors are special vectors that represent categorical data. Factors can be ordered (ordinal variable) or unordered (nominal or categorical variable) and are important for modeling functions such as <code>lm()</code> and <code>glm()</code> and also in plot methods.</p>
<p><strong>Quiz</strong>
1. If you want to enter dummy variables (Democrats = 1, Non-democrats = 0) in your regression model, should you use a numeric or factor variable?</p>
<p>Factors can only contain pre-defined values. Set allowed values using the <code>levels()</code> attribute. Note that a factor’s levels will always be character values.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="tidy_data.html#cb248-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb248-2"><a href="tidy_data.html#cb248-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-3"><a href="tidy_data.html#cb248-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>))</span>
<span id="cb248-4"><a href="tidy_data.html#cb248-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-5"><a href="tidy_data.html#cb248-5" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] a b b a
## Levels: a b</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="tidy_data.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="tidy_data.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot;</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="tidy_data.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can&#39;t use values that are not in the levels</span></span>
<span id="cb254-2"><a href="tidy_data.html#cb254-2" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;c&quot;</span></span></code></pre></div>
<pre><code>## Warning in `[&lt;-.factor`(`*tmp*`, 2, value = &quot;c&quot;): invalid factor level, NA
## generated</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="tidy_data.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NB: you can&#39;t combine factors</span></span>
<span id="cb256-2"><a href="tidy_data.html#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">factor</span>(<span class="st">&quot;a&quot;</span>), <span class="fu">factor</span>(<span class="st">&quot;b&quot;</span>))</span></code></pre></div>
<pre><code>## [1] a b
## Levels: a b</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="tidy_data.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">rep</span>(<span class="dv">6</span>, <span class="dv">5</span>))</span></code></pre></div>
<pre><code>##  [1] 1 1 1 1 1 1 2 2 2 2 2 2 3 3 3 3 3 3 4 4 4 4 4 4 5 5 5 5 5 5</code></pre>
<p>Factors are pretty much integers that have labels on them. Underneath, it’s really numbers (1, 2, 3…).</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="tidy_data.html#cb260-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>))</span>
<span id="cb260-2"><a href="tidy_data.html#cb260-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-3"><a href="tidy_data.html#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code></pre></div>
<pre><code>##  Factor w/ 2 levels &quot;a&quot;,&quot;b&quot;: 1 2 2 1</code></pre>
<p>They are better than using simple integer labels because factors are what are called self-describing. For example, <code>democrat</code> and <code>republican</code> is more descriptive than <code>1</code>s and <code>2</code>s.</p>
<p>Factors are useful when you know the possible values a variable may take, even if you don’t see all values in a given dataset. Using a factor instead of a character vector makes it obvious when some groups contain no observations:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="tidy_data.html#cb262-1" aria-hidden="true" tabindex="-1"></a>party_char <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;democrat&quot;</span>, <span class="st">&quot;democrat&quot;</span>, <span class="st">&quot;democrat&quot;</span>)</span>
<span id="cb262-2"><a href="tidy_data.html#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="tidy_data.html#cb262-3" aria-hidden="true" tabindex="-1"></a>party_char</span></code></pre></div>
<pre><code>## [1] &quot;democrat&quot; &quot;democrat&quot; &quot;democrat&quot;</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="tidy_data.html#cb264-1" aria-hidden="true" tabindex="-1"></a>party_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(party_char, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;democrat&quot;</span>, <span class="st">&quot;republican&quot;</span>))</span>
<span id="cb264-2"><a href="tidy_data.html#cb264-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-3"><a href="tidy_data.html#cb264-3" aria-hidden="true" tabindex="-1"></a>party_factor</span></code></pre></div>
<pre><code>## [1] democrat democrat democrat
## Levels: democrat republican</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="tidy_data.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(party_char) <span class="co"># shows only democrats</span></span></code></pre></div>
<pre><code>## party_char
## democrat 
##        3</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="tidy_data.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(party_factor) <span class="co"># shows republicans too</span></span></code></pre></div>
<pre><code>## party_factor
##   democrat republican 
##          3          0</code></pre>
<p>Sometimes factors can be left unordered. Example: <code>democrat</code>, <code>republican.</code></p>
<p>Other times you might want factors to be ordered (or ranked). Example: <code>low</code>, <code>medium</code>, <code>high</code>.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="tidy_data.html#cb270-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>))</span>
<span id="cb270-2"><a href="tidy_data.html#cb270-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-3"><a href="tidy_data.html#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code></pre></div>
<pre><code>##  Factor w/ 3 levels &quot;high&quot;,&quot;low&quot;,&quot;medium&quot;: 2 3 1</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="tidy_data.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ordered</span>(x)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="tidy_data.html#cb274-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">ordered</span>(<span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;low&quot;</span>))</span>
<span id="cb274-2"><a href="tidy_data.html#cb274-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-3"><a href="tidy_data.html#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ordered</span>(y)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>While factors look (and often behave) like character vectors, they are integers. So be careful when treating them like strings. Some string methods (like <code>gsub()</code> and <code>grepl()</code>) will coerce factors to strings, while others (like <code>nchar()</code>) will throw an error, and still others (like <code>c()</code>) will use the underlying integer values.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="tidy_data.html#cb276-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb276-2"><a href="tidy_data.html#cb276-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-3"><a href="tidy_data.html#cb276-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot; &quot;b&quot; &quot;a&quot;</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="tidy_data.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(x)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="tidy_data.html#cb280-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(x)</span>
<span id="cb280-2"><a href="tidy_data.html#cb280-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-3"><a href="tidy_data.html#cb280-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] a b b a
## Levels: a b</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="tidy_data.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(x, <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;2&quot; &quot;1&quot; &quot;c&quot;</code></pre>
<p>For this reason, it’s usually best to explicitly convert factors to character vectors if you need string-like behavior. There was a memory advantage to using factors instead of character vectors in early versions of R, but this is no longer the case.</p>
<p>Unfortunately, most data loading functions in R automatically convert character vectors to factors. This is suboptimal, because there’s no way for those functions to know the set of all possible levels or their optimal order. If this becomes a problem, use the argument <code>stringsAsFactors = FALSE</code> to suppress this behavior and manually convert character vectors to factors using your knowledge of the data.</p>
<p><strong>More attributes</strong></p>
<p>All R objects can have arbitrary additional attributes used to store metadata about the object. Attributes can be considered a named list (with unique names). Attributes can be accessed individually with <code>attr()</code> or all at once (as a list) with <code>attributes().</code></p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="tidy_data.html#cb284-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb284-2"><a href="tidy_data.html#cb284-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-3"><a href="tidy_data.html#cb284-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(y, <span class="st">&quot;my_attribute&quot;</span>) <span class="ot">&lt;-</span> <span class="st">&quot;This is a vector&quot;</span></span>
<span id="cb284-4"><a href="tidy_data.html#cb284-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-5"><a href="tidy_data.html#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attr</span>(y, <span class="st">&quot;my_attribute&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;This is a vector&quot;</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="tidy_data.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str returns a new object with modified information</span></span>
<span id="cb286-2"><a href="tidy_data.html#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">attributes</span>(y))</span></code></pre></div>
<pre><code>## List of 1
##  $ my_attribute: chr &quot;This is a vector&quot;</code></pre>
<p><strong>Exercises</strong></p>
<ol style="list-style-type: decimal">
<li>What happens to a factor when you modify its levels?</li>
</ol>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="tidy_data.html#cb288-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(letters)</span>
<span id="cb288-2"><a href="tidy_data.html#cb288-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-3"><a href="tidy_data.html#cb288-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(f1) <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">levels</span>(f1))</span>
<span id="cb288-4"><a href="tidy_data.html#cb288-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-5"><a href="tidy_data.html#cb288-5" aria-hidden="true" tabindex="-1"></a>f1</span></code></pre></div>
<pre><code>##  [1] z y x w v u t s r q p o n m l k j i h g f e d c b a
## Levels: z y x w v u t s r q p o n m l k j i h g f e d c b a</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>What does this code do? How do <code>f2</code> and <code>f3</code> differ from <code>f1</code>?</li>
</ol>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="tidy_data.html#cb290-1" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">factor</span>(letters))</span>
<span id="cb290-2"><a href="tidy_data.html#cb290-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-3"><a href="tidy_data.html#cb290-3" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">factor</span>(letters, <span class="at">levels =</span> <span class="fu">rev</span>(letters))</span></code></pre></div>
</div>
</div>
<div id="d-data-matrices-and-dataframes" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> 2D data: Matrices and dataframes<a href="tidy_data.html#d-data-matrices-and-dataframes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Matrices: data structures for storing 2d data that is all the same class.</li>
<li>Dataframes: teaches you about the dataframe, the most important data structure for storing data in R, because it stores different kinds of (2d) data.</li>
</ol>
<div id="matrices" class="section level4 hasAnchor" number="4.2.4.1">
<h4><span class="header-section-number">4.2.4.1</span> Matrices<a href="tidy_data.html#matrices" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Matrices are created when we combine multiple vectors with the same class (e.g., numeric). This creates a dataset with rows and columns. By definition, if you want to combine multiple classes of vectors, you want a dataframe. You can coerce a matrix to become a dataframe and vice-versa, but as with all vector coercions, the results can be unpredictable, so be sure you know how each variable (column) will convert.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="tidy_data.html#cb291-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb291-2"><a href="tidy_data.html#cb291-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-3"><a href="tidy_data.html#cb291-3" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   NA   NA
## [2,]   NA   NA</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="tidy_data.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(m)</span></code></pre></div>
<pre><code>## [1] 2 2</code></pre>
<p>Matrices are filled column-wise.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="tidy_data.html#cb295-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb295-2"><a href="tidy_data.html#cb295-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-3"><a href="tidy_data.html#cb295-3" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6</code></pre>
<p>Other ways to construct a matrix</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="tidy_data.html#cb297-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb297-2"><a href="tidy_data.html#cb297-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-3"><a href="tidy_data.html#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb297-4"><a href="tidy_data.html#cb297-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-5"><a href="tidy_data.html#cb297-5" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    3    5    7    9
## [2,]    2    4    6    8   10</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="tidy_data.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb299-2"><a href="tidy_data.html#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="tidy_data.html#cb299-3" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    6
## [2,]    2    7
## [3,]    3    8
## [4,]    4    9
## [5,]    5   10</code></pre>
<p>You can transpose a matrix (or dataframe) with <code>t()</code></p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="tidy_data.html#cb301-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb301-2"><a href="tidy_data.html#cb301-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-3"><a href="tidy_data.html#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb301-4"><a href="tidy_data.html#cb301-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-5"><a href="tidy_data.html#cb301-5" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    3    5    7    9
## [2,]    2    4    6    8   10</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="tidy_data.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(m)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4
## [3,]    5    6
## [4,]    7    8
## [5,]    9   10</code></pre>
<p>Another way is to bind columns or rows using <code>cbind()</code> and <code>rbind()</code>.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="tidy_data.html#cb305-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb305-2"><a href="tidy_data.html#cb305-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-3"><a href="tidy_data.html#cb305-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb305-4"><a href="tidy_data.html#cb305-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-5"><a href="tidy_data.html#cb305-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(x, y)</span></code></pre></div>
<pre><code>##      x  y
## [1,] 1 10
## [2,] 2 11
## [3,] 3 12</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="tidy_data.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb307-2"><a href="tidy_data.html#cb307-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb307-3"><a href="tidy_data.html#cb307-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(x, y)</span></code></pre></div>
<pre><code>##   [,1] [,2] [,3]
## x    1    2    3
## y   10   11   12</code></pre>
<p>You can also use the <code>byrow</code> argument to specify how the matrix is filled. From R’s own documentation:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="tidy_data.html#cb309-1" aria-hidden="true" tabindex="-1"></a>mdat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>),</span>
<span id="cb309-2"><a href="tidy_data.html#cb309-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb309-3"><a href="tidy_data.html#cb309-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb309-4"><a href="tidy_data.html#cb309-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb309-5"><a href="tidy_data.html#cb309-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb309-6"><a href="tidy_data.html#cb309-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;row1&quot;</span>, <span class="st">&quot;row2&quot;</span>),</span>
<span id="cb309-7"><a href="tidy_data.html#cb309-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;C.1&quot;</span>, <span class="st">&quot;C.2&quot;</span>, <span class="st">&quot;C.3&quot;</span>)</span>
<span id="cb309-8"><a href="tidy_data.html#cb309-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb309-9"><a href="tidy_data.html#cb309-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb309-10"><a href="tidy_data.html#cb309-10" aria-hidden="true" tabindex="-1"></a>mdat</span></code></pre></div>
<pre><code>##      C.1 C.2 C.3
## row1   1   2   3
## row2  11  12  13</code></pre>
<p>Notice that we gave <code>names</code> to the dimensions in <code>mdat</code>.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="tidy_data.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(mdat)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;row1&quot; &quot;row2&quot;
## 
## [[2]]
## [1] &quot;C.1&quot; &quot;C.2&quot; &quot;C.3&quot;</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="tidy_data.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mdat)</span></code></pre></div>
<pre><code>## [1] &quot;row1&quot; &quot;row2&quot;</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="tidy_data.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mdat)</span></code></pre></div>
<pre><code>## [1] &quot;C.1&quot; &quot;C.2&quot; &quot;C.3&quot;</code></pre>
</div>
<div id="dataframes" class="section level4 hasAnchor" number="4.2.4.2">
<h4><span class="header-section-number">4.2.4.2</span> Dataframes<a href="tidy_data.html#dataframes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A data frame is an essential data type in R. It’s pretty much the <strong>de facto</strong> data structure for most tabular data and what we use for statistics.</p>
<div id="creation" class="section level5 hasAnchor" number="4.2.4.2.1">
<h5><span class="header-section-number">4.2.4.2.1</span> Creation<a href="tidy_data.html#creation" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>You create a data frame using <code>data.frame()</code>, which takes named vectors as input:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="tidy_data.html#cb317-1" aria-hidden="true" tabindex="-1"></a>vec1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb317-2"><a href="tidy_data.html#cb317-2" aria-hidden="true" tabindex="-1"></a>vec2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)</span>
<span id="cb317-3"><a href="tidy_data.html#cb317-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(vec1, vec2)</span>
<span id="cb317-4"><a href="tidy_data.html#cb317-4" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   vec1 vec2
## 1    1    a
## 2    2    b
## 3    3    c</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="tidy_data.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  2 variables:
##  $ vec1: int  1 2 3
##  $ vec2: chr  &quot;a&quot; &quot;b&quot; &quot;c&quot;</code></pre>
<p>Beware: <code>data.frame()</code>’s default behavior which turns strings into factors. Remember to use <code>stringAsFactors = FALSE</code> to suppress this behavior as needed:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="tidy_data.html#cb321-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb321-2"><a href="tidy_data.html#cb321-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb321-3"><a href="tidy_data.html#cb321-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</span>
<span id="cb321-4"><a href="tidy_data.html#cb321-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb321-5"><a href="tidy_data.html#cb321-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb321-6"><a href="tidy_data.html#cb321-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  2 variables:
##  $ x: int  1 2 3
##  $ y: chr  &quot;a&quot; &quot;b&quot; &quot;c&quot;</code></pre>
<p>In reality, we rarely type up our datasets ourselves, and certainly not in R. The most common way to make a data.frame is by calling a file using <code>read.csv</code> (which relies on the <code>foreign</code> package), <code>read.dta</code> (if you’re using a Stata file), or some other kinds of data file input.</p>
</div>
<div id="structure-and-attributes" class="section level5 hasAnchor" number="4.2.4.2.2">
<h5><span class="header-section-number">4.2.4.2.2</span> Structure and Attributes<a href="tidy_data.html#structure-and-attributes" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Under the hood, a data frame is a list of equal-length vectors. This makes it a 2-dimensional structure, so it shares properties of both the matrix and the list.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="tidy_data.html#cb323-1" aria-hidden="true" tabindex="-1"></a>vec1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb323-2"><a href="tidy_data.html#cb323-2" aria-hidden="true" tabindex="-1"></a>vec2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)</span>
<span id="cb323-3"><a href="tidy_data.html#cb323-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(vec1, vec2)</span>
<span id="cb323-4"><a href="tidy_data.html#cb323-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-5"><a href="tidy_data.html#cb323-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  2 variables:
##  $ vec1: int  1 2 3
##  $ vec2: chr  &quot;a&quot; &quot;b&quot; &quot;c&quot;</code></pre>
<p>This means that a dataframe has <code>names()</code>, <code>colnames()</code>, and <code>rownames()</code>, although <code>names()</code> and <code>colnames()</code> are the same thing.</p>
<p>** Summary **</p>
<ul>
<li>Set column names: <code>names()</code> in data frame, <code>colnames()</code> in matrix</li>
<li>Set row names: <code>row.names()</code> in data frame, <code>rownames()</code> in matrix</li>
</ul>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="tidy_data.html#cb325-1" aria-hidden="true" tabindex="-1"></a>vec1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb325-2"><a href="tidy_data.html#cb325-2" aria-hidden="true" tabindex="-1"></a>vec2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)</span>
<span id="cb325-3"><a href="tidy_data.html#cb325-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(vec1, vec2)</span>
<span id="cb325-4"><a href="tidy_data.html#cb325-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-5"><a href="tidy_data.html#cb325-5" aria-hidden="true" tabindex="-1"></a><span class="co"># these two are equivalent</span></span>
<span id="cb325-6"><a href="tidy_data.html#cb325-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code></pre></div>
<pre><code>## [1] &quot;vec1&quot; &quot;vec2&quot;</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="tidy_data.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df)</span></code></pre></div>
<pre><code>## [1] &quot;vec1&quot; &quot;vec2&quot;</code></pre>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="tidy_data.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change the colnames</span></span>
<span id="cb329-2"><a href="tidy_data.html#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Number&quot;</span>, <span class="st">&quot;Character&quot;</span>)</span>
<span id="cb329-3"><a href="tidy_data.html#cb329-3" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   Number Character
## 1      1         a
## 2      2         b
## 3      3         c</code></pre>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="tidy_data.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Number&quot;</span>, <span class="st">&quot;Character&quot;</span>)</span>
<span id="cb331-2"><a href="tidy_data.html#cb331-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   Number Character
## 1      1         a
## 2      2         b
## 3      3         c</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="tidy_data.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change the rownames</span></span>
<span id="cb333-2"><a href="tidy_data.html#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df)</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="tidy_data.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;donut&quot;</span>, <span class="st">&quot;pickle&quot;</span>, <span class="st">&quot;pretzel&quot;</span>)</span>
<span id="cb335-2"><a href="tidy_data.html#cb335-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##         Number Character
## donut        1         a
## pickle       2         b
## pretzel      3         c</code></pre>
<p>The <code>length()</code> of a dataframe is the length of the underlying list and so is the same as <code>ncol()</code>; <code>nrow()</code> gives the number of rows.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="tidy_data.html#cb337-1" aria-hidden="true" tabindex="-1"></a>vec1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb337-2"><a href="tidy_data.html#cb337-2" aria-hidden="true" tabindex="-1"></a>vec2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)</span>
<span id="cb337-3"><a href="tidy_data.html#cb337-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(vec1, vec2)</span>
<span id="cb337-4"><a href="tidy_data.html#cb337-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-5"><a href="tidy_data.html#cb337-5" aria-hidden="true" tabindex="-1"></a><span class="co"># these two are equivalent - number of columns</span></span>
<span id="cb337-6"><a href="tidy_data.html#cb337-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(df)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="tidy_data.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(df)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="tidy_data.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get number of rows</span></span>
<span id="cb341-2"><a href="tidy_data.html#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="tidy_data.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get number of both columns and rows</span></span>
<span id="cb343-2"><a href="tidy_data.html#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code></pre></div>
<pre><code>## [1] 3 2</code></pre>
</div>
<div id="testing-and-coercion" class="section level5 hasAnchor" number="4.2.4.2.3">
<h5><span class="header-section-number">4.2.4.2.3</span> Testing and coercion<a href="tidy_data.html#testing-and-coercion" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To check if an object is a dataframe, use <code>class()</code> or test explicitly with <code>is.data.frame()</code>:</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="tidy_data.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="tidy_data.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.data.frame</span>(df)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>You can coerce an object to a dataframe with <code>as.data.frame()</code>:</p>
<ul>
<li><p>A vector will create a one-column dataframe.</p></li>
<li><p>A list will create one column for each element; it’s an error if they’re
not all the same length.</p></li>
<li><p>A matrix will create a data frame with the same number of columns and rows as the matrix.</p></li>
</ul>
</div>
<div id="combining-dataframes" class="section level5 hasAnchor" number="4.2.4.2.4">
<h5><span class="header-section-number">4.2.4.2.4</span> Combining dataframes<a href="tidy_data.html#combining-dataframes" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>You can combine dataframes using <code>cbind()</code> and <code>rbind()</code>:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="tidy_data.html#cb349-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb349-2"><a href="tidy_data.html#cb349-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb349-3"><a href="tidy_data.html#cb349-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),</span>
<span id="cb349-4"><a href="tidy_data.html#cb349-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb349-5"><a href="tidy_data.html#cb349-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb349-6"><a href="tidy_data.html#cb349-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-7"><a href="tidy_data.html#cb349-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(df, <span class="fu">data.frame</span>(<span class="at">z =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>##   x y z
## 1 1 a 3
## 2 2 b 2
## 3 3 c 1</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="tidy_data.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(df, <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="st">&quot;z&quot;</span>))</span></code></pre></div>
<pre><code>##    x y
## 1  1 a
## 2  2 b
## 3  3 c
## 4 10 z</code></pre>
<p>When combining column-wise, the number of rows must match, but row names are ignored. When combining row-wise, both the number and names of columns must match. (If you want to combine rows that don’t have the same columns, other functions/packages in R can help.)</p>
<p>It’s a common mistake to try and create a dataframe by <code>cbind()</code>ing vectors together. This doesn’t work because <code>cbind()</code> will create a matrix unless one of the arguments is already a dataframe. Instead use <code>data.frame()</code> directly:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="tidy_data.html#cb353-1" aria-hidden="true" tabindex="-1"></a>bad <span class="ot">&lt;-</span> (<span class="fu">cbind</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)))</span>
<span id="cb353-2"><a href="tidy_data.html#cb353-2" aria-hidden="true" tabindex="-1"></a>bad</span></code></pre></div>
<pre><code>##      x   y  
## [1,] &quot;1&quot; &quot;a&quot;
## [2,] &quot;2&quot; &quot;b&quot;</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="tidy_data.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(bad)</span></code></pre></div>
<pre><code>##  chr [1:2, 1:2] &quot;1&quot; &quot;2&quot; &quot;a&quot; &quot;b&quot;
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : NULL
##   ..$ : chr [1:2] &quot;x&quot; &quot;y&quot;</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="tidy_data.html#cb357-1" aria-hidden="true" tabindex="-1"></a>good <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb357-2"><a href="tidy_data.html#cb357-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>),</span>
<span id="cb357-3"><a href="tidy_data.html#cb357-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb357-4"><a href="tidy_data.html#cb357-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb357-5"><a href="tidy_data.html#cb357-5" aria-hidden="true" tabindex="-1"></a>good</span></code></pre></div>
<pre><code>##   x y
## 1 1 a
## 2 2 b</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="tidy_data.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(good)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    2 obs. of  2 variables:
##  $ x: int  1 2
##  $ y: chr  &quot;a&quot; &quot;b&quot;</code></pre>
<p>The conversion rules for <code>cbind()</code> are complicated and best avoided by ensuring all inputs are of the same type.</p>
<p><strong>Other objects</strong></p>
<p>Missing values are specified with <code>NA,</code> which is a logical vector of length 1. <code>NA</code> will always be coerced to the correct type if used inside <code>c()</code></p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="tidy_data.html#cb361-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>)</span>
<span id="cb361-2"><a href="tidy_data.html#cb361-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] NA  1</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="tidy_data.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="cn">NA</span>)</span></code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="tidy_data.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<p><code>Inf</code> is infinity. You can have either positive or negative infinity.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="tidy_data.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">/</span> <span class="dv">0</span></span></code></pre></div>
<pre><code>## [1] Inf</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="tidy_data.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">/</span> <span class="cn">Inf</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p><code>NaN</code> means Not a number. It’s an undefined value.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="tidy_data.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="sc">/</span> <span class="dv">0</span></span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
</div>
</div>
</div>
<div id="subset" class="section level3 hasAnchor" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Subset<a href="tidy_data.html#subset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When working with data, you’ll need to subset objects early and often. Luckily, R’s subsetting operators are powerful and fast. Mastery of subsetting allows you to succinctly express complex operations in a way that few other languages can match. Subsetting is hard to learn because you need to master several interrelated concepts:</p>
<ul>
<li><p>The three subsetting operators, <code>[</code>, <code>[[</code>, and <code>$</code>.</p></li>
<li><p>Important differences in behavior for different objects (e.g., vectors, lists, factors, matrices, and data frames).</p></li>
<li><p>The use of subsetting in conjunction with assignment.</p></li>
</ul>
<p>This unit helps you master subsetting by starting with the simplest type of subsetting: subsetting an atomic vector with <code>[</code>. It then gradually extends your knowledge to more complicated data types (like dataframes and lists) and then to the other subsetting operators, <code>[[</code> and <code>$</code>. You’ll then learn how subsetting and assignment can be combined to modify parts of an object, and, finally, you’ll see a large number of useful applications.</p>
<div id="atomic-vectors" class="section level4 hasAnchor" number="4.2.5.1">
<h4><span class="header-section-number">4.2.5.1</span> Atomic vectors<a href="tidy_data.html#atomic-vectors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s explore the different types of subsetting with a simple vector, <code>x</code>.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="tidy_data.html#cb373-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">4.2</span>, <span class="fl">3.3</span>, <span class="fl">5.4</span>)</span></code></pre></div>
<p>Note that the number after the decimal point gives the original position in the vector.</p>
<p><strong>NB:</strong> In R, positions start at 1, unlike Python, which starts at 0. Fun!**</p>
<p>There are five things that you can use to subset a vector:</p>
<div id="positive-integers" class="section level5 hasAnchor" number="4.2.5.1.1">
<h5><span class="header-section-number">4.2.5.1.1</span> Positive integers<a href="tidy_data.html#positive-integers" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="tidy_data.html#cb374-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">4.2</span>, <span class="fl">3.3</span>, <span class="fl">5.4</span>)</span>
<span id="cb374-2"><a href="tidy_data.html#cb374-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] 2.1 4.2 3.3 5.4</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="tidy_data.html#cb376-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 2.1</code></pre>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="tidy_data.html#cb378-1" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)]</span></code></pre></div>
<pre><code>## [1] 3.3 2.1</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="tidy_data.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co"># `order(x)` gives the positions of smallest to largest values.</span></span>
<span id="cb380-2"><a href="tidy_data.html#cb380-2" aria-hidden="true" tabindex="-1"></a><span class="fu">order</span>(x)</span></code></pre></div>
<pre><code>## [1] 1 3 2 4</code></pre>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="tidy_data.html#cb382-1" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">order</span>(x)]</span></code></pre></div>
<pre><code>## [1] 2.1 3.3 4.2 5.4</code></pre>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="tidy_data.html#cb384-1" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>)]</span></code></pre></div>
<pre><code>## [1] 2.1 3.3 4.2 5.4</code></pre>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="tidy_data.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Duplicated indices yield duplicated values</span></span>
<span id="cb386-2"><a href="tidy_data.html#cb386-2" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)]</span></code></pre></div>
<pre><code>## [1] 2.1 2.1</code></pre>
</div>
<div id="negative-integers" class="section level5 hasAnchor" number="4.2.5.1.2">
<h5><span class="header-section-number">4.2.5.1.2</span> Negative integers<a href="tidy_data.html#negative-integers" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="tidy_data.html#cb388-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">4.2</span>, <span class="fl">3.3</span>, <span class="fl">5.4</span>)</span>
<span id="cb388-2"><a href="tidy_data.html#cb388-2" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 4.2 3.3 5.4</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="tidy_data.html#cb390-1" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)]</span></code></pre></div>
<pre><code>## [1] 4.2 5.4</code></pre>
<p>You can’t mix positive and negative integers in a single subset:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="tidy_data.html#cb392-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">4.2</span>, <span class="fl">3.3</span>, <span class="fl">5.4</span>)</span>
<span id="cb392-2"><a href="tidy_data.html#cb392-2" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>)]</span></code></pre></div>
<pre><code>## Error in x[c(-1, 2)]: only 0&#39;s may be mixed with negative subscripts</code></pre>
</div>
<div id="logical-vectors" class="section level5 hasAnchor" number="4.2.5.1.3">
<h5><span class="header-section-number">4.2.5.1.3</span> Logical vectors<a href="tidy_data.html#logical-vectors" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="tidy_data.html#cb394-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">4.2</span>, <span class="fl">3.3</span>, <span class="fl">5.4</span>)</span>
<span id="cb394-2"><a href="tidy_data.html#cb394-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-3"><a href="tidy_data.html#cb394-3" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)]</span></code></pre></div>
<pre><code>## [1] 2.1 4.2</code></pre>
<p>This is probably the most useful type of subsetting because you write the expression that creates the logical vector.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="tidy_data.html#cb396-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">4.2</span>, <span class="fl">3.3</span>, <span class="fl">5.4</span>)</span>
<span id="cb396-2"><a href="tidy_data.html#cb396-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-3"><a href="tidy_data.html#cb396-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this returns a logical vector</span></span>
<span id="cb396-4"><a href="tidy_data.html#cb396-4" aria-hidden="true" tabindex="-1"></a>x <span class="sc">&gt;</span> <span class="dv">3</span></span></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="tidy_data.html#cb398-1" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] 2.1 4.2 3.3 5.4</code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="tidy_data.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use a conditional statement to create an implicit logical vector</span></span>
<span id="cb400-2"><a href="tidy_data.html#cb400-2" aria-hidden="true" tabindex="-1"></a>x[x <span class="sc">&gt;</span> <span class="dv">3</span>]</span></code></pre></div>
<pre><code>## [1] 4.2 3.3 5.4</code></pre>
<p>You can combine conditional statements with <code>&amp;</code> (and), <code>|</code> (or), and <code>!</code> (not)</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="tidy_data.html#cb402-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">4.2</span>, <span class="fl">3.3</span>, <span class="fl">5.4</span>)</span>
<span id="cb402-2"><a href="tidy_data.html#cb402-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-3"><a href="tidy_data.html#cb402-3" aria-hidden="true" tabindex="-1"></a><span class="co"># combing two conditional statements with &amp;</span></span>
<span id="cb402-4"><a href="tidy_data.html#cb402-4" aria-hidden="true" tabindex="-1"></a>x <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="tidy_data.html#cb404-1" aria-hidden="true" tabindex="-1"></a>x[x <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1] 4.2 3.3</code></pre>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="tidy_data.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combing two conditional statements with |</span></span>
<span id="cb406-2"><a href="tidy_data.html#cb406-2" aria-hidden="true" tabindex="-1"></a>x <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="dv">5</span></span></code></pre></div>
<pre><code>## [1]  TRUE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="tidy_data.html#cb408-1" aria-hidden="true" tabindex="-1"></a>x[x <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1] 2.1 5.4</code></pre>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="tidy_data.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combining conditional statements with !</span></span>
<span id="cb410-2"><a href="tidy_data.html#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>x <span class="sc">&gt;</span> <span class="dv">5</span></span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="tidy_data.html#cb412-1" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">!</span>x <span class="sc">&gt;</span> <span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1] 2.1 4.2 3.3</code></pre>
<p>Another way to generate implicit conditional statements is using the <code>%in%</code> operator, which works like the <code>in</code> keywords in Python.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="tidy_data.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate implicit logical vectors through the %in% operator</span></span>
<span id="cb414-2"><a href="tidy_data.html#cb414-2" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fl">3.3</span>, <span class="fl">4.2</span>)</span></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="tidy_data.html#cb416-1" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] 2.1 4.2 3.3 5.4</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="tidy_data.html#cb418-1" aria-hidden="true" tabindex="-1"></a>x[x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fl">3.3</span>, <span class="fl">4.2</span>)]</span></code></pre></div>
<pre><code>## [1] 4.2 3.3</code></pre>
</div>
<div id="character-vectors" class="section level5 hasAnchor" number="4.2.5.1.4">
<h5><span class="header-section-number">4.2.5.1.4</span> Character vectors<a href="tidy_data.html#character-vectors" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="tidy_data.html#cb420-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">4.2</span>, <span class="fl">3.3</span>, <span class="fl">5.4</span>)</span>
<span id="cb420-2"><a href="tidy_data.html#cb420-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-3"><a href="tidy_data.html#cb420-3" aria-hidden="true" tabindex="-1"></a><span class="co"># apply names</span></span>
<span id="cb420-4"><a href="tidy_data.html#cb420-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>)</span>
<span id="cb420-5"><a href="tidy_data.html#cb420-5" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>##   a   b   c   d 
## 2.1 4.2 3.3 5.4</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="tidy_data.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset using names</span></span>
<span id="cb422-2"><a href="tidy_data.html#cb422-2" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="st">&quot;d&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;a&quot;</span>)]</span></code></pre></div>
<pre><code>##   d   c   a 
## 5.4 3.3 2.1</code></pre>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="tidy_data.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Like integer indices, you can repeat indices</span></span>
<span id="cb424-2"><a href="tidy_data.html#cb424-2" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>)]</span></code></pre></div>
<pre><code>##   a   a   a 
## 2.1 2.1 2.1</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="tidy_data.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Careful! names are always matched exactly</span></span>
<span id="cb426-2"><a href="tidy_data.html#cb426-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">abc =</span> <span class="dv">1</span>, <span class="at">def =</span> <span class="dv">2</span>)</span>
<span id="cb426-3"><a href="tidy_data.html#cb426-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## abc def 
##   1   2</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="tidy_data.html#cb428-1" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;d&quot;</span>)]</span></code></pre></div>
<pre><code>## &lt;NA&gt; &lt;NA&gt; 
##   NA   NA</code></pre>
<div id="more-on-string-operations" class="section level6 hasAnchor" number="4.2.5.1.4.1">
<h6><span class="header-section-number">4.2.5.1.4.1</span> More on string operations<a href="tidy_data.html#more-on-string-operations" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="tidy_data.html#cb430-1" aria-hidden="true" tabindex="-1"></a>firstName <span class="ot">&lt;-</span> <span class="st">&quot;Jae Yeon&quot;</span></span>
<span id="cb430-2"><a href="tidy_data.html#cb430-2" aria-hidden="true" tabindex="-1"></a>lastName <span class="ot">&lt;-</span> <span class="st">&quot;Kim&quot;</span></span></code></pre></div>
<p>Unlike in Python, R does not have a reserved operator for string concatenation such as <code>+</code>. Furthermore, using the usual concatenation operator <code>c()</code> on two or more character strings will not create a single character string, but rather a <strong>vector</strong> of character strings.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="tidy_data.html#cb431-1" aria-hidden="true" tabindex="-1"></a>fullName <span class="ot">&lt;-</span> <span class="fu">c</span>(firstName, lastName)</span>
<span id="cb431-2"><a href="tidy_data.html#cb431-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb431-3"><a href="tidy_data.html#cb431-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fullName)</span></code></pre></div>
<pre><code>## [1] &quot;Jae Yeon&quot; &quot;Kim&quot;</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="tidy_data.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(fullName)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>To combine two or more character strings into one larger character string, we use the <code>paste()</code> function. This function takes character strings or vectors and collapses their values into a single character string, with each value separated by a character string selected by the user.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="tidy_data.html#cb435-1" aria-hidden="true" tabindex="-1"></a>fullName <span class="ot">&lt;-</span> <span class="fu">paste</span>(firstName, lastName)</span>
<span id="cb435-2"><a href="tidy_data.html#cb435-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-3"><a href="tidy_data.html#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fullName)</span>
<span id="cb435-4"><a href="tidy_data.html#cb435-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-5"><a href="tidy_data.html#cb435-5" aria-hidden="true" tabindex="-1"></a>fullName <span class="ot">&lt;-</span> <span class="fu">paste</span>(firstName, lastName, <span class="at">sep =</span> <span class="st">&quot;+&quot;</span>)</span>
<span id="cb435-6"><a href="tidy_data.html#cb435-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-7"><a href="tidy_data.html#cb435-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fullName)</span>
<span id="cb435-8"><a href="tidy_data.html#cb435-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-9"><a href="tidy_data.html#cb435-9" aria-hidden="true" tabindex="-1"></a>fullName <span class="ot">&lt;-</span> <span class="fu">paste</span>(firstName, lastName, <span class="at">sep =</span> <span class="st">&quot;___&quot;</span>)</span>
<span id="cb435-10"><a href="tidy_data.html#cb435-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fullName)</span></code></pre></div>
<p>As with Python, R can also extract substrings based on the index position of its characters. There are, however, two critical differences. First, <strong>index positions in R start at 1</strong>. This is in contrast to Python, where indexation begins at 0.</p>
<p>Second, <strong>object subsets using index positions in R contain all the elements in the specified range</strong>. If some object called <code>data</code> contains five elements, <code>data[2:4]</code> will return the elements at the second, third, and fourth positions. By contrast, the same subset in Python would return the objects at the third and fourth positions (or second and third positions, depending upon whether your index starts at 0 or 1).</p>
<p>Third, <strong>R does not allow indexing of character strings</strong>*. Instead, you must use the <code>substr()</code> function. Note that this function must receive both the <code>start</code> and <code>stop</code> arguments. So if you want to get all the characters between some index and the end of the string, you must use the <code>nchar()</code> function, which will tell you the length of a character string.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="tidy_data.html#cb436-1" aria-hidden="true" tabindex="-1"></a>fullName <span class="ot">&lt;-</span> <span class="fu">paste</span>(firstName, lastName)</span>
<span id="cb436-2"><a href="tidy_data.html#cb436-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-3"><a href="tidy_data.html#cb436-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this won&#39;t work like in Python</span></span>
<span id="cb436-4"><a href="tidy_data.html#cb436-4" aria-hidden="true" tabindex="-1"></a>fullName[<span class="dv">1</span>] <span class="co"># R sees the string as a unitary object - it can&#39;t be indexed this way</span></span></code></pre></div>
<pre><code>## [1] &quot;Jae Yeon Kim&quot;</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="tidy_data.html#cb438-1" aria-hidden="true" tabindex="-1"></a>fullName[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span></code></pre></div>
<pre><code>## [1] &quot;Jae Yeon Kim&quot; NA             NA             NA</code></pre>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="tidy_data.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># So use this instead</span></span>
<span id="cb440-2"><a href="tidy_data.html#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="at">x =</span> fullName, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Ja&quot;</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="tidy_data.html#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="at">x =</span> fullName, <span class="at">start =</span> <span class="dv">5</span>, <span class="at">stop =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Y&quot;</code></pre>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="tidy_data.html#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="at">x =</span> fullName, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Jae Yeon K&quot;</code></pre>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="tidy_data.html#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="at">x =</span> fullName, <span class="at">start =</span> <span class="dv">11</span>, <span class="at">stop =</span> <span class="fu">nchar</span>(fullName))</span></code></pre></div>
<pre><code>## [1] &quot;im&quot;</code></pre>
<p>Like Python, R has a number of string methods, though these exist as individual rather than “mix-and-match” functions. For example:</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="tidy_data.html#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">toupper</span>(<span class="at">x =</span> fullName)</span></code></pre></div>
<pre><code>## [1] &quot;JAE YEON KIM&quot;</code></pre>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="tidy_data.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tolower</span>(<span class="at">x =</span> fullName)</span></code></pre></div>
<pre><code>## [1] &quot;jae yeon kim&quot;</code></pre>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="tidy_data.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">strsplit</span>(<span class="at">x =</span> fullName, <span class="at">split =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;Jae&quot;  &quot;Yeon&quot; &quot;Kim&quot;</code></pre>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="tidy_data.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">strsplit</span>(<span class="at">x =</span> fullName, <span class="at">split =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;Jae Yeo&quot; &quot; Kim&quot;</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="tidy_data.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;Kim&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;Choi&quot;</span>, <span class="at">x =</span> fullName)</span></code></pre></div>
<pre><code>## [1] &quot;Jae Yeon Choi&quot;</code></pre>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="tidy_data.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot;Jae Yeon&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;Danny&quot;</span>, <span class="at">x =</span> fullName)</span></code></pre></div>
<pre><code>## [1] &quot;Danny Kim&quot;</code></pre>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="tidy_data.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the importance of cases! This doesn&#39;t throw an error, so you won&#39;t realize your function didn&#39;t work unless you double-check several entries.</span></span>
<span id="cb460-2"><a href="tidy_data.html#cb460-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-3"><a href="tidy_data.html#cb460-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&quot; &quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> fullName) <span class="co"># The same function is used for replacements and stripping</span></span></code></pre></div>
<pre><code>## [1] &quot;JaeYeonKim&quot;</code></pre>
</div>
</div>
</div>
<div id="lists-1" class="section level4 hasAnchor" number="4.2.5.2">
<h4><span class="header-section-number">4.2.5.2</span> Lists<a href="tidy_data.html#lists-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Subsetting a list works in the same way as subsetting an atomic vector. Using <code>[</code> will always return a list; <code>[[</code> and <code>$</code>, as described below, let you pull out the list’s components.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="tidy_data.html#cb462-1" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;a&quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;b&quot;</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb462-2"><a href="tidy_data.html#cb462-2" aria-hidden="true" tabindex="-1"></a>l</span></code></pre></div>
<pre><code>## $a
## [1] 1
## 
## $b
## [1] 2</code></pre>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="tidy_data.html#cb464-1" aria-hidden="true" tabindex="-1"></a>l[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## $a
## [1] 1</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="tidy_data.html#cb466-1" aria-hidden="true" tabindex="-1"></a>l[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="tidy_data.html#cb468-1" aria-hidden="true" tabindex="-1"></a>l[<span class="st">&quot;a&quot;</span>]</span></code></pre></div>
<pre><code>## $a
## [1] 1</code></pre>
</div>
<div id="matrices-1" class="section level4 hasAnchor" number="4.2.5.3">
<h4><span class="header-section-number">4.2.5.3</span> Matrices<a href="tidy_data.html#matrices-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The most common way of subsetting matrices (2d) is a simple generalization of 1d subsetting: you supply a 1d index for each dimension, separated by a comma. Blank subsetting is now useful because it lets you keep all rows or all columns.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="tidy_data.html#cb470-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb470-2"><a href="tidy_data.html#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(a) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb470-3"><a href="tidy_data.html#cb470-3" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>##      A B C
## [1,] 1 4 7
## [2,] 2 5 8
## [3,] 3 6 9</code></pre>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="tidy_data.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rows come first, then columns</span></span>
<span id="cb472-2"><a href="tidy_data.html#cb472-2" aria-hidden="true" tabindex="-1"></a>a[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), ]</span></code></pre></div>
<pre><code>##      A B C
## [1,] 1 4 7
## [2,] 2 5 8</code></pre>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="tidy_data.html#cb474-1" aria-hidden="true" tabindex="-1"></a>a[<span class="fu">c</span>(T, F, T), <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;A&quot;</span>)]</span></code></pre></div>
<pre><code>##      B A
## [1,] 4 1
## [2,] 6 3</code></pre>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="tidy_data.html#cb476-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>, <span class="sc">-</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>##      A C</code></pre>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="tidy_data.html#cb478-1" aria-hidden="true" tabindex="-1"></a>a[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="sc">-</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>##      A C
## [1,] 1 7
## [2,] 2 8</code></pre>
</div>
<div id="data-frames" class="section level4 hasAnchor" number="4.2.5.4">
<h4><span class="header-section-number">4.2.5.4</span> Data frames<a href="tidy_data.html#data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Data from data frames can be addressed like matrices (with row and column indicators separated by a comma).</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="tidy_data.html#cb480-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">z =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb480-2"><a href="tidy_data.html#cb480-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   x y z
## 1 4 3 a
## 2 5 2 b
## 3 6 1 c</code></pre>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="tidy_data.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return only the rows where x == 6</span></span>
<span id="cb482-2"><a href="tidy_data.html#cb482-2" aria-hidden="true" tabindex="-1"></a>df[df<span class="sc">$</span>x <span class="sc">==</span> <span class="dv">6</span>, ]</span></code></pre></div>
<pre><code>##   x y z
## 3 6 1 c</code></pre>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="tidy_data.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return the first and third row</span></span>
<span id="cb484-2"><a href="tidy_data.html#cb484-2" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), ]</span></code></pre></div>
<pre><code>##   x y z
## 1 4 3 a
## 3 6 1 c</code></pre>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="tidy_data.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return the first and third row and the first and second column</span></span>
<span id="cb486-2"><a href="tidy_data.html#cb486-2" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]</span></code></pre></div>
<pre><code>##   x y
## 1 4 3
## 3 6 1</code></pre>
<p>Data frames possess both lists and matrices’ characteristics: if you subset with a single vector, they behave like lists and return only the columns.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="tidy_data.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There are two ways to select columns from a data frame</span></span>
<span id="cb488-2"><a href="tidy_data.html#cb488-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Like a list:</span></span>
<span id="cb488-3"><a href="tidy_data.html#cb488-3" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;z&quot;</span>)]</span></code></pre></div>
<pre><code>##   x z
## 1 4 a
## 2 5 b
## 3 6 c</code></pre>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="tidy_data.html#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Like a matrix</span></span>
<span id="cb490-2"><a href="tidy_data.html#cb490-2" aria-hidden="true" tabindex="-1"></a>df[, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;z&quot;</span>)]</span></code></pre></div>
<pre><code>##   x z
## 1 4 a
## 2 5 b
## 3 6 c</code></pre>
<p>But there’s a significant difference when selecting a single column: matrix subsetting simplifies by default, list subsetting does not.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="tidy_data.html#cb492-1" aria-hidden="true" tabindex="-1"></a>(df[<span class="st">&quot;x&quot;</span>])</span></code></pre></div>
<pre><code>##   x
## 1 4
## 2 5
## 3 6</code></pre>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="tidy_data.html#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>((df[<span class="st">&quot;x&quot;</span>]))</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="tidy_data.html#cb496-1" aria-hidden="true" tabindex="-1"></a>(df[, <span class="st">&quot;x&quot;</span>])</span></code></pre></div>
<pre><code>## [1] 4 5 6</code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="tidy_data.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>((df[, <span class="st">&quot;x&quot;</span>]))</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<p>See the bottom section on <a href="#simplify-preserve">Simplying and Preserving to know more</a></p>
</div>
<div id="subsetting-operators" class="section level4 hasAnchor" number="4.2.5.5">
<h4><span class="header-section-number">4.2.5.5</span> Subsetting operators<a href="tidy_data.html#subsetting-operators" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are two other subsetting operators: <code>[[</code> and <code>$</code>.</p>
<ul>
<li><code>[[</code> is similar to <code>[</code>, except it can only return a single value, and it allows you to pull pieces out of a list.</li>
<li><code>$</code> is a useful shorthand for <code>[[</code> combined with character subsetting.</li>
</ul>
<div id="section" class="section level5 hasAnchor" number="4.2.5.5.1">
<h5><span class="header-section-number">4.2.5.5.1</span> <code>[[</code><a href="tidy_data.html#section" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>You need <code>[[</code> when working with lists. When <code>[</code> is applied to a list it always returns a list: it never gives you the list’s contents. To get the contents, you need <code>[[</code>:</p>
<blockquote>
<p>“If list <code>x</code> is a train carrying objects, then <code>x[[5]]</code> is
the object in car 5; <code>x[4:6]</code> is a train of cars 4-6.”</p>
<p>— <span class="citation">(<a href="#ref-RLangTip" role="doc-biblioref"><strong>RLangTip?</strong></a>)</span></p>
</blockquote>
<p>Because data frames are lists of columns, you can use <code>[[</code> to extract a column from data frames:</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="tidy_data.html#cb500-1" aria-hidden="true" tabindex="-1"></a>mtcars</span></code></pre></div>
<pre><code>##                      mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
## Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
## Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
## Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
## Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
## Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="tidy_data.html#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="co"># these two are equivalent</span></span>
<span id="cb502-2"><a href="tidy_data.html#cb502-2" aria-hidden="true" tabindex="-1"></a>mtcars[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>##  [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4
## [16] 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7
## [31] 15.0 21.4</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="tidy_data.html#cb504-1" aria-hidden="true" tabindex="-1"></a>mtcars[, <span class="dv">1</span>]</span></code></pre></div>
<pre><code>##  [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4
## [16] 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7
## [31] 15.0 21.4</code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="tidy_data.html#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="co"># which differs from this:</span></span>
<span id="cb506-2"><a href="tidy_data.html#cb506-2" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>##                      mpg
## Mazda RX4           21.0
## Mazda RX4 Wag       21.0
## Datsun 710          22.8
## Hornet 4 Drive      21.4
## Hornet Sportabout   18.7
## Valiant             18.1
## Duster 360          14.3
## Merc 240D           24.4
## Merc 230            22.8
## Merc 280            19.2
## Merc 280C           17.8
## Merc 450SE          16.4
## Merc 450SL          17.3
## Merc 450SLC         15.2
## Cadillac Fleetwood  10.4
## Lincoln Continental 10.4
## Chrysler Imperial   14.7
## Fiat 128            32.4
## Honda Civic         30.4
## Toyota Corolla      33.9
## Toyota Corona       21.5
## Dodge Challenger    15.5
## AMC Javelin         15.2
## Camaro Z28          13.3
## Pontiac Firebird    19.2
## Fiat X1-9           27.3
## Porsche 914-2       26.0
## Lotus Europa        30.4
## Ford Pantera L      15.8
## Ferrari Dino        19.7
## Maserati Bora       15.0
## Volvo 142E          21.4</code></pre>
</div>
<div id="section-1" class="section level5 hasAnchor" number="4.2.5.5.2">
<h5><span class="header-section-number">4.2.5.5.2</span> <code>$</code><a href="tidy_data.html#section-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><code>$</code> is a shorthand operator, where <code>x$y</code> is equivalent to <code>x[["y", exact = FALSE]]</code>. It’s often used to access variables in a data frame:</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="tidy_data.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># these two are equivalent</span></span>
<span id="cb508-2"><a href="tidy_data.html#cb508-2" aria-hidden="true" tabindex="-1"></a>mtcars[[<span class="st">&quot;cyl&quot;</span>]]</span></code></pre></div>
<pre><code>##  [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="tidy_data.html#cb510-1" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>cyl</span></code></pre></div>
<pre><code>##  [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4</code></pre>
<p>One common mistake with <code>$</code> is to try and use it when you have the name of a column stored in a variable:</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="tidy_data.html#cb512-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="st">&quot;cyl&quot;</span></span>
<span id="cb512-2"><a href="tidy_data.html#cb512-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Doesn&#39;t work - mtcars$var translated to mtcars[[&quot;var&quot;]]</span></span>
<span id="cb512-3"><a href="tidy_data.html#cb512-3" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>var</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="tidy_data.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instead use [[</span></span>
<span id="cb514-2"><a href="tidy_data.html#cb514-2" aria-hidden="true" tabindex="-1"></a>mtcars[[var]]</span></code></pre></div>
<pre><code>##  [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4</code></pre>
</div>
</div>
<div id="subassignment" class="section level4 hasAnchor" number="4.2.5.6">
<h4><span class="header-section-number">4.2.5.6</span> Subassignment<a href="tidy_data.html#subassignment" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>All subsetting operators can be combined with an assignment operator to modify selected values of the input vector.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="tidy_data.html#cb516-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb516-2"><a href="tidy_data.html#cb516-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="tidy_data.html#cb518-1" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb518-2"><a href="tidy_data.html#cb518-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] 2 3 3 4 5</code></pre>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="tidy_data.html#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The length of the LHS needs to match the RHS!</span></span>
<span id="cb520-2"><a href="tidy_data.html#cb520-2" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb520-3"><a href="tidy_data.html#cb520-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] 2 4 3 2 1</code></pre>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="tidy_data.html#cb522-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">1</span></span></code></pre></div>
<pre><code>## Warning in x[1] &lt;- 4:1: number of items to replace is not a multiple of
## replacement length</code></pre>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="tidy_data.html#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is mostly useful when conditionally modifying vectors</span></span>
<span id="cb524-2"><a href="tidy_data.html#cb524-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="cn">NA</span>))</span>
<span id="cb524-3"><a href="tidy_data.html#cb524-3" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##    a
## 1  1
## 2 10
## 3 NA</code></pre>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="tidy_data.html#cb526-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>a[df<span class="sc">$</span>a <span class="sc">&lt;</span> <span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb526-2"><a href="tidy_data.html#cb526-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##    a
## 1  0
## 2 10
## 3 NA</code></pre>
</div>
</div>
</div>
<div id="tidyverse" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Tidyverse<a href="tidy_data.html#tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-big-picture-4" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> The Big Picture<a href="tidy_data.html#the-big-picture-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>“Tidy data sets are easy to manipulate, model and visualize, and have a specific structure: each variable is a column, each observation is a row, and each type of observational unit is a table.” - Hadley Wickham</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>Variables -&gt; <strong>Columns</strong></li>
<li>Observations -&gt; <strong>Rows</strong></li>
<li>Values -&gt; <strong>Cells</strong></li>
</ol>
<div class="figure">
<img src="https://garrettgman.github.io/images/tidy-1.png" alt="" />
<p class="caption">Tidy Data Example (Source: R for Data Science)</p>
</div>
<p>If dataframes are tidy, it’s easy to transform, visualize, model, and program them using tidyverse packages (a whole workflow).</p>
<div class="figure">
<img src="https://miro.medium.com/max/960/0*mlPyX0NE0WQwEzpS.png" alt="" />
<p class="caption">Tidyverse: an opinionated collection of R packages</p>
</div>
<ul>
<li>Nevertheless, don’t be <strong>religious</strong>.</li>
</ul>
<blockquote>
<p>In summary, tidy data is a useful conceptual idea and is often the right way to go for general, small data sets, but may not be appropriate for all problems. - Jeff Leek</p>
</blockquote>
<p>For instance, in many data science applications, linear algebra-based computations are essential (e.g., <a href="https://www.math.upenn.edu/~kazdan/312S13/JJ/PCA-JJ.pdf">Principal Component Analysis</a>). These computations are optimized to work on matrices, not tidy data frames (for more information, read <a href="https://simplystatistics.org/2016/02/17/non-tidy-data/">Jeff Leek’s blog post</a>).</p>
<p>This is what tidy data looks like.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="tidy_data.html#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb528-2"><a href="tidy_data.html#cb528-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-3"><a href="tidy_data.html#cb528-3" aria-hidden="true" tabindex="-1"></a>table1</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<p><strong>Additional tips</strong></p>
<p>There are so many different ways of looking at data in R. Can you discuss the pros and cons of each approach? Which one do you prefer and why?</p>
<ul>
<li><p><code>str(table1)</code></p></li>
<li><p><code>glimpse(table1)</code>: similar to <code>str()</code> cleaner output</p></li>
<li><p><code>skim(table1)</code>: <code>str()</code> + <code>summary()</code> + more</p></li>
<li><p>The big picture</p>
<ul>
<li>Tidying data with <strong>tidyr</strong></li>
<li>Processing data with <strong>dplyr</strong></li>
</ul></li>
</ul>
<p>These two packages don’t do anything new but simplify most common tasks in data manipulation. Plus, they are fast, consistent, and more readable.</p>
<p>Practically, this approach is right because you will have consistency in data format across all the projects you’re working on. Also, tidy data works well with key packages (e.g., <code>dplyr,</code> <code>ggplot2</code>) in R.</p>
<p>Computationally, this approach is useful for vectorized programming because “different variables from the same observation are always paired”. Vectorized means a function applies to a vector that treats each element individually (=operations working in parallel).</p>
</div>
</div>
<div id="tidying-tidyr" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Tidying (tidyr)<a href="tidy_data.html#tidying-tidyr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="reshaping" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Reshaping<a href="tidy_data.html#reshaping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Signs of messy datasets</strong></p>
<ul>
<li><ol style="list-style-type: decimal">
<li>Column headers are values, not variable names.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Multiple variables are not stored in one column.</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Variables are stored in both rows and columns.</li>
</ol></li>
<li><ol start="4" style="list-style-type: decimal">
<li>Multiple types of observational units are stored in the same table.</li>
</ol></li>
<li><ol start="5" style="list-style-type: decimal">
<li>A single observational unit is stored in multiple tables.</li>
</ol></li>
</ul>
<p>Let’s take a look at the cases of untidy data.</p>
<div class="figure">
<img src="https://garrettgman.github.io/images/tidy-5.png" alt="" />
<p class="caption">Messy Data Case 1 (Source: R for Data Science)</p>
</div>
<ul>
<li><p>Make It Longer</p>
<table>
<thead>
<tr class="header">
<th>Col1</th>
<th>Col2</th>
<th>Col3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table></li>
</ul>
<p><strong>Challenge</strong>: Why is this data not tidy?</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="tidy_data.html#cb530-1" aria-hidden="true" tabindex="-1"></a>table4a</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   country     `1999` `2000`
##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
## 1 Afghanistan    745   2666
## 2 Brazil       37737  80488
## 3 China       212258 213766</code></pre>
<ul>
<li>Let’s pivot (rotate by 90 degrees).</li>
</ul>
<div class="figure">
<img src="https://github.com/rstudio/concept-maps/raw/master/en/pivoting.svg" alt="" />
<p class="caption">Concept map for pivoting. By Florian Schmoll, Monica Alonso.</p>
</div>
<ul>
<li><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html"><code>pivot_longer()</code></a> increases the number of rows (longer) and decreases the number of columns. The inverse function is <code>pivot_wider()</code>. These functions improve the usability of <code>gather()</code> and <code>spread()</code>.</li>
</ul>
<div class="figure">
<img src="https://www.storybench.org/wp-content/uploads/2019/08/pivot-longer-image.png" alt="" />
<p class="caption">What pivot_longer() does (Source: <a href="https://www.storybench.org" class="uri">https://www.storybench.org</a>)</p>
</div>
<div class="figure">
<img src="https://education.rstudio.com/blog/2020/09/concept-maps/pipe-operator.png" alt="" />
<p class="caption">Concept map for pipe operator. By Jeroen Janssens, Monica Alonso.</p>
</div>
<ul>
<li>The pipe operator <code>%&gt;%</code> originally comes from the <code>magrittr</code> package. The idea behind the pipe operator is <a href="https://www.datacamp.com/community/tutorials/pipe-r-tutorial">similar to</a> what we learned about chaining functions in high school. f: B -&gt; C and g: A -&gt; B can be expressed as <span class="math inline">\(f(g(x))\)</span>. The pipe operator chains operations. When reading the pipe operator, read as “and then” (Wickham’s recommendation). The keyboard shortcut is ctrl + shift + M. The key idea here is not creating temporary variables and focusing on verbs (functions). We’ll learn more about this functional programming paradigm later on.</li>
</ul>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="tidy_data.html#cb532-1" aria-hidden="true" tabindex="-1"></a>table4a</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   country     `1999` `2000`
##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
## 1 Afghanistan    745   2666
## 2 Brazil       37737  80488
## 3 China       212258 213766</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="tidy_data.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Old way, less intuitive</span></span>
<span id="cb534-2"><a href="tidy_data.html#cb534-2" aria-hidden="true" tabindex="-1"></a>table4a <span class="sc">%&gt;%</span></span>
<span id="cb534-3"><a href="tidy_data.html#cb534-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(</span>
<span id="cb534-4"><a href="tidy_data.html#cb534-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">key =</span> <span class="st">&quot;year&quot;</span>, <span class="co"># Current column names</span></span>
<span id="cb534-5"><a href="tidy_data.html#cb534-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="st">&quot;cases&quot;</span>, <span class="co"># The values matched to cases</span></span>
<span id="cb534-6"><a href="tidy_data.html#cb534-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;1999&quot;</span>, <span class="st">&quot;2000&quot;</span>)</span>
<span id="cb534-7"><a href="tidy_data.html#cb534-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># Selected columns</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   country     year   cases
##   &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
## 1 Afghanistan 1999     745
## 2 Brazil      1999   37737
## 3 China       1999  212258
## 4 Afghanistan 2000    2666
## 5 Brazil      2000   80488
## 6 China       2000  213766</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="tidy_data.html#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New way, more intuitive</span></span>
<span id="cb536-2"><a href="tidy_data.html#cb536-2" aria-hidden="true" tabindex="-1"></a>table4a <span class="sc">%&gt;%</span></span>
<span id="cb536-3"><a href="tidy_data.html#cb536-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb536-4"><a href="tidy_data.html#cb536-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;1999&quot;</span>, <span class="st">&quot;2000&quot;</span>), <span class="co"># Selected columns</span></span>
<span id="cb536-5"><a href="tidy_data.html#cb536-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="co"># Shorter columns (the columns going to be in one column called year)</span></span>
<span id="cb536-6"><a href="tidy_data.html#cb536-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;cases&quot;</span></span>
<span id="cb536-7"><a href="tidy_data.html#cb536-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># Longer rows (the values are going to be in a separate column called named cases)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   country     year   cases
##   &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;
## 1 Afghanistan 1999     745
## 2 Afghanistan 2000    2666
## 3 Brazil      1999   37737
## 4 Brazil      2000   80488
## 5 China       1999  212258
## 6 China       2000  213766</code></pre>
<ul>
<li><p>There’s another problem, did you catch it?</p></li>
<li><p>The data type of <code>year</code> variable should be <code>numeric</code> not <code>character</code>. By default, <code>pivot_longer()</code> transforms uninformative columns to character.</p></li>
<li><p>You can fix this problem by using <code>names_transform</code> argument.</p></li>
</ul>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="tidy_data.html#cb538-1" aria-hidden="true" tabindex="-1"></a>table4a <span class="sc">%&gt;%</span></span>
<span id="cb538-2"><a href="tidy_data.html#cb538-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb538-3"><a href="tidy_data.html#cb538-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;1999&quot;</span>, <span class="st">&quot;2000&quot;</span>), <span class="co"># Put two columns together</span></span>
<span id="cb538-4"><a href="tidy_data.html#cb538-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="co"># Shorter columns (the columns going to be in one column called year)</span></span>
<span id="cb538-5"><a href="tidy_data.html#cb538-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;cases&quot;</span>, <span class="co"># Longer rows (the values are going to be in a separate column called named cases)</span></span>
<span id="cb538-6"><a href="tidy_data.html#cb538-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">year =</span> readr<span class="sc">::</span>parse_number)</span>
<span id="cb538-7"><a href="tidy_data.html#cb538-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># Transform the variable</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   country      year  cases
##   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;
## 1 Afghanistan  1999    745
## 2 Afghanistan  2000   2666
## 3 Brazil       1999  37737
## 4 Brazil       2000  80488
## 5 China        1999 212258
## 6 China        2000 213766</code></pre>
<p><strong>Additional tips</strong></p>
<p><code>parse_number()</code> also keeps only numeric information in a variable.</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="tidy_data.html#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_number</span>(<span class="st">&quot;reply1994&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 1994</code></pre>
<p>A flat file (e.g., CSV) is a rectangular shaped combination of strings. <a href="https://cran.r-project.org/web/packages/readr/vignettes/readr.html">Parsing</a> determines the type of each column and turns into a vector of a more specific type. Tidyverse has <code>parse_</code> functions (from <code>readr</code> package) that are flexible and fast (e.g., <code>parse_integer()</code>, <code>parse_double()</code>, <code>parse_logical()</code>, <code>parse_datetime()</code>, <code>parse_date()</code>, <code>parse_time()</code>, <code>parse_factor()</code>, etc).</p>
<ul>
<li>Let’s do another practice.</li>
</ul>
<p><strong>Challenge</strong></p>
<ol style="list-style-type: decimal">
<li>Why is this data not tidy? (This exercise comes from <a href="https://tidyr.tidyverse.org/articles/pivot.html"><code>pivot</code> function vigenette</a>.) Too long or too wide?</li>
</ol>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="tidy_data.html#cb542-1" aria-hidden="true" tabindex="-1"></a>billboard</span></code></pre></div>
<pre><code>## # A tibble: 317 × 79
##    artist     track date.entered   wk1   wk2   wk3   wk4   wk5   wk6   wk7   wk8
##    &lt;chr&gt;      &lt;chr&gt; &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 2 Pac      Baby… 2000-02-26      87    82    72    77    87    94    99    NA
##  2 2Ge+her    The … 2000-09-02      91    87    92    NA    NA    NA    NA    NA
##  3 3 Doors D… Kryp… 2000-04-08      81    70    68    67    66    57    54    53
##  4 3 Doors D… Loser 2000-10-21      76    76    72    69    67    65    55    59
##  5 504 Boyz   Wobb… 2000-04-15      57    34    25    17    17    31    36    49
##  6 98^0       Give… 2000-08-19      51    39    34    26    26    19     2     2
##  7 A*Teens    Danc… 2000-07-08      97    97    96    95   100    NA    NA    NA
##  8 Aaliyah    I Do… 2000-01-29      84    62    51    41    38    35    35    38
##  9 Aaliyah    Try … 2000-03-18      59    53    38    28    21    18    16    14
## 10 Adams, Yo… Open… 2000-08-26      76    76    74    69    68    67    61    58
## # ℹ 307 more rows
## # ℹ 68 more variables: wk9 &lt;dbl&gt;, wk10 &lt;dbl&gt;, wk11 &lt;dbl&gt;, wk12 &lt;dbl&gt;,
## #   wk13 &lt;dbl&gt;, wk14 &lt;dbl&gt;, wk15 &lt;dbl&gt;, wk16 &lt;dbl&gt;, wk17 &lt;dbl&gt;, wk18 &lt;dbl&gt;,
## #   wk19 &lt;dbl&gt;, wk20 &lt;dbl&gt;, wk21 &lt;dbl&gt;, wk22 &lt;dbl&gt;, wk23 &lt;dbl&gt;, wk24 &lt;dbl&gt;,
## #   wk25 &lt;dbl&gt;, wk26 &lt;dbl&gt;, wk27 &lt;dbl&gt;, wk28 &lt;dbl&gt;, wk29 &lt;dbl&gt;, wk30 &lt;dbl&gt;,
## #   wk31 &lt;dbl&gt;, wk32 &lt;dbl&gt;, wk33 &lt;dbl&gt;, wk34 &lt;dbl&gt;, wk35 &lt;dbl&gt;, wk36 &lt;dbl&gt;,
## #   wk37 &lt;dbl&gt;, wk38 &lt;dbl&gt;, wk39 &lt;dbl&gt;, wk40 &lt;dbl&gt;, wk41 &lt;dbl&gt;, wk42 &lt;dbl&gt;, …</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>How can you fix it? Which pivot?</li>
</ol>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="tidy_data.html#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Old way</span></span>
<span id="cb544-2"><a href="tidy_data.html#cb544-2" aria-hidden="true" tabindex="-1"></a>billboard <span class="sc">%&gt;%</span></span>
<span id="cb544-3"><a href="tidy_data.html#cb544-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(</span>
<span id="cb544-4"><a href="tidy_data.html#cb544-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">key =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb544-5"><a href="tidy_data.html#cb544-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="st">&quot;rank&quot;</span>,</span>
<span id="cb544-6"><a href="tidy_data.html#cb544-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">starts_with</span>(<span class="st">&quot;wk&quot;</span>)</span>
<span id="cb544-7"><a href="tidy_data.html#cb544-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="co"># Use regular expressions</span></span>
<span id="cb544-8"><a href="tidy_data.html#cb544-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="co"># Drop NAs</span></span></code></pre></div>
<pre><code>## # A tibble: 5,307 × 5
##    artist         track                   date.entered week   rank
##    &lt;chr&gt;          &lt;chr&gt;                   &lt;date&gt;       &lt;chr&gt; &lt;dbl&gt;
##  1 2 Pac          Baby Don&#39;t Cry (Keep... 2000-02-26   wk1      87
##  2 2Ge+her        The Hardest Part Of ... 2000-09-02   wk1      91
##  3 3 Doors Down   Kryptonite              2000-04-08   wk1      81
##  4 3 Doors Down   Loser                   2000-10-21   wk1      76
##  5 504 Boyz       Wobble Wobble           2000-04-15   wk1      57
##  6 98^0           Give Me Just One Nig... 2000-08-19   wk1      51
##  7 A*Teens        Dancing Queen           2000-07-08   wk1      97
##  8 Aaliyah        I Don&#39;t Wanna           2000-01-29   wk1      84
##  9 Aaliyah        Try Again               2000-03-18   wk1      59
## 10 Adams, Yolanda Open My Heart           2000-08-26   wk1      76
## # ℹ 5,297 more rows</code></pre>
<ul>
<li>Note that <code>pivot_longer()</code> is more versatile than <code>gather()</code>.</li>
</ul>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="tidy_data.html#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New way</span></span>
<span id="cb546-2"><a href="tidy_data.html#cb546-2" aria-hidden="true" tabindex="-1"></a>billboard <span class="sc">%&gt;%</span></span>
<span id="cb546-3"><a href="tidy_data.html#cb546-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb546-4"><a href="tidy_data.html#cb546-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;wk&quot;</span>), <span class="co"># Use regular expressions</span></span>
<span id="cb546-5"><a href="tidy_data.html#cb546-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;week&quot;</span>,</span>
<span id="cb546-6"><a href="tidy_data.html#cb546-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;rank&quot;</span>,</span>
<span id="cb546-7"><a href="tidy_data.html#cb546-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_drop_na =</span> <span class="cn">TRUE</span> <span class="co"># Drop NAs</span></span>
<span id="cb546-8"><a href="tidy_data.html#cb546-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5,307 × 5
##    artist  track                   date.entered week   rank
##    &lt;chr&gt;   &lt;chr&gt;                   &lt;date&gt;       &lt;chr&gt; &lt;dbl&gt;
##  1 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk1      87
##  2 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk2      82
##  3 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk3      72
##  4 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk4      77
##  5 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk5      87
##  6 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk6      94
##  7 2 Pac   Baby Don&#39;t Cry (Keep... 2000-02-26   wk7      99
##  8 2Ge+her The Hardest Part Of ... 2000-09-02   wk1      91
##  9 2Ge+her The Hardest Part Of ... 2000-09-02   wk2      87
## 10 2Ge+her The Hardest Part Of ... 2000-09-02   wk3      92
## # ℹ 5,297 more rows</code></pre>
<ul>
<li><p>Make It Wider</p></li>
<li><p>Why is this data not tidy?</p></li>
</ul>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="tidy_data.html#cb548-1" aria-hidden="true" tabindex="-1"></a>table2</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
##    country      year type            count
##    &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
##  1 Afghanistan  1999 cases             745
##  2 Afghanistan  1999 population   19987071
##  3 Afghanistan  2000 cases            2666
##  4 Afghanistan  2000 population   20595360
##  5 Brazil       1999 cases           37737
##  6 Brazil       1999 population  172006362
##  7 Brazil       2000 cases           80488
##  8 Brazil       2000 population  174504898
##  9 China        1999 cases          212258
## 10 China        1999 population 1272915272
## 11 China        2000 cases          213766
## 12 China        2000 population 1280428583</code></pre>
<ul>
<li><p>Each observation is spread across two rows.</p></li>
<li><p>How can you fix it?: <code>pivot_wider()</code>.</p></li>
</ul>
<p><strong>Two differences between <code>pivot_longer()</code> and <code>pivot_wider()</code></strong></p>
<ul>
<li><p>In <code>pivot_longer()</code>, the arguments are named <code>names_to</code> and <code>values_to</code> (<em>to</em>).</p></li>
<li><p>In <code>pivot_wider()</code>, this pattern is opposite. The arguments are named <code>names_from</code> and <code>values_from</code> (<em>from</em>).</p></li>
<li><p>The number of required arguments for <code>pivot_longer()</code> is 3 (col, names_to, values_to).</p></li>
<li><p>The number of required arguments for <code>pivot_wider()</code> is 2 (names_from, values_from).</p></li>
</ul>
<div class="figure">
<img src="https://www.storybench.org/wp-content/uploads/2019/08/pivot-wider-image.png" alt="" />
<p class="caption">What pivot_wider() does (Source: <a href="https://www.storybench.org" class="uri">https://www.storybench.org</a>)</p>
</div>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="tidy_data.html#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Old way</span></span>
<span id="cb550-2"><a href="tidy_data.html#cb550-2" aria-hidden="true" tabindex="-1"></a>table2 <span class="sc">%&gt;%</span></span>
<span id="cb550-3"><a href="tidy_data.html#cb550-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(</span>
<span id="cb550-4"><a href="tidy_data.html#cb550-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">key =</span> type,</span>
<span id="cb550-5"><a href="tidy_data.html#cb550-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> count</span>
<span id="cb550-6"><a href="tidy_data.html#cb550-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="tidy_data.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New way</span></span>
<span id="cb552-2"><a href="tidy_data.html#cb552-2" aria-hidden="true" tabindex="-1"></a>table2 <span class="sc">%&gt;%</span></span>
<span id="cb552-3"><a href="tidy_data.html#cb552-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb552-4"><a href="tidy_data.html#cb552-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> type, <span class="co"># first</span></span>
<span id="cb552-5"><a href="tidy_data.html#cb552-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> count <span class="co"># second</span></span>
<span id="cb552-6"><a href="tidy_data.html#cb552-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<p>Sometimes, a consultee came to me and asked: “I don’t have missing values in my original dataframe. Then R said that I had missing values after doing some data transformations. What happened?”</p>
<p>Here’s an answer.</p>
<p>R defines missing values in two ways.</p>
<ul>
<li><p><em>Implicit missing values</em>: simply not present in the data.</p></li>
<li><p><em>Explicit missing values</em>: flagged with NA</p></li>
</ul>
<p><strong>Challenge</strong></p>
<p>The example comes from <a href="https://r4ds.had.co.nz/tidy-data.html"><em>R for Data Science</em></a>.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="tidy_data.html#cb554-1" aria-hidden="true" tabindex="-1"></a>stocks <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb554-2"><a href="tidy_data.html#cb554-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">2019</span>, <span class="dv">2019</span>, <span class="dv">2019</span>, <span class="dv">2020</span>, <span class="dv">2020</span>, <span class="dv">2020</span>),</span>
<span id="cb554-3"><a href="tidy_data.html#cb554-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">qtr =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb554-4"><a href="tidy_data.html#cb554-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">return =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb554-5"><a href="tidy_data.html#cb554-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb554-6"><a href="tidy_data.html#cb554-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-7"><a href="tidy_data.html#cb554-7" aria-hidden="true" tabindex="-1"></a>stocks</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##    year   qtr return
##   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1  2019     1      1
## 2  2019     2      2
## 3  2019     3      3
## 4  2020     2     NA
## 5  2020     3      2
## 6  2020     4      3</code></pre>
<ul>
<li><p>Where is the explicit missing value?</p></li>
<li><p>Does <code>stocks</code> have implicit missing values?</p></li>
</ul>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="tidy_data.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="co"># implicit missing values become explicit</span></span>
<span id="cb556-2"><a href="tidy_data.html#cb556-2" aria-hidden="true" tabindex="-1"></a>stocks <span class="sc">%&gt;%</span></span>
<span id="cb556-3"><a href="tidy_data.html#cb556-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb556-4"><a href="tidy_data.html#cb556-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> year,</span>
<span id="cb556-5"><a href="tidy_data.html#cb556-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> return</span>
<span id="cb556-6"><a href="tidy_data.html#cb556-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##     qtr `2019` `2020`
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1     1      1     NA
## 2     2      2     NA
## 3     3      3      2
## 4     4     NA      3</code></pre>
<p><strong>Challenge</strong></p>
<ul>
<li><p>This exercise comes from <a href="https://tidyr.tidyverse.org/articles/pivot.html"><code>pivot</code> function vigenette</a>.</p></li>
<li><p>Could you make <code>station</code> a series of dummy variables using <code>pivot_wider()</code>?</p></li>
</ul>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="tidy_data.html#cb558-1" aria-hidden="true" tabindex="-1"></a>fish_encounters</span></code></pre></div>
<pre><code>## # A tibble: 114 × 3
##    fish  station  seen
##    &lt;fct&gt; &lt;fct&gt;   &lt;int&gt;
##  1 4842  Release     1
##  2 4842  I80_1       1
##  3 4842  Lisbon      1
##  4 4842  Rstr        1
##  5 4842  Base_TD     1
##  6 4842  BCE         1
##  7 4842  BCW         1
##  8 4842  BCE2        1
##  9 4842  BCW2        1
## 10 4842  MAE         1
## # ℹ 104 more rows</code></pre>
<ol style="list-style-type: decimal">
<li><p>Which pivot should you use?</p></li>
<li><p>Are there explicit missing values?</p></li>
<li><p>How could you turn these NAs into 0s? Check <code>values_fill</code> argument in the <code>pivot_wider()</code> function.</p></li>
</ol>
<ul>
<li>Separate</li>
</ul>
<div class="figure">
<img src="https://garrettgman.github.io/images/tidy-6.png" alt="" />
<p class="caption">Messy Data Case 2 (Source: R for Data Science)</p>
</div>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="tidy_data.html#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Toy example</span></span>
<span id="cb560-2"><a href="tidy_data.html#cb560-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">&quot;Dad.apple&quot;</span>, <span class="st">&quot;Mom.orange&quot;</span>, <span class="st">&quot;Daughter.banana&quot;</span>))</span>
<span id="cb560-3"><a href="tidy_data.html#cb560-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-4"><a href="tidy_data.html#cb560-4" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##                 x
## 1            &lt;NA&gt;
## 2       Dad.apple
## 3      Mom.orange
## 4 Daughter.banana</code></pre>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="tidy_data.html#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate</span></span>
<span id="cb562-2"><a href="tidy_data.html#cb562-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb562-3"><a href="tidy_data.html#cb562-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(x, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;Name&quot;</span>, <span class="st">&quot;Preferred_fruit&quot;</span>))</span></code></pre></div>
<pre><code>##       Name Preferred_fruit
## 1     &lt;NA&gt;            &lt;NA&gt;
## 2      Dad           apple
## 3      Mom          orange
## 4 Daughter          banana</code></pre>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="tidy_data.html#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Don&#39;t need the first variable</span></span>
<span id="cb564-2"><a href="tidy_data.html#cb564-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb564-3"><a href="tidy_data.html#cb564-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb564-4"><a href="tidy_data.html#cb564-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(x, <span class="at">into =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">&quot;Preferred_fruit&quot;</span>))</span></code></pre></div>
<pre><code>##   Preferred_fruit
## 1            &lt;NA&gt;
## 2           apple
## 3          orange
## 4          banana</code></pre>
<p><strong>Practice</strong></p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="tidy_data.html#cb566-1" aria-hidden="true" tabindex="-1"></a>table3</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   country      year rate             
##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
## 1 Afghanistan  1999 745/19987071     
## 2 Afghanistan  2000 2666/20595360    
## 3 Brazil       1999 37737/172006362  
## 4 Brazil       2000 80488/174504898  
## 5 China        1999 212258/1272915272
## 6 China        2000 213766/1280428583</code></pre>
<ul>
<li>Note <code>sep</code> argument. You can specify how to separate joined values.</li>
</ul>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="tidy_data.html#cb568-1" aria-hidden="true" tabindex="-1"></a>table3 <span class="sc">%&gt;%</span></span>
<span id="cb568-2"><a href="tidy_data.html#cb568-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(rate,</span>
<span id="cb568-3"><a href="tidy_data.html#cb568-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>),</span>
<span id="cb568-4"><a href="tidy_data.html#cb568-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;/&quot;</span></span>
<span id="cb568-5"><a href="tidy_data.html#cb568-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   country      year cases  population
##   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
## 1 Afghanistan  1999 745    19987071  
## 2 Afghanistan  2000 2666   20595360  
## 3 Brazil       1999 37737  172006362 
## 4 Brazil       2000 80488  174504898 
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<ul>
<li>Note <code>convert</code> argument. You can specify whether automatically convert the new values or not.</li>
</ul>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="tidy_data.html#cb570-1" aria-hidden="true" tabindex="-1"></a>table3 <span class="sc">%&gt;%</span></span>
<span id="cb570-2"><a href="tidy_data.html#cb570-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(rate,</span>
<span id="cb570-3"><a href="tidy_data.html#cb570-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>),</span>
<span id="cb570-4"><a href="tidy_data.html#cb570-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>,</span>
<span id="cb570-5"><a href="tidy_data.html#cb570-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">convert =</span> <span class="cn">TRUE</span></span>
<span id="cb570-6"><a href="tidy_data.html#cb570-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># cases and population become integers</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<ul>
<li>Unite</li>
</ul>
<p><code>pivot_longer()</code> &lt;-&gt; <code>pivot_wider()</code></p>
<p><code>separate()</code> &lt;-&gt; <code>unite()</code></p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="tidy_data.html#cb572-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a toy example</span></span>
<span id="cb572-2"><a href="tidy_data.html#cb572-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb572-3"><a href="tidy_data.html#cb572-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Jae&quot;</span>, <span class="st">&quot;Sun&quot;</span>, <span class="st">&quot;Jane&quot;</span>, <span class="cn">NA</span>),</span>
<span id="cb572-4"><a href="tidy_data.html#cb572-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">birthmonth =</span> <span class="fu">c</span>(<span class="st">&quot;April&quot;</span>, <span class="st">&quot;April&quot;</span>, <span class="st">&quot;June&quot;</span>, <span class="cn">NA</span>)</span>
<span id="cb572-5"><a href="tidy_data.html#cb572-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb572-6"><a href="tidy_data.html#cb572-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-7"><a href="tidy_data.html#cb572-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Include missing values</span></span>
<span id="cb572-8"><a href="tidy_data.html#cb572-8" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">unite</span>(</span>
<span id="cb572-9"><a href="tidy_data.html#cb572-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;contact&quot;</span>,</span>
<span id="cb572-10"><a href="tidy_data.html#cb572-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;birthmonth&quot;</span>)</span>
<span id="cb572-11"><a href="tidy_data.html#cb572-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##     contact
## 1 Jae_April
## 2 Sun_April
## 3 Jane_June
## 4     NA_NA</code></pre>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="tidy_data.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do not include missing values</span></span>
<span id="cb574-2"><a href="tidy_data.html#cb574-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">unite</span>(<span class="st">&quot;contact&quot;</span>,</span>
<span id="cb574-3"><a href="tidy_data.html#cb574-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;birthmonth&quot;</span>),</span>
<span id="cb574-4"><a href="tidy_data.html#cb574-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb574-5"><a href="tidy_data.html#cb574-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##     contact
## 1 Jae_April
## 2 Sun_April
## 3 Jane_June
## 4</code></pre>
</div>
<div id="filling" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Filling<a href="tidy_data.html#filling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a relatively less-known function of the tidyr package. However, I found this function super useful to complete time-series data. For instance, how can you replace NA in the following example (this use case is drawn from the <a href="https://tidyr.tidyverse.org/reference/fill.html">tidyr package vignette</a>.)?</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="tidy_data.html#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb576-2"><a href="tidy_data.html#cb576-2" aria-hidden="true" tabindex="-1"></a>stock <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb576-3"><a href="tidy_data.html#cb576-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>quarter, <span class="sc">~</span>year, <span class="sc">~</span>stock_price,</span>
<span id="cb576-4"><a href="tidy_data.html#cb576-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Q1&quot;</span>, <span class="dv">2000</span>, <span class="dv">10000</span>,</span>
<span id="cb576-5"><a href="tidy_data.html#cb576-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Q2&quot;</span>, <span class="cn">NA</span>, <span class="dv">10001</span>, <span class="co"># Replace NA with 2000</span></span>
<span id="cb576-6"><a href="tidy_data.html#cb576-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Q3&quot;</span>, <span class="cn">NA</span>, <span class="dv">10002</span>, <span class="co"># Replace NA with 2000</span></span>
<span id="cb576-7"><a href="tidy_data.html#cb576-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Q4&quot;</span>, <span class="cn">NA</span>, <span class="dv">10003</span>, <span class="co"># Replace NA with 2000</span></span>
<span id="cb576-8"><a href="tidy_data.html#cb576-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Q1&quot;</span>, <span class="dv">2001</span>, <span class="dv">10004</span>,</span>
<span id="cb576-9"><a href="tidy_data.html#cb576-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Q2&quot;</span>, <span class="cn">NA</span>, <span class="dv">10005</span>, <span class="co"># Replace NA with 2001</span></span>
<span id="cb576-10"><a href="tidy_data.html#cb576-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Q3&quot;</span>, <span class="cn">NA</span>, <span class="dv">10006</span>, <span class="co"># Replace NA with 2001</span></span>
<span id="cb576-11"><a href="tidy_data.html#cb576-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Q4&quot;</span>, <span class="cn">NA</span>, <span class="dv">10007</span>, <span class="co"># Replace NA with 2001</span></span>
<span id="cb576-12"><a href="tidy_data.html#cb576-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb576-13"><a href="tidy_data.html#cb576-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb576-14"><a href="tidy_data.html#cb576-14" aria-hidden="true" tabindex="-1"></a><span class="fu">fill</span>(stock, year)</span></code></pre></div>
<pre><code>## # A tibble: 8 × 3
##   quarter  year stock_price
##   &lt;chr&gt;   &lt;dbl&gt;       &lt;dbl&gt;
## 1 Q1       2000       10000
## 2 Q2       2000       10001
## 3 Q3       2000       10002
## 4 Q4       2000       10003
## 5 Q1       2001       10004
## 6 Q2       2001       10005
## 7 Q3       2001       10006
## 8 Q4       2001       10007</code></pre>
<p>Let’s take a slightly more complex example.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="tidy_data.html#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb578-2"><a href="tidy_data.html#cb578-2" aria-hidden="true" tabindex="-1"></a>yelp_rate <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb578-3"><a href="tidy_data.html#cb578-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>neighborhood, <span class="sc">~</span>restraurant_type, <span class="sc">~</span>popularity_rate,</span>
<span id="cb578-4"><a href="tidy_data.html#cb578-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;N1&quot;</span>, <span class="st">&quot;Chinese&quot;</span>, <span class="dv">5</span>,</span>
<span id="cb578-5"><a href="tidy_data.html#cb578-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;N2&quot;</span>, <span class="cn">NA</span>, <span class="dv">4</span>,</span>
<span id="cb578-6"><a href="tidy_data.html#cb578-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;N3&quot;</span>, <span class="cn">NA</span>, <span class="dv">3</span>,</span>
<span id="cb578-7"><a href="tidy_data.html#cb578-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;N4&quot;</span>, <span class="cn">NA</span>, <span class="dv">2</span>,</span>
<span id="cb578-8"><a href="tidy_data.html#cb578-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;N1&quot;</span>, <span class="st">&quot;Indian&quot;</span>, <span class="dv">1</span>,</span>
<span id="cb578-9"><a href="tidy_data.html#cb578-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;N2&quot;</span>, <span class="cn">NA</span>, <span class="dv">2</span>,</span>
<span id="cb578-10"><a href="tidy_data.html#cb578-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;N3&quot;</span>, <span class="cn">NA</span>, <span class="dv">3</span>,</span>
<span id="cb578-11"><a href="tidy_data.html#cb578-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;N4&quot;</span>, <span class="cn">NA</span>, <span class="dv">4</span>,</span>
<span id="cb578-12"><a href="tidy_data.html#cb578-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;N1&quot;</span>, <span class="st">&quot;Mexican&quot;</span>, <span class="dv">5</span></span>
<span id="cb578-13"><a href="tidy_data.html#cb578-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb578-14"><a href="tidy_data.html#cb578-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-15"><a href="tidy_data.html#cb578-15" aria-hidden="true" tabindex="-1"></a><span class="fu">fill</span>(yelp_rate, restraurant_type) <span class="co"># default is direction = .down</span></span></code></pre></div>
<pre><code>## # A tibble: 9 × 3
##   neighborhood restraurant_type popularity_rate
##   &lt;chr&gt;        &lt;chr&gt;                      &lt;dbl&gt;
## 1 N1           Chinese                        5
## 2 N2           Chinese                        4
## 3 N3           Chinese                        3
## 4 N4           Chinese                        2
## 5 N1           Indian                         1
## 6 N2           Indian                         2
## 7 N3           Indian                         3
## 8 N4           Indian                         4
## 9 N1           Mexican                        5</code></pre>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="tidy_data.html#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fill</span>(yelp_rate, restraurant_type, <span class="at">.direction =</span> <span class="st">&quot;up&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 3
##   neighborhood restraurant_type popularity_rate
##   &lt;chr&gt;        &lt;chr&gt;                      &lt;dbl&gt;
## 1 N1           Chinese                        5
## 2 N2           Indian                         4
## 3 N3           Indian                         3
## 4 N4           Indian                         2
## 5 N1           Indian                         1
## 6 N2           Mexican                        2
## 7 N3           Mexican                        3
## 8 N4           Mexican                        4
## 9 N1           Mexican                        5</code></pre>
</div>
</div>
<div id="manipulating-dplyr" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Manipulating (dplyr)<a href="tidy_data.html#manipulating-dplyr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="figure">
<img src="https://education.rstudio.com/blog/2020/09/concept-maps/dplyr.png" alt="" />
<p class="caption">Concept map for dplyr. By Monica Alonso, Greg Wilson.</p>
</div>
<p><code>dplyr</code> is better than the base R approaches to data processing:</p>
<ul>
<li>fast to run (due to the C++ backed) and intuitive to type</li>
<li>works well with tidy data and databases (thanks to <a href="https://dbplyr.tidyverse.org/"><code>dbplyr</code></a>)</li>
</ul>
<div id="rearranging" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Rearranging<a href="tidy_data.html#rearranging" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Arrange</p></li>
<li><p>Order rows</p></li>
</ul>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="tidy_data.html#cb582-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">arrange</span>(mtcars, mpg) <span class="co"># Low to High (default)</span></span></code></pre></div>
<pre><code>##                      mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
## Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
## Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
## Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
## Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
## Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1</code></pre>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="tidy_data.html#cb584-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">arrange</span>(mtcars, <span class="fu">desc</span>(mpg)) <span class="co"># High to Row</span></span></code></pre></div>
<pre><code>##                      mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
## Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
## Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
## Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
## Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
## Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4</code></pre>
<ul>
<li><p>Rename</p></li>
<li><p>Rename columns</p></li>
</ul>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="tidy_data.html#cb586-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">2011</span>, <span class="dv">2012</span>, <span class="dv">2013</span>))</span>
<span id="cb586-2"><a href="tidy_data.html#cb586-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb586-3"><a href="tidy_data.html#cb586-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb586-4"><a href="tidy_data.html#cb586-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb586-5"><a href="tidy_data.html#cb586-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="co"># NEW name</span></span>
<span id="cb586-6"><a href="tidy_data.html#cb586-6" aria-hidden="true" tabindex="-1"></a>      y</span>
<span id="cb586-7"><a href="tidy_data.html#cb586-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># OLD name</span></span></code></pre></div>
<pre><code>## # A tibble: 3 × 1
##    Year
##   &lt;dbl&gt;
## 1  2011
## 2  2012
## 3  2013</code></pre>
</div>
<div id="subset-observations-rows" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Subset observations (rows)<a href="tidy_data.html#subset-observations-rows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Choose row by logical condition</p></li>
<li><p>Single condition</p></li>
</ul>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="tidy_data.html#cb588-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb588-2"><a href="tidy_data.html#cb588-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">&quot;feminine&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb588-3"><a href="tidy_data.html#cb588-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(height))</span></code></pre></div>
<pre><code>## # A tibble: 17 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Taun We     213  NA   none       grey       black             NA fema… femin…
##  2 Adi Gal…    184  50   none       dark       blue              NA fema… femin…
##  3 Ayla Se…    178  55   none       blue       hazel             48 fema… femin…
##  4 Shaak Ti    178  57   none       red, blue… black             NA fema… femin…
##  5 Luminar…    170  56.2 black      yellow     blue              58 fema… femin…
##  6 Zam Wes…    168  55   blonde     fair, gre… yellow            NA fema… femin…
##  7 Jocasta…    167  NA   white      fair       blue              NA fema… femin…
##  8 Barriss…    166  50   black      yellow     blue              40 fema… femin…
##  9 Beru Wh…    165  75   brown      light      blue              47 fema… femin…
## 10 Dormé       165  NA   brown      light      brown             NA fema… femin…
## 11 Padmé A…    165  45   brown      light      brown             46 fema… femin…
## 12 Shmi Sk…    163  NA   black      fair       brown             72 fema… femin…
## 13 Cordé       157  NA   brown      light      brown             NA fema… femin…
## 14 Leia Or…    150  49   brown      light      brown             19 fema… femin…
## 15 Mon Mot…    150  NA   auburn     fair       blue              48 fema… femin…
## 16 R4-P17       96  NA   none       silver, r… red, blue         NA none  femin…
## 17 Rey          NA  NA   brown      light      hazel             NA fema… femin…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<p>The following filtering example was inspired by <a href="https://suzan.rbind.io/2018/02/dplyr-tutorial-3/">the suzanbert’s dplyr blog post</a>.</p>
<ul>
<li>Multiple conditions (numeric)</li>
</ul>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="tidy_data.html#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First example</span></span>
<span id="cb590-2"><a href="tidy_data.html#cb590-2" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb590-3"><a href="tidy_data.html#cb590-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(height <span class="sc">&lt;</span> <span class="dv">180</span>, height <span class="sc">&gt;</span> <span class="dv">160</span>) <span class="sc">%&gt;%</span></span>
<span id="cb590-4"><a href="tidy_data.html#cb590-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>## [1] 24</code></pre>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="tidy_data.html#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same as above</span></span>
<span id="cb592-2"><a href="tidy_data.html#cb592-2" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb592-3"><a href="tidy_data.html#cb592-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(height <span class="sc">&lt;</span> <span class="dv">180</span> <span class="sc">&amp;</span> height <span class="sc">&gt;</span> <span class="dv">160</span>) <span class="sc">%&gt;%</span></span>
<span id="cb592-4"><a href="tidy_data.html#cb592-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>## [1] 24</code></pre>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="tidy_data.html#cb594-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Not same as above</span></span>
<span id="cb594-2"><a href="tidy_data.html#cb594-2" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb594-3"><a href="tidy_data.html#cb594-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(height <span class="sc">&lt;</span> <span class="dv">180</span> <span class="sc">|</span> height <span class="sc">&gt;</span> <span class="dv">160</span>) <span class="sc">%&gt;%</span></span>
<span id="cb594-4"><a href="tidy_data.html#cb594-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>## [1] 81</code></pre>
<p><strong>Challenge</strong></p>
<ol style="list-style-type: decimal">
<li>Use <code>filter(between())</code> to find characters whose heights are between 180 and 160 and (2) count the number of these observations.</li>
</ol>
<ul>
<li>Minimum reproducible example</li>
</ul>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="tidy_data.html#cb596-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb596-2"><a href="tidy_data.html#cb596-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">160</span><span class="sc">:</span><span class="dv">180</span>),</span>
<span id="cb596-3"><a href="tidy_data.html#cb596-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">char =</span> <span class="fu">rep</span>(<span class="st">&quot;none&quot;</span>, <span class="fu">length</span>(<span class="fu">c</span>(<span class="dv">160</span><span class="sc">:</span><span class="dv">180</span>)))</span>
<span id="cb596-4"><a href="tidy_data.html#cb596-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb596-5"><a href="tidy_data.html#cb596-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb596-6"><a href="tidy_data.html#cb596-6" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb596-7"><a href="tidy_data.html#cb596-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">between</span>(heights, <span class="dv">161</span>, <span class="dv">179</span>))</span></code></pre></div>
<pre><code>## # A tibble: 19 × 2
##    heights char 
##      &lt;int&gt; &lt;chr&gt;
##  1     161 none 
##  2     162 none 
##  3     163 none 
##  4     164 none 
##  5     165 none 
##  6     166 none 
##  7     167 none 
##  8     168 none 
##  9     169 none 
## 10     170 none 
## 11     171 none 
## 12     172 none 
## 13     173 none 
## 14     174 none 
## 15     175 none 
## 16     176 none 
## 17     177 none 
## 18     178 none 
## 19     179 none</code></pre>
<ul>
<li>Multiple conditions (character)</li>
</ul>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="tidy_data.html#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter names include ars; `grepl` is a base R function</span></span>
<span id="cb598-2"><a href="tidy_data.html#cb598-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb598-3"><a href="tidy_data.html#cb598-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb598-4"><a href="tidy_data.html#cb598-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;ars&quot;</span>, <span class="fu">tolower</span>(name)))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 14
##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Owen Lars    178   120 brown, gr… light      blue              52 male  mascu…
## 2 Beru Whi…    165    75 brown      light      blue              47 fema… femin…
## 3 Quarsh P…    183    NA black      dark       brown             62 &lt;NA&gt;  &lt;NA&gt;  
## 4 Cliegg L…    183    NA brown      fair       blue              82 male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="tidy_data.html#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or, if you prefer dplyr way</span></span>
<span id="cb600-2"><a href="tidy_data.html#cb600-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb600-3"><a href="tidy_data.html#cb600-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb600-4"><a href="tidy_data.html#cb600-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(<span class="fu">tolower</span>(name), <span class="st">&quot;ars&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 14
##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Owen Lars    178   120 brown, gr… light      blue              52 male  mascu…
## 2 Beru Whi…    165    75 brown      light      blue              47 fema… femin…
## 3 Quarsh P…    183    NA black      dark       brown             62 &lt;NA&gt;  &lt;NA&gt;  
## 4 Cliegg L…    183    NA brown      fair       blue              82 male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="tidy_data.html#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter brown and black hair_color</span></span>
<span id="cb602-2"><a href="tidy_data.html#cb602-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-3"><a href="tidy_data.html#cb602-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb602-4"><a href="tidy_data.html#cb602-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(hair_color <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;brown&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 31 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Leia Or…    150  49   brown      light      brown           19   fema… femin…
##  2 Beru Wh…    165  75   brown      light      blue            47   fema… femin…
##  3 Biggs D…    183  84   black      light      brown           24   male  mascu…
##  4 Chewbac…    228 112   brown      unknown    blue           200   male  mascu…
##  5 Han Solo    180  80   brown      fair       brown           29   male  mascu…
##  6 Wedge A…    170  77   brown      fair       hazel           21   male  mascu…
##  7 Jek Ton…    180 110   brown      fair       blue            NA   male  mascu…
##  8 Boba Fe…    183  78.2 black      fair       brown           31.5 male  mascu…
##  9 Lando C…    177  79   black      dark       brown           31   male  mascu…
## 10 Arvel C…     NA  NA   brown      fair       brown           NA   male  mascu…
## # ℹ 21 more rows
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<p><strong>Challenge</strong></p>
<p>Use <code>str_detect()</code> to find characters whose names include “Han”.</p>
<ul>
<li>Choose row by position (row index)</li>
</ul>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="tidy_data.html#cb604-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb604-2"><a href="tidy_data.html#cb604-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(height)) <span class="sc">%&gt;%</span></span>
<span id="cb604-3"><a href="tidy_data.html#cb604-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 14
##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Yarael P…    264    NA none       white      yellow            NA male  mascu…
## 2 Tarfful      234   136 brown      brown      blue              NA male  mascu…
## 3 Lama Su      229    88 none       grey       black             NA male  mascu…
## 4 Chewbacca    228   112 brown      unknown    blue             200 male  mascu…
## 5 Roos Tar…    224    82 none       grey       orange            NA male  mascu…
## 6 Grievous     216   159 none       brown, wh… green, y…         NA male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<ul>
<li>Sample by a fraction</li>
</ul>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="tidy_data.html#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For reproducibility</span></span>
<span id="cb606-2"><a href="tidy_data.html#cb606-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb606-3"><a href="tidy_data.html#cb606-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-4"><a href="tidy_data.html#cb606-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Old way</span></span>
<span id="cb606-5"><a href="tidy_data.html#cb606-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-6"><a href="tidy_data.html#cb606-6" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb606-7"><a href="tidy_data.html#cb606-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_frac</span>(<span class="fl">0.10</span>,</span>
<span id="cb606-8"><a href="tidy_data.html#cb606-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">FALSE</span></span>
<span id="cb606-9"><a href="tidy_data.html#cb606-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># Without replacement</span></span></code></pre></div>
<pre><code>## # A tibble: 9 × 14
##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Arvel Cr…     NA    NA brown      fair       brown           NA   male  mascu…
## 2 Sly Moore    178    48 none       pale       white           NA   &lt;NA&gt;  &lt;NA&gt;  
## 3 IG-88        200   140 none       metal      red             15   none  mascu…
## 4 Biggs Da…    183    84 black      light      brown           24   male  mascu…
## 5 Leia Org…    150    49 brown      light      brown           19   fema… femin…
## 6 Watto        137    NA black      blue, grey yellow          NA   male  mascu…
## 7 Jabba De…    175  1358 &lt;NA&gt;       green-tan… orange         600   herm… mascu…
## 8 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
## 9 Taun We      213    NA none       grey       black           NA   fema… femin…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="tidy_data.html#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New way</span></span>
<span id="cb608-2"><a href="tidy_data.html#cb608-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-3"><a href="tidy_data.html#cb608-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb608-4"><a href="tidy_data.html#cb608-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(</span>
<span id="cb608-5"><a href="tidy_data.html#cb608-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop =</span> <span class="fl">0.10</span>,</span>
<span id="cb608-6"><a href="tidy_data.html#cb608-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">FALSE</span></span>
<span id="cb608-7"><a href="tidy_data.html#cb608-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 8 × 14
##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Raymus A…    188  79   brown      light      brown           NA   male  mascu…
## 2 Tarfful      234 136   brown      brown      blue            NA   male  mascu…
## 3 Han Solo     180  80   brown      fair       brown           29   male  mascu…
## 4 Mas Amed…    196  NA   none       blue       blue            NA   male  mascu…
## 5 Barriss …    166  50   black      yellow     blue            40   fema… femin…
## 6 Darth Va…    202 136   none       white      yellow          41.9 male  mascu…
## 7 Finn          NA  NA   black      dark       dark            NA   male  mascu…
## 8 Boba Fett    183  78.2 black      fair       brown           31.5 male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<ul>
<li>Sample by number</li>
</ul>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="tidy_data.html#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Old way</span></span>
<span id="cb610-2"><a href="tidy_data.html#cb610-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-3"><a href="tidy_data.html#cb610-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb610-4"><a href="tidy_data.html#cb610-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">20</span>,</span>
<span id="cb610-5"><a href="tidy_data.html#cb610-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">FALSE</span></span>
<span id="cb610-6"><a href="tidy_data.html#cb610-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># Without replacement</span></span></code></pre></div>
<pre><code>## # A tibble: 20 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Quarsh …    183    NA black      dark       brown             62 &lt;NA&gt;  &lt;NA&gt;  
##  2 Poe Dam…     NA    NA brown      light      brown             NA male  mascu…
##  3 Mas Ame…    196    NA none       blue       blue              NA male  mascu…
##  4 Zam Wes…    168    55 blonde     fair, gre… yellow            NA fema… femin…
##  5 Leia Or…    150    49 brown      light      brown             19 fema… femin…
##  6 Jango F…    183    79 black      tan        brown             66 male  mascu…
##  7 Ben Qua…    163    65 none       grey, gre… orange            NA male  mascu…
##  8 Padmé A…    165    45 brown      light      brown             46 fema… femin…
##  9 Mace Wi…    188    84 none       dark       brown             72 male  mascu…
## 10 R2-D2        96    32 &lt;NA&gt;       white, bl… red               33 none  mascu…
## 11 Shmi Sk…    163    NA black      fair       brown             72 fema… femin…
## 12 Ratts T…     79    15 none       grey, blue unknown           NA male  mascu…
## 13 Nute Gu…    191    90 none       mottled g… red               NA male  mascu…
## 14 Darth M…    175    80 none       red        yellow            54 male  mascu…
## 15 Bib For…    180    NA none       pale       pink              NA male  mascu…
## 16 C-3PO       167    75 &lt;NA&gt;       gold       yellow           112 none  mascu…
## 17 Yarael …    264    NA none       white      yellow            NA male  mascu…
## 18 Ki-Adi-…    198    82 white      pale       yellow            92 male  mascu…
## 19 BB8          NA    NA none       none       black             NA none  mascu…
## 20 Eeth Ko…    171    NA black      brown      brown             NA male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="tidy_data.html#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New way</span></span>
<span id="cb612-2"><a href="tidy_data.html#cb612-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-3"><a href="tidy_data.html#cb612-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb612-4"><a href="tidy_data.html#cb612-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(</span>
<span id="cb612-5"><a href="tidy_data.html#cb612-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">20</span>,</span>
<span id="cb612-6"><a href="tidy_data.html#cb612-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">FALSE</span></span>
<span id="cb612-7"><a href="tidy_data.html#cb612-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># Without replacement</span></span></code></pre></div>
<pre><code>## # A tibble: 20 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Owen La…    178   120 brown, gr… light      blue              52 male  mascu…
##  2 Ki-Adi-…    198    82 white      pale       yellow            92 male  mascu…
##  3 Captain…     NA    NA unknown    unknown    unknown           NA &lt;NA&gt;  &lt;NA&gt;  
##  4 Gregar …    185    85 black      dark       brown             NA male  mascu…
##  5 R5-D4        97    32 &lt;NA&gt;       white, red red               NA none  mascu…
##  6 Ackbar      180    83 none       brown mot… orange            41 male  mascu…
##  7 Wedge A…    170    77 brown      fair       hazel             21 male  mascu…
##  8 Dormé       165    NA brown      light      brown             NA fema… femin…
##  9 Rey          NA    NA brown      light      hazel             NA fema… femin…
## 10 IG-88       200   140 none       metal      red               15 none  mascu…
## 11 Roos Ta…    224    82 none       grey       orange            NA male  mascu…
## 12 Shmi Sk…    163    NA black      fair       brown             72 fema… femin…
## 13 R2-D2        96    32 &lt;NA&gt;       white, bl… red               33 none  mascu…
## 14 Poe Dam…     NA    NA brown      light      brown             NA male  mascu…
## 15 Obi-Wan…    182    77 auburn, w… fair       blue-gray         57 male  mascu…
## 16 Plo Koon    188    80 none       orange     black             22 male  mascu…
## 17 Tarfful     234   136 brown      brown      blue              NA male  mascu…
## 18 Lobot       175    79 none       light      blue              37 male  mascu…
## 19 San Hill    191    NA none       grey       gold              NA male  mascu…
## 20 Kit Fis…    196    87 none       green      black             NA male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<ul>
<li>Top 10 rows orderd by height</li>
</ul>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="tidy_data.html#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Old way</span></span>
<span id="cb614-2"><a href="tidy_data.html#cb614-2" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb614-3"><a href="tidy_data.html#cb614-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, height)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
##  2 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…
##  3 Roos Ta…    224    82 none       grey       orange          NA   male  mascu…
##  4 Rugor N…    206    NA none       green      orange          NA   male  mascu…
##  5 Yarael …    264    NA none       white      yellow          NA   male  mascu…
##  6 Lama Su     229    88 none       grey       black           NA   male  mascu…
##  7 Taun We     213    NA none       grey       black           NA   fema… femin…
##  8 Grievous    216   159 none       brown, wh… green, y…       NA   male  mascu…
##  9 Tarfful     234   136 brown      brown      blue            NA   male  mascu…
## 10 Tion Me…    206    80 none       grey       black           NA   male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="tidy_data.html#cb616-1" aria-hidden="true" tabindex="-1"></a><span class="co"># New way</span></span>
<span id="cb616-2"><a href="tidy_data.html#cb616-2" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb616-3"><a href="tidy_data.html#cb616-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(height, <span class="at">n =</span> <span class="dv">10</span>) <span class="co"># Variable first, Argument second</span></span></code></pre></div>
<pre><code>## # A tibble: 10 × 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Yarael …    264    NA none       white      yellow          NA   male  mascu…
##  2 Tarfful     234   136 brown      brown      blue            NA   male  mascu…
##  3 Lama Su     229    88 none       grey       black           NA   male  mascu…
##  4 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…
##  5 Roos Ta…    224    82 none       grey       orange          NA   male  mascu…
##  6 Grievous    216   159 none       brown, wh… green, y…       NA   male  mascu…
##  7 Taun We     213    NA none       grey       black           NA   fema… femin…
##  8 Rugor N…    206    NA none       green      orange          NA   male  mascu…
##  9 Tion Me…    206    80 none       grey       black           NA   male  mascu…
## 10 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
## # ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
<div id="subset-variables-columns" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Subset variables (columns)<a href="tidy_data.html#subset-variables-columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="tidy_data.html#cb618-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(msleep)</span></code></pre></div>
<pre><code>##  [1] &quot;name&quot;         &quot;genus&quot;        &quot;vore&quot;         &quot;order&quot;        &quot;conservation&quot;
##  [6] &quot;sleep_total&quot;  &quot;sleep_rem&quot;    &quot;sleep_cycle&quot;  &quot;awake&quot;        &quot;brainwt&quot;     
## [11] &quot;bodywt&quot;</code></pre>
<ul>
<li>Select only numeric columns</li>
</ul>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="tidy_data.html#cb620-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only numeric</span></span>
<span id="cb620-2"><a href="tidy_data.html#cb620-2" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb620-3"><a href="tidy_data.html#cb620-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 6
##    sleep_total sleep_rem sleep_cycle awake  brainwt  bodywt
##          &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
##  1        12.1      NA        NA      11.9 NA        50    
##  2        17         1.8      NA       7    0.0155    0.48 
##  3        14.4       2.4      NA       9.6 NA         1.35 
##  4        14.9       2.3       0.133   9.1  0.00029   0.019
##  5         4         0.7       0.667  20    0.423   600    
##  6        14.4       2.2       0.767   9.6 NA         3.85 
##  7         8.7       1.4       0.383  15.3 NA        20.5  
##  8         7        NA        NA      17   NA         0.045
##  9        10.1       2.9       0.333  13.9  0.07     14    
## 10         3        NA        NA      21    0.0982   14.8  
## # ℹ 73 more rows</code></pre>
<p><strong>Challenge</strong></p>
<p>Use <code>select(where())</code> to find only non-numeric columns</p>
<ul>
<li>Select the columns that include “sleep” in their names</li>
</ul>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="tidy_data.html#cb622-1" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb622-2"><a href="tidy_data.html#cb622-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;sleep&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 3
##    sleep_total sleep_rem sleep_cycle
##          &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
##  1        12.1      NA        NA    
##  2        17         1.8      NA    
##  3        14.4       2.4      NA    
##  4        14.9       2.3       0.133
##  5         4         0.7       0.667
##  6        14.4       2.2       0.767
##  7         8.7       1.4       0.383
##  8         7        NA        NA    
##  9        10.1       2.9       0.333
## 10         3        NA        NA    
## # ℹ 73 more rows</code></pre>
<ul>
<li><p>Select the columns that include either “sleep” or “wt” in their names</p></li>
<li><p>Basic R way</p></li>
</ul>
<p><code>grepl</code> is one of the R base pattern matching functions.</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="tidy_data.html#cb624-1" aria-hidden="true" tabindex="-1"></a>msleep[<span class="fu">grepl</span>(<span class="st">&quot;sleep|wt&quot;</span>, <span class="fu">names</span>(msleep))]</span></code></pre></div>
<pre><code>## # A tibble: 83 × 5
##    sleep_total sleep_rem sleep_cycle  brainwt  bodywt
##          &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
##  1        12.1      NA        NA     NA        50    
##  2        17         1.8      NA      0.0155    0.48 
##  3        14.4       2.4      NA     NA         1.35 
##  4        14.9       2.3       0.133  0.00029   0.019
##  5         4         0.7       0.667  0.423   600    
##  6        14.4       2.2       0.767 NA         3.85 
##  7         8.7       1.4       0.383 NA        20.5  
##  8         7        NA        NA     NA         0.045
##  9        10.1       2.9       0.333  0.07     14    
## 10         3        NA        NA      0.0982   14.8  
## # ℹ 73 more rows</code></pre>
<p><strong>Challenge</strong></p>
<p>Use <code>select(match())</code> to find columns whose names include either “sleep” or “wt”.</p>
<ul>
<li>Select the columns that start with “b”</li>
</ul>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="tidy_data.html#cb626-1" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb626-2"><a href="tidy_data.html#cb626-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;b&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 2
##     brainwt  bodywt
##       &lt;dbl&gt;   &lt;dbl&gt;
##  1 NA        50    
##  2  0.0155    0.48 
##  3 NA         1.35 
##  4  0.00029   0.019
##  5  0.423   600    
##  6 NA         3.85 
##  7 NA        20.5  
##  8 NA         0.045
##  9  0.07     14    
## 10  0.0982   14.8  
## # ℹ 73 more rows</code></pre>
<ul>
<li>Select the columns that end with “wt”</li>
</ul>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="tidy_data.html#cb628-1" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb628-2"><a href="tidy_data.html#cb628-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">&quot;wt&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 2
##     brainwt  bodywt
##       &lt;dbl&gt;   &lt;dbl&gt;
##  1 NA        50    
##  2  0.0155    0.48 
##  3 NA         1.35 
##  4  0.00029   0.019
##  5  0.423   600    
##  6 NA         3.85 
##  7 NA        20.5  
##  8 NA         0.045
##  9  0.07     14    
## 10  0.0982   14.8  
## # ℹ 73 more rows</code></pre>
<ul>
<li>Select the columns using both beginning and end string patterns</li>
</ul>
<p>The key idea is you can use Boolean operators (<code>!</code>, <code>&amp;</code>, <code>|</code>)to combine different string pattern matching statements.</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="tidy_data.html#cb630-1" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb630-2"><a href="tidy_data.html#cb630-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;b&quot;</span>) <span class="sc">&amp;</span> <span class="fu">ends_with</span>(<span class="st">&quot;wt&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 2
##     brainwt  bodywt
##       &lt;dbl&gt;   &lt;dbl&gt;
##  1 NA        50    
##  2  0.0155    0.48 
##  3 NA         1.35 
##  4  0.00029   0.019
##  5  0.423   600    
##  6 NA         3.85 
##  7 NA        20.5  
##  8 NA         0.045
##  9  0.07     14    
## 10  0.0982   14.8  
## # ℹ 73 more rows</code></pre>
<ul>
<li>Select the order and move it before everything</li>
</ul>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="tidy_data.html#cb632-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By specifying a column</span></span>
<span id="cb632-2"><a href="tidy_data.html#cb632-2" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb632-3"><a href="tidy_data.html#cb632-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(order, <span class="fu">everything</span>())</span></code></pre></div>
<pre><code>## # A tibble: 83 × 11
##    order  name  genus vore  conservation sleep_total sleep_rem sleep_cycle awake
##    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
##  1 Carni… Chee… Acin… carni lc                  12.1      NA        NA      11.9
##  2 Prima… Owl … Aotus omni  &lt;NA&gt;                17         1.8      NA       7  
##  3 Roden… Moun… Aplo… herbi nt                  14.4       2.4      NA       9.6
##  4 Soric… Grea… Blar… omni  lc                  14.9       2.3       0.133   9.1
##  5 Artio… Cow   Bos   herbi domesticated         4         0.7       0.667  20  
##  6 Pilosa Thre… Brad… herbi &lt;NA&gt;                14.4       2.2       0.767   9.6
##  7 Carni… Nort… Call… carni vu                   8.7       1.4       0.383  15.3
##  8 Roden… Vesp… Calo… &lt;NA&gt;  &lt;NA&gt;                 7        NA        NA      17  
##  9 Carni… Dog   Canis carni domesticated        10.1       2.9       0.333  13.9
## 10 Artio… Roe … Capr… herbi lc                   3        NA        NA      21  
## # ℹ 73 more rows
## # ℹ 2 more variables: brainwt &lt;dbl&gt;, bodywt &lt;dbl&gt;</code></pre>
<ul>
<li>Select variables from a character vector.</li>
</ul>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="tidy_data.html#cb634-1" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb634-2"><a href="tidy_data.html#cb634-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;order&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb634-3"><a href="tidy_data.html#cb634-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>()</span></code></pre></div>
<pre><code>## [1] &quot;name&quot;  &quot;order&quot;</code></pre>
<ul>
<li>Select the variables named in character + number pattern</li>
</ul>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="tidy_data.html#cb636-1" aria-hidden="true" tabindex="-1"></a>msleep<span class="sc">$</span>week8 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb636-2"><a href="tidy_data.html#cb636-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb636-3"><a href="tidy_data.html#cb636-3" aria-hidden="true" tabindex="-1"></a>msleep<span class="sc">$</span>week12 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb636-4"><a href="tidy_data.html#cb636-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb636-5"><a href="tidy_data.html#cb636-5" aria-hidden="true" tabindex="-1"></a>msleep<span class="sc">$</span>week_extra <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb636-6"><a href="tidy_data.html#cb636-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb636-7"><a href="tidy_data.html#cb636-7" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span></span>
<span id="cb636-8"><a href="tidy_data.html#cb636-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">num_range</span>(<span class="st">&quot;week&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 83 × 2
##    week8 week12
##    &lt;lgl&gt; &lt;lgl&gt; 
##  1 NA    NA    
##  2 NA    NA    
##  3 NA    NA    
##  4 NA    NA    
##  5 NA    NA    
##  6 NA    NA    
##  7 NA    NA    
##  8 NA    NA    
##  9 NA    NA    
## 10 NA    NA    
## # ℹ 73 more rows</code></pre>
<p><strong>Additional tips</strong></p>
<p><code>msleep</code> data has nicely cleaned column names. But real-world data are usually messier. The <code>janitor</code> package is useful to fix this kind of problem.</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="tidy_data.html#cb638-1" aria-hidden="true" tabindex="-1"></a>messy_df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb638-2"><a href="tidy_data.html#cb638-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span><span class="st">&quot;ColNum1&quot;</span>, <span class="sc">~</span><span class="st">&quot;COLNUM2&quot;</span>, <span class="sc">~</span><span class="st">&quot;COL &amp; NUM3&quot;</span>,</span>
<span id="cb638-3"><a href="tidy_data.html#cb638-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span></span>
<span id="cb638-4"><a href="tidy_data.html#cb638-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb638-5"><a href="tidy_data.html#cb638-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb638-6"><a href="tidy_data.html#cb638-6" aria-hidden="true" tabindex="-1"></a>messy_df</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   ColNum1 COLNUM2 `COL &amp; NUM3`
##     &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;
## 1       1       2            3</code></pre>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="tidy_data.html#cb640-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(janitor)</span>
<span id="cb640-2"><a href="tidy_data.html#cb640-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb640-3"><a href="tidy_data.html#cb640-3" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">clean_names</span>(messy_df)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   col_num1 colnum2 col_num3
##      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1        1       2        3</code></pre>
<p><code>janitor::tabyl()</code> is helpful for doing crosstabulation and a nice alternative to <code>table()</code> function.</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="tidy_data.html#cb642-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency table; The default output class is table</span></span>
<span id="cb642-2"><a href="tidy_data.html#cb642-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gapminder<span class="sc">$</span>country)</span></code></pre></div>
<pre><code>## 
##              Afghanistan                  Albania                  Algeria 
##                       12                       12                       12 
##                   Angola                Argentina                Australia 
##                       12                       12                       12 
##                  Austria                  Bahrain               Bangladesh 
##                       12                       12                       12 
##                  Belgium                    Benin                  Bolivia 
##                       12                       12                       12 
##   Bosnia and Herzegovina                 Botswana                   Brazil 
##                       12                       12                       12 
##                 Bulgaria             Burkina Faso                  Burundi 
##                       12                       12                       12 
##                 Cambodia                 Cameroon                   Canada 
##                       12                       12                       12 
## Central African Republic                     Chad                    Chile 
##                       12                       12                       12 
##                    China                 Colombia                  Comoros 
##                       12                       12                       12 
##         Congo, Dem. Rep.              Congo, Rep.               Costa Rica 
##                       12                       12                       12 
##            Cote d&#39;Ivoire                  Croatia                     Cuba 
##                       12                       12                       12 
##           Czech Republic                  Denmark                 Djibouti 
##                       12                       12                       12 
##       Dominican Republic                  Ecuador                    Egypt 
##                       12                       12                       12 
##              El Salvador        Equatorial Guinea                  Eritrea 
##                       12                       12                       12 
##                 Ethiopia                  Finland                   France 
##                       12                       12                       12 
##                    Gabon                   Gambia                  Germany 
##                       12                       12                       12 
##                    Ghana                   Greece                Guatemala 
##                       12                       12                       12 
##                   Guinea            Guinea-Bissau                    Haiti 
##                       12                       12                       12 
##                 Honduras         Hong Kong, China                  Hungary 
##                       12                       12                       12 
##                  Iceland                    India                Indonesia 
##                       12                       12                       12 
##                     Iran                     Iraq                  Ireland 
##                       12                       12                       12 
##                   Israel                    Italy                  Jamaica 
##                       12                       12                       12 
##                    Japan                   Jordan                    Kenya 
##                       12                       12                       12 
##         Korea, Dem. Rep.              Korea, Rep.                   Kuwait 
##                       12                       12                       12 
##                  Lebanon                  Lesotho                  Liberia 
##                       12                       12                       12 
##                    Libya               Madagascar                   Malawi 
##                       12                       12                       12 
##                 Malaysia                     Mali               Mauritania 
##                       12                       12                       12 
##                Mauritius                   Mexico                 Mongolia 
##                       12                       12                       12 
##               Montenegro                  Morocco               Mozambique 
##                       12                       12                       12 
##                  Myanmar                  Namibia                    Nepal 
##                       12                       12                       12 
##              Netherlands              New Zealand                Nicaragua 
##                       12                       12                       12 
##                    Niger                  Nigeria                   Norway 
##                       12                       12                       12 
##                     Oman                 Pakistan                   Panama 
##                       12                       12                       12 
##                 Paraguay                     Peru              Philippines 
##                       12                       12                       12 
##                   Poland                 Portugal              Puerto Rico 
##                       12                       12                       12 
##                  Reunion                  Romania                   Rwanda 
##                       12                       12                       12 
##    Sao Tome and Principe             Saudi Arabia                  Senegal 
##                       12                       12                       12 
##                   Serbia             Sierra Leone                Singapore 
##                       12                       12                       12 
##          Slovak Republic                 Slovenia                  Somalia 
##                       12                       12                       12 
##             South Africa                    Spain                Sri Lanka 
##                       12                       12                       12 
##                    Sudan                Swaziland                   Sweden 
##                       12                       12                       12 
##              Switzerland                    Syria                   Taiwan 
##                       12                       12                       12 
##                 Tanzania                 Thailand                     Togo 
##                       12                       12                       12 
##      Trinidad and Tobago                  Tunisia                   Turkey 
##                       12                       12                       12 
##                   Uganda           United Kingdom            United States 
##                       12                       12                       12 
##                  Uruguay                Venezuela                  Vietnam 
##                       12                       12                       12 
##       West Bank and Gaza              Yemen, Rep.                   Zambia 
##                       12                       12                       12 
##                 Zimbabwe 
##                       12</code></pre>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="tidy_data.html#cb644-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency table (unique value, n, percentage)</span></span>
<span id="cb644-2"><a href="tidy_data.html#cb644-2" aria-hidden="true" tabindex="-1"></a>janitor<span class="sc">::</span><span class="fu">tabyl</span>(gapminder<span class="sc">$</span>country)</span></code></pre></div>
<pre><code>##         gapminder$country  n     percent
##               Afghanistan 12 0.007042254
##                   Albania 12 0.007042254
##                   Algeria 12 0.007042254
##                    Angola 12 0.007042254
##                 Argentina 12 0.007042254
##                 Australia 12 0.007042254
##                   Austria 12 0.007042254
##                   Bahrain 12 0.007042254
##                Bangladesh 12 0.007042254
##                   Belgium 12 0.007042254
##                     Benin 12 0.007042254
##                   Bolivia 12 0.007042254
##    Bosnia and Herzegovina 12 0.007042254
##                  Botswana 12 0.007042254
##                    Brazil 12 0.007042254
##                  Bulgaria 12 0.007042254
##              Burkina Faso 12 0.007042254
##                   Burundi 12 0.007042254
##                  Cambodia 12 0.007042254
##                  Cameroon 12 0.007042254
##                    Canada 12 0.007042254
##  Central African Republic 12 0.007042254
##                      Chad 12 0.007042254
##                     Chile 12 0.007042254
##                     China 12 0.007042254
##                  Colombia 12 0.007042254
##                   Comoros 12 0.007042254
##          Congo, Dem. Rep. 12 0.007042254
##               Congo, Rep. 12 0.007042254
##                Costa Rica 12 0.007042254
##             Cote d&#39;Ivoire 12 0.007042254
##                   Croatia 12 0.007042254
##                      Cuba 12 0.007042254
##            Czech Republic 12 0.007042254
##                   Denmark 12 0.007042254
##                  Djibouti 12 0.007042254
##        Dominican Republic 12 0.007042254
##                   Ecuador 12 0.007042254
##                     Egypt 12 0.007042254
##               El Salvador 12 0.007042254
##         Equatorial Guinea 12 0.007042254
##                   Eritrea 12 0.007042254
##                  Ethiopia 12 0.007042254
##                   Finland 12 0.007042254
##                    France 12 0.007042254
##                     Gabon 12 0.007042254
##                    Gambia 12 0.007042254
##                   Germany 12 0.007042254
##                     Ghana 12 0.007042254
##                    Greece 12 0.007042254
##                 Guatemala 12 0.007042254
##                    Guinea 12 0.007042254
##             Guinea-Bissau 12 0.007042254
##                     Haiti 12 0.007042254
##                  Honduras 12 0.007042254
##          Hong Kong, China 12 0.007042254
##                   Hungary 12 0.007042254
##                   Iceland 12 0.007042254
##                     India 12 0.007042254
##                 Indonesia 12 0.007042254
##                      Iran 12 0.007042254
##                      Iraq 12 0.007042254
##                   Ireland 12 0.007042254
##                    Israel 12 0.007042254
##                     Italy 12 0.007042254
##                   Jamaica 12 0.007042254
##                     Japan 12 0.007042254
##                    Jordan 12 0.007042254
##                     Kenya 12 0.007042254
##          Korea, Dem. Rep. 12 0.007042254
##               Korea, Rep. 12 0.007042254
##                    Kuwait 12 0.007042254
##                   Lebanon 12 0.007042254
##                   Lesotho 12 0.007042254
##                   Liberia 12 0.007042254
##                     Libya 12 0.007042254
##                Madagascar 12 0.007042254
##                    Malawi 12 0.007042254
##                  Malaysia 12 0.007042254
##                      Mali 12 0.007042254
##                Mauritania 12 0.007042254
##                 Mauritius 12 0.007042254
##                    Mexico 12 0.007042254
##                  Mongolia 12 0.007042254
##                Montenegro 12 0.007042254
##                   Morocco 12 0.007042254
##                Mozambique 12 0.007042254
##                   Myanmar 12 0.007042254
##                   Namibia 12 0.007042254
##                     Nepal 12 0.007042254
##               Netherlands 12 0.007042254
##               New Zealand 12 0.007042254
##                 Nicaragua 12 0.007042254
##                     Niger 12 0.007042254
##                   Nigeria 12 0.007042254
##                    Norway 12 0.007042254
##                      Oman 12 0.007042254
##                  Pakistan 12 0.007042254
##                    Panama 12 0.007042254
##                  Paraguay 12 0.007042254
##                      Peru 12 0.007042254
##               Philippines 12 0.007042254
##                    Poland 12 0.007042254
##                  Portugal 12 0.007042254
##               Puerto Rico 12 0.007042254
##                   Reunion 12 0.007042254
##                   Romania 12 0.007042254
##                    Rwanda 12 0.007042254
##     Sao Tome and Principe 12 0.007042254
##              Saudi Arabia 12 0.007042254
##                   Senegal 12 0.007042254
##                    Serbia 12 0.007042254
##              Sierra Leone 12 0.007042254
##                 Singapore 12 0.007042254
##           Slovak Republic 12 0.007042254
##                  Slovenia 12 0.007042254
##                   Somalia 12 0.007042254
##              South Africa 12 0.007042254
##                     Spain 12 0.007042254
##                 Sri Lanka 12 0.007042254
##                     Sudan 12 0.007042254
##                 Swaziland 12 0.007042254
##                    Sweden 12 0.007042254
##               Switzerland 12 0.007042254
##                     Syria 12 0.007042254
##                    Taiwan 12 0.007042254
##                  Tanzania 12 0.007042254
##                  Thailand 12 0.007042254
##                      Togo 12 0.007042254
##       Trinidad and Tobago 12 0.007042254
##                   Tunisia 12 0.007042254
##                    Turkey 12 0.007042254
##                    Uganda 12 0.007042254
##            United Kingdom 12 0.007042254
##             United States 12 0.007042254
##                   Uruguay 12 0.007042254
##                 Venezuela 12 0.007042254
##                   Vietnam 12 0.007042254
##        West Bank and Gaza 12 0.007042254
##               Yemen, Rep. 12 0.007042254
##                    Zambia 12 0.007042254
##                  Zimbabwe 12 0.007042254</code></pre>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="tidy_data.html#cb646-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If you want to add percentage ...</span></span>
<span id="cb646-2"><a href="tidy_data.html#cb646-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb646-3"><a href="tidy_data.html#cb646-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb646-4"><a href="tidy_data.html#cb646-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>(<span class="at">digits =</span> <span class="dv">0</span>, <span class="at">affix_sign =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##                   country  n percent
##               Afghanistan 12      1%
##                   Albania 12      1%
##                   Algeria 12      1%
##                    Angola 12      1%
##                 Argentina 12      1%
##                 Australia 12      1%
##                   Austria 12      1%
##                   Bahrain 12      1%
##                Bangladesh 12      1%
##                   Belgium 12      1%
##                     Benin 12      1%
##                   Bolivia 12      1%
##    Bosnia and Herzegovina 12      1%
##                  Botswana 12      1%
##                    Brazil 12      1%
##                  Bulgaria 12      1%
##              Burkina Faso 12      1%
##                   Burundi 12      1%
##                  Cambodia 12      1%
##                  Cameroon 12      1%
##                    Canada 12      1%
##  Central African Republic 12      1%
##                      Chad 12      1%
##                     Chile 12      1%
##                     China 12      1%
##                  Colombia 12      1%
##                   Comoros 12      1%
##          Congo, Dem. Rep. 12      1%
##               Congo, Rep. 12      1%
##                Costa Rica 12      1%
##             Cote d&#39;Ivoire 12      1%
##                   Croatia 12      1%
##                      Cuba 12      1%
##            Czech Republic 12      1%
##                   Denmark 12      1%
##                  Djibouti 12      1%
##        Dominican Republic 12      1%
##                   Ecuador 12      1%
##                     Egypt 12      1%
##               El Salvador 12      1%
##         Equatorial Guinea 12      1%
##                   Eritrea 12      1%
##                  Ethiopia 12      1%
##                   Finland 12      1%
##                    France 12      1%
##                     Gabon 12      1%
##                    Gambia 12      1%
##                   Germany 12      1%
##                     Ghana 12      1%
##                    Greece 12      1%
##                 Guatemala 12      1%
##                    Guinea 12      1%
##             Guinea-Bissau 12      1%
##                     Haiti 12      1%
##                  Honduras 12      1%
##          Hong Kong, China 12      1%
##                   Hungary 12      1%
##                   Iceland 12      1%
##                     India 12      1%
##                 Indonesia 12      1%
##                      Iran 12      1%
##                      Iraq 12      1%
##                   Ireland 12      1%
##                    Israel 12      1%
##                     Italy 12      1%
##                   Jamaica 12      1%
##                     Japan 12      1%
##                    Jordan 12      1%
##                     Kenya 12      1%
##          Korea, Dem. Rep. 12      1%
##               Korea, Rep. 12      1%
##                    Kuwait 12      1%
##                   Lebanon 12      1%
##                   Lesotho 12      1%
##                   Liberia 12      1%
##                     Libya 12      1%
##                Madagascar 12      1%
##                    Malawi 12      1%
##                  Malaysia 12      1%
##                      Mali 12      1%
##                Mauritania 12      1%
##                 Mauritius 12      1%
##                    Mexico 12      1%
##                  Mongolia 12      1%
##                Montenegro 12      1%
##                   Morocco 12      1%
##                Mozambique 12      1%
##                   Myanmar 12      1%
##                   Namibia 12      1%
##                     Nepal 12      1%
##               Netherlands 12      1%
##               New Zealand 12      1%
##                 Nicaragua 12      1%
##                     Niger 12      1%
##                   Nigeria 12      1%
##                    Norway 12      1%
##                      Oman 12      1%
##                  Pakistan 12      1%
##                    Panama 12      1%
##                  Paraguay 12      1%
##                      Peru 12      1%
##               Philippines 12      1%
##                    Poland 12      1%
##                  Portugal 12      1%
##               Puerto Rico 12      1%
##                   Reunion 12      1%
##                   Romania 12      1%
##                    Rwanda 12      1%
##     Sao Tome and Principe 12      1%
##              Saudi Arabia 12      1%
##                   Senegal 12      1%
##                    Serbia 12      1%
##              Sierra Leone 12      1%
##                 Singapore 12      1%
##           Slovak Republic 12      1%
##                  Slovenia 12      1%
##                   Somalia 12      1%
##              South Africa 12      1%
##                     Spain 12      1%
##                 Sri Lanka 12      1%
##                     Sudan 12      1%
##                 Swaziland 12      1%
##                    Sweden 12      1%
##               Switzerland 12      1%
##                     Syria 12      1%
##                    Taiwan 12      1%
##                  Tanzania 12      1%
##                  Thailand 12      1%
##                      Togo 12      1%
##       Trinidad and Tobago 12      1%
##                   Tunisia 12      1%
##                    Turkey 12      1%
##                    Uganda 12      1%
##            United Kingdom 12      1%
##             United States 12      1%
##                   Uruguay 12      1%
##                 Venezuela 12      1%
##                   Vietnam 12      1%
##        West Bank and Gaza 12      1%
##               Yemen, Rep. 12      1%
##                    Zambia 12      1%
##                  Zimbabwe 12      1%</code></pre>
</div>
<div id="create-variables" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Create variables<a href="tidy_data.html#create-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="change-values-using-conditions" class="section level4 hasAnchor" number="4.5.4.1">
<h4><span class="header-section-number">4.5.4.1</span> Change values using conditions<a href="tidy_data.html#change-values-using-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can think of <code>case_when()</code> (multiple conditions) as an extended version of <code>ifelse()</code> (binary conditions).</p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="tidy_data.html#cb648-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb648-2"><a href="tidy_data.html#cb648-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cyl_dummy =</span> <span class="fu">case_when</span>(</span>
<span id="cb648-3"><a href="tidy_data.html#cb648-3" aria-hidden="true" tabindex="-1"></a>    cyl <span class="sc">&gt;</span> <span class="fu">median</span>(cyl) <span class="sc">~</span> <span class="st">&quot;High&quot;</span>, <span class="co"># if condition</span></span>
<span id="cb648-4"><a href="tidy_data.html#cb648-4" aria-hidden="true" tabindex="-1"></a>    cyl <span class="sc">&lt;</span> <span class="fu">median</span>(cyl) <span class="sc">~</span> <span class="st">&quot;Low&quot;</span>, <span class="co"># else if condition</span></span>
<span id="cb648-5"><a href="tidy_data.html#cb648-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Median&quot;</span></span>
<span id="cb648-6"><a href="tidy_data.html#cb648-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="co"># else condition</span></span>
<span id="cb648-7"><a href="tidy_data.html#cb648-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb648-8"><a href="tidy_data.html#cb648-8" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">pull</span>(cyl_dummy)</span></code></pre></div>
<pre><code>##  [1] &quot;Median&quot; &quot;Median&quot; &quot;Low&quot;    &quot;Median&quot; &quot;High&quot;   &quot;Median&quot; &quot;High&quot;   &quot;Low&quot;   
##  [9] &quot;Low&quot;    &quot;Median&quot; &quot;Median&quot; &quot;High&quot;   &quot;High&quot;   &quot;High&quot;   &quot;High&quot;   &quot;High&quot;  
## [17] &quot;High&quot;   &quot;Low&quot;    &quot;Low&quot;    &quot;Low&quot;    &quot;Low&quot;    &quot;High&quot;   &quot;High&quot;   &quot;High&quot;  
## [25] &quot;High&quot;   &quot;Low&quot;    &quot;Low&quot;    &quot;Low&quot;    &quot;High&quot;   &quot;Median&quot; &quot;High&quot;   &quot;Low&quot;</code></pre>
</div>
<div id="change-values-manually" class="section level4 hasAnchor" number="4.5.4.2">
<h4><span class="header-section-number">4.5.4.2</span> Change values manually<a href="tidy_data.html#change-values-manually" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="tidy_data.html#cb650-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span></span>
<span id="cb650-2"><a href="tidy_data.html#cb650-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cyl_dummy =</span> <span class="fu">recode</span>(cyl_dummy, <span class="co"># Target column</span></span>
<span id="cb650-3"><a href="tidy_data.html#cb650-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;High&quot;</span> <span class="ot">=</span> <span class="st">&quot;2&quot;</span>, <span class="co"># Old - New</span></span>
<span id="cb650-4"><a href="tidy_data.html#cb650-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Low&quot;</span> <span class="ot">=</span> <span class="st">&quot;0&quot;</span>,</span>
<span id="cb650-5"><a href="tidy_data.html#cb650-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Median&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span></span>
<span id="cb650-6"><a href="tidy_data.html#cb650-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb650-7"><a href="tidy_data.html#cb650-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(cyl_dummy)</span></code></pre></div>
<pre><code>##  [1] &quot;1&quot; &quot;1&quot; &quot;0&quot; &quot;1&quot; &quot;2&quot; &quot;1&quot; &quot;2&quot; &quot;0&quot; &quot;0&quot; &quot;1&quot; &quot;1&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;0&quot; &quot;0&quot;
## [20] &quot;0&quot; &quot;0&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot; &quot;2&quot; &quot;1&quot; &quot;2&quot; &quot;0&quot;</code></pre>
</div>
</div>
<div id="counting" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> Counting<a href="tidy_data.html#counting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>How many countries are in each continent?</li>
</ul>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="tidy_data.html#cb652-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb652-2"><a href="tidy_data.html#cb652-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(continent)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent     n
##   &lt;fct&gt;     &lt;int&gt;
## 1 Africa      624
## 2 Americas    300
## 3 Asia        396
## 4 Europe      360
## 5 Oceania      24</code></pre>
<ul>
<li>Let’s arrange the result.</li>
</ul>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="tidy_data.html#cb654-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Just add a new argument `sort = TRUE`</span></span>
<span id="cb654-2"><a href="tidy_data.html#cb654-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb654-3"><a href="tidy_data.html#cb654-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(continent, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent     n
##   &lt;fct&gt;     &lt;int&gt;
## 1 Africa      624
## 2 Asia        396
## 3 Europe      360
## 4 Americas    300
## 5 Oceania      24</code></pre>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="tidy_data.html#cb656-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same as above; How nice!</span></span>
<span id="cb656-2"><a href="tidy_data.html#cb656-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb656-3"><a href="tidy_data.html#cb656-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb656-4"><a href="tidy_data.html#cb656-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent     n
##   &lt;fct&gt;     &lt;int&gt;
## 1 Africa      624
## 2 Asia        396
## 3 Europe      360
## 4 Americas    300
## 5 Oceania      24</code></pre>
<p><strong>Challenge</strong></p>
<p>Count the number of observations per <code>continent</code> and <code>year</code> and arrange them in descending order.</p>
<p>Let’s take a deeper look at how things work under the hood.</p>
<ul>
<li><p><code>tally()</code> works similar to <code>nrow()</code>: Calculate the total number of cases in a dataframe</p></li>
<li><p><code>count</code> = <code>group_by()</code> + <code>tally()</code></p></li>
</ul>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="tidy_data.html#cb658-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb658-2"><a href="tidy_data.html#cb658-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1  1704</code></pre>
<ul>
<li><code>add_tally()</code> = <code>mutate(n = n())</code></li>
</ul>
<p><strong>Challenge</strong></p>
<p>What does n in the below example represent?</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="tidy_data.html#cb660-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb660-2"><a href="tidy_data.html#cb660-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(continent, country) <span class="sc">%&gt;%</span></span>
<span id="cb660-3"><a href="tidy_data.html#cb660-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_tally</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1,704 × 3
##    continent country         n
##    &lt;fct&gt;     &lt;fct&gt;       &lt;int&gt;
##  1 Asia      Afghanistan  1704
##  2 Asia      Afghanistan  1704
##  3 Asia      Afghanistan  1704
##  4 Asia      Afghanistan  1704
##  5 Asia      Afghanistan  1704
##  6 Asia      Afghanistan  1704
##  7 Asia      Afghanistan  1704
##  8 Asia      Afghanistan  1704
##  9 Asia      Afghanistan  1704
## 10 Asia      Afghanistan  1704
## # ℹ 1,694 more rows</code></pre>
<ul>
<li><code>add_count</code></li>
</ul>
<p>Add count as a column.</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="tidy_data.html#cb662-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add count as a column</span></span>
<span id="cb662-2"><a href="tidy_data.html#cb662-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb662-3"><a href="tidy_data.html#cb662-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb662-4"><a href="tidy_data.html#cb662-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_count</span>(year)</span></code></pre></div>
<pre><code>## # A tibble: 1,704 × 7
## # Groups:   continent [5]
##    country     continent  year lifeExp      pop gdpPercap     n
##    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;
##  1 Afghanistan Asia       1952    28.8  8425333      779.    33
##  2 Afghanistan Asia       1957    30.3  9240934      821.    33
##  3 Afghanistan Asia       1962    32.0 10267083      853.    33
##  4 Afghanistan Asia       1967    34.0 11537966      836.    33
##  5 Afghanistan Asia       1972    36.1 13079460      740.    33
##  6 Afghanistan Asia       1977    38.4 14880372      786.    33
##  7 Afghanistan Asia       1982    39.9 12881816      978.    33
##  8 Afghanistan Asia       1987    40.8 13867957      852.    33
##  9 Afghanistan Asia       1992    41.7 16317921      649.    33
## 10 Afghanistan Asia       1997    41.8 22227415      635.    33
## # ℹ 1,694 more rows</code></pre>
<p><strong>Challenge</strong></p>
<p>Do cases 1 and 2 in the below code chunk produce the same outputs? If so, why?</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="tidy_data.html#cb664-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 1</span></span>
<span id="cb664-2"><a href="tidy_data.html#cb664-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb664-3"><a href="tidy_data.html#cb664-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">%&gt;%</span></span>
<span id="cb664-4"><a href="tidy_data.html#cb664-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 60 × 3
## # Groups:   continent, year [60]
##    continent  year     n
##    &lt;fct&gt;     &lt;int&gt; &lt;int&gt;
##  1 Africa     1952    52
##  2 Africa     1957    52
##  3 Africa     1962    52
##  4 Africa     1967    52
##  5 Africa     1972    52
##  6 Africa     1977    52
##  7 Africa     1982    52
##  8 Africa     1987    52
##  9 Africa     1992    52
## 10 Africa     1997    52
## # ℹ 50 more rows</code></pre>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="tidy_data.html#cb666-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 2</span></span>
<span id="cb666-2"><a href="tidy_data.html#cb666-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb666-3"><a href="tidy_data.html#cb666-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb666-4"><a href="tidy_data.html#cb666-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(year)</span></code></pre></div>
<pre><code>## # A tibble: 60 × 3
## # Groups:   continent [5]
##    continent  year     n
##    &lt;fct&gt;     &lt;int&gt; &lt;int&gt;
##  1 Africa     1952    52
##  2 Africa     1957    52
##  3 Africa     1962    52
##  4 Africa     1967    52
##  5 Africa     1972    52
##  6 Africa     1977    52
##  7 Africa     1982    52
##  8 Africa     1987    52
##  9 Africa     1992    52
## 10 Africa     1997    52
## # ℹ 50 more rows</code></pre>
<p><code>count()</code> is a simple function, but it is still helpful to learn an essential concept underlying complex data wrangling: split-apply-combine strategy. For more information, read Wickham’s article (2011) <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.182.5667&amp;rep=rep1&amp;type=pdf">“The Split-Apply-Combine Strategy for Data Analysis”</a> published in the <em>Journal of Statistical Software</em> (especially pages 7-8). <a href="https://github.com/hadley/plyr"><code>plyr</code></a> was the package (retired) that demonstrated this idea, which has evolved into two directions: <a href="https://dplyr.tidyverse.org/">dplyr</a> (for data frames) and <a href="https://purrr.tidyverse.org/">purrr</a> (for lists)</p>
</div>
<div id="summarizing" class="section level3 hasAnchor" number="4.5.6">
<h3><span class="header-section-number">4.5.6</span> Summarizing<a href="tidy_data.html#summarizing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="basic" class="section level4 hasAnchor" number="4.5.6.1">
<h4><span class="header-section-number">4.5.6.1</span> Basic<a href="tidy_data.html#basic" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Create a summary</li>
<li>Think of <code>summarise()</code> as an extended version of <code>count()</code>.</li>
</ul>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="tidy_data.html#cb668-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb668-2"><a href="tidy_data.html#cb668-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb668-3"><a href="tidy_data.html#cb668-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb668-4"><a href="tidy_data.html#cb668-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb668-5"><a href="tidy_data.html#cb668-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb668-6"><a href="tidy_data.html#cb668-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_gdp =</span> <span class="fu">sd</span>(gdpPercap)</span>
<span id="cb668-7"><a href="tidy_data.html#cb668-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   continent     n mean_gdp sd_gdp
##   &lt;fct&gt;     &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 Africa      624    2194.  2828.
## 2 Americas    300    7136.  6397.
## 3 Asia        396    7902. 14045.
## 4 Europe      360   14469.  9355.
## 5 Oceania      24   18622.  6359.</code></pre>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="tidy_data.html#cb670-1" aria-hidden="true" tabindex="-1"></a>tablea <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb670-2"><a href="tidy_data.html#cb670-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb670-3"><a href="tidy_data.html#cb670-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb670-4"><a href="tidy_data.html#cb670-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb670-5"><a href="tidy_data.html#cb670-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb670-6"><a href="tidy_data.html#cb670-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_gdp =</span> <span class="fu">sd</span>(gdpPercap)</span>
<span id="cb670-7"><a href="tidy_data.html#cb670-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<ul>
<li>Produce publishable tables</li>
</ul>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="tidy_data.html#cb671-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb671-2"><a href="tidy_data.html#cb671-2" aria-hidden="true" tabindex="-1"></a>  kableExtra,</span>
<span id="cb671-3"><a href="tidy_data.html#cb671-3" aria-hidden="true" tabindex="-1"></a>  flextable</span>
<span id="cb671-4"><a href="tidy_data.html#cb671-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb671-5"><a href="tidy_data.html#cb671-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-6"><a href="tidy_data.html#cb671-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For HTML and LaTeX</span></span>
<span id="cb671-7"><a href="tidy_data.html#cb671-7" aria-hidden="true" tabindex="-1"></a>tablea <span class="sc">%&gt;%</span> kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
continent
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean_gdp
</th>
<th style="text-align:right;">
sd_gdp
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:right;">
624
</td>
<td style="text-align:right;">
2193.755
</td>
<td style="text-align:right;">
2827.930
</td>
</tr>
<tr>
<td style="text-align:left;">
Americas
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
7136.110
</td>
<td style="text-align:right;">
6396.764
</td>
</tr>
<tr>
<td style="text-align:left;">
Asia
</td>
<td style="text-align:right;">
396
</td>
<td style="text-align:right;">
7902.150
</td>
<td style="text-align:right;">
14045.373
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe
</td>
<td style="text-align:right;">
360
</td>
<td style="text-align:right;">
14469.476
</td>
<td style="text-align:right;">
9355.213
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
18621.609
</td>
<td style="text-align:right;">
6358.983
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="tidy_data.html#cb672-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For HTML and MS Office suite</span></span>
<span id="cb672-2"><a href="tidy_data.html#cb672-2" aria-hidden="true" tabindex="-1"></a>tablea <span class="sc">%&gt;%</span> flextable<span class="sc">::</span><span class="fu">flextable</span>()</span></code></pre></div>
<div class="tabwid"><style>.cl-182a3428{}.cl-1823f50e{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1826c09a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1826c0a4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1826d378{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1826d382{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1826d383{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1826d38c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1826d38d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1826d38e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-182a3428'><thead><tr style="overflow-wrap:break-word;"><th class="cl-1826d378"><p class="cl-1826c09a"><span class="cl-1823f50e">continent</span></p></th><th class="cl-1826d382"><p class="cl-1826c0a4"><span class="cl-1823f50e">n</span></p></th><th class="cl-1826d382"><p class="cl-1826c0a4"><span class="cl-1823f50e">mean_gdp</span></p></th><th class="cl-1826d382"><p class="cl-1826c0a4"><span class="cl-1823f50e">sd_gdp</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-1826d383"><p class="cl-1826c09a"><span class="cl-1823f50e">Africa</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">624</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">2,193.755</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">2,827.930</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1826d383"><p class="cl-1826c09a"><span class="cl-1823f50e">Americas</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">300</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">7,136.110</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">6,396.764</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1826d383"><p class="cl-1826c09a"><span class="cl-1823f50e">Asia</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">396</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">7,902.150</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">14,045.373</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1826d383"><p class="cl-1826c09a"><span class="cl-1823f50e">Europe</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">360</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">14,469.476</span></p></td><td class="cl-1826d38c"><p class="cl-1826c0a4"><span class="cl-1823f50e">9,355.213</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-1826d38d"><p class="cl-1826c09a"><span class="cl-1823f50e">Oceania</span></p></td><td class="cl-1826d38e"><p class="cl-1826c0a4"><span class="cl-1823f50e">24</span></p></td><td class="cl-1826d38e"><p class="cl-1826c0a4"><span class="cl-1823f50e">18,621.609</span></p></td><td class="cl-1826d38e"><p class="cl-1826c0a4"><span class="cl-1823f50e">6,358.983</span></p></td></tr></tbody></table></div>
</div>
<div id="scoped-summaries" class="section level4 hasAnchor" number="4.5.6.2">
<h4><span class="header-section-number">4.5.6.2</span> Scoped summaries<a href="tidy_data.html#scoped-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Old way</p></li>
<li><p><code>summarise_all()</code></p></li>
</ul>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="tidy_data.html#cb673-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a wide-shaped data example</span></span>
<span id="cb673-2"><a href="tidy_data.html#cb673-2" aria-hidden="true" tabindex="-1"></a>wide_gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb673-3"><a href="tidy_data.html#cb673-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb673-4"><a href="tidy_data.html#cb673-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb673-5"><a href="tidy_data.html#cb673-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> country,</span>
<span id="cb673-6"><a href="tidy_data.html#cb673-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> gdpPercap</span>
<span id="cb673-7"><a href="tidy_data.html#cb673-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb673-8"><a href="tidy_data.html#cb673-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-9"><a href="tidy_data.html#cb673-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply summarise_all</span></span>
<span id="cb673-10"><a href="tidy_data.html#cb673-10" aria-hidden="true" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb673-11"><a href="tidy_data.html#cb673-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb673-12"><a href="tidy_data.html#cb673-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 30
##   Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<ul>
<li><code>summarise_if()</code>: using a logical condition</li>
</ul>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="tidy_data.html#cb675-1" aria-hidden="true" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb675-2"><a href="tidy_data.html#cb675-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_if</span>(is.double, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 31
##   lifeExp Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1    71.9   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<ul>
<li><p><code>summarise_at()</code></p></li>
<li><p><code>vars() = select()</code></p></li>
</ul>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="tidy_data.html#cb677-1" aria-hidden="true" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb677-2"><a href="tidy_data.html#cb677-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb677-3"><a href="tidy_data.html#cb677-3" aria-hidden="true" tabindex="-1"></a>    mean,</span>
<span id="cb677-4"><a href="tidy_data.html#cb677-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb677-5"><a href="tidy_data.html#cb677-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 30
##   Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="tidy_data.html#cb679-1" aria-hidden="true" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb679-2"><a href="tidy_data.html#cb679-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="fu">contains</span>(<span class="st">&quot;life&quot;</span>)),</span>
<span id="cb679-3"><a href="tidy_data.html#cb679-3" aria-hidden="true" tabindex="-1"></a>    mean,</span>
<span id="cb679-4"><a href="tidy_data.html#cb679-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb679-5"><a href="tidy_data.html#cb679-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   lifeExp
##     &lt;dbl&gt;
## 1    71.9</code></pre>
<p><strong>Additional tips</strong></p>
<div class="figure">
<img src="https://github.com/rstudio/concept-maps/raw/master/en/regular-expressions.svg" alt="" />
<p class="caption">Concept map for regular expressions. By Monica Alonso, Greg Wilson.</p>
</div>
<ul>
<li><p>New way</p></li>
<li><p><code>summarise()</code> + <code>across()</code></p></li>
</ul>
<div class="figure">
<img src="https://github.com/rstudio/concept-maps/raw/master/en/across.svg" alt="" />
<p class="caption">Concept map for across. By Emma Vestesson</p>
</div>
<ul>
<li><p>If you find using <code>summarise_all()</code>, <code>summarise_if()</code> and <code>summarise_at()</code> confusing, here’s a solution: use <code>summarise()</code> with <code>across()</code>.</p></li>
<li><p><code>summarise_all()</code></p></li>
</ul>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="tidy_data.html#cb681-1" aria-hidden="true" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb681-2"><a href="tidy_data.html#cb681-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(Albania<span class="sc">:</span><span class="st">`</span><span class="at">United Kingdom</span><span class="st">`</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `summarise()`.
## ℹ In argument: `across(Albania:`United Kingdom`, mean, na.rm = TRUE)`.
## Caused by warning:
## ! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.
## Supply arguments directly to `.fns` through an anonymous function instead.
## 
##   # Previously
##   across(a:b, mean, na.rm = TRUE)
## 
##   # Now
##   across(a:b, \(x) mean(x, na.rm = TRUE))</code></pre>
<pre><code>## # A tibble: 1 × 30
##   Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="tidy_data.html#cb684-1" aria-hidden="true" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb684-2"><a href="tidy_data.html#cb684-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 30
##   Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<ul>
<li><code>summarise_if()</code></li>
</ul>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="tidy_data.html#cb686-1" aria-hidden="true" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb686-2"><a href="tidy_data.html#cb686-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(is.double, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `summarise()`.
## ℹ In argument: `across(is.double, mean, na.rm = TRUE)`.
## Caused by warning:
## ! Use of bare predicate functions was deprecated in tidyselect 1.1.0.
## ℹ Please use wrap predicates in `where()` instead.
##   # Was:
##   data %&gt;% select(is.double)
## 
##   # Now:
##   data %&gt;% select(where(is.double))</code></pre>
<pre><code>## # A tibble: 1 × 31
##   lifeExp Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1    71.9   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<ul>
<li><code>summarise_at()</code></li>
</ul>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="tidy_data.html#cb689-1" aria-hidden="true" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb689-2"><a href="tidy_data.html#cb689-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb689-3"><a href="tidy_data.html#cb689-3" aria-hidden="true" tabindex="-1"></a>    mean,</span>
<span id="cb689-4"><a href="tidy_data.html#cb689-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb689-5"><a href="tidy_data.html#cb689-5" aria-hidden="true" tabindex="-1"></a>  ))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 30
##   Albania Austria Belgium `Bosnia and Herzegovina` Bulgaria Croatia
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
## 1   3255.  20412.  19901.                    3485.    6384.   9332.
## # ℹ 24 more variables: `Czech Republic` &lt;dbl&gt;, Denmark &lt;dbl&gt;, Finland &lt;dbl&gt;,
## #   France &lt;dbl&gt;, Germany &lt;dbl&gt;, Greece &lt;dbl&gt;, Hungary &lt;dbl&gt;, Iceland &lt;dbl&gt;,
## #   Ireland &lt;dbl&gt;, Italy &lt;dbl&gt;, Montenegro &lt;dbl&gt;, Netherlands &lt;dbl&gt;,
## #   Norway &lt;dbl&gt;, Poland &lt;dbl&gt;, Portugal &lt;dbl&gt;, Romania &lt;dbl&gt;, Serbia &lt;dbl&gt;,
## #   `Slovak Republic` &lt;dbl&gt;, Slovenia &lt;dbl&gt;, Spain &lt;dbl&gt;, Sweden &lt;dbl&gt;,
## #   Switzerland &lt;dbl&gt;, Turkey &lt;dbl&gt;, `United Kingdom` &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="tidy_data.html#cb691-1" aria-hidden="true" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb691-2"><a href="tidy_data.html#cb691-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">&quot;life&quot;</span>),</span>
<span id="cb691-3"><a href="tidy_data.html#cb691-3" aria-hidden="true" tabindex="-1"></a>    mean,</span>
<span id="cb691-4"><a href="tidy_data.html#cb691-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb691-5"><a href="tidy_data.html#cb691-5" aria-hidden="true" tabindex="-1"></a>  ))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   lifeExp
##     &lt;dbl&gt;
## 1    71.9</code></pre>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="tidy_data.html#cb693-1" aria-hidden="true" tabindex="-1"></a>wide_gapminder <span class="sc">%&gt;%</span></span>
<span id="cb693-2"><a href="tidy_data.html#cb693-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">&quot;A&quot;</span>, <span class="at">ignore.case =</span> <span class="cn">FALSE</span>)))</span></code></pre></div>
<pre><code>## Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
## dplyr 1.1.0.
## ℹ Please use `reframe()` instead.
## ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
##   always returns an ungrouped data frame and adjust accordingly.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## # A tibble: 360 × 2
##    Albania Austria
##      &lt;dbl&gt;   &lt;dbl&gt;
##  1   1601.      NA
##  2   1942.      NA
##  3   2313.      NA
##  4   2760.      NA
##  5   3313.      NA
##  6   3533.      NA
##  7   3631.      NA
##  8   3739.      NA
##  9   2497.      NA
## 10   3193.      NA
## # ℹ 350 more rows</code></pre>
<p>Note that this workshop does not cover creating and manipulating variables using <code>mutate()</code> because many techniques you learned from playing with <code>summarise()</code> can be directly applied to <code>mutate()</code>.</p>
<p><strong>Challenge</strong></p>
<ol style="list-style-type: decimal">
<li><p>Summarize the average GDP of countries whose names start with the alphabet “A.”</p></li>
<li><p>Turn the summary dataframe into a publishable table using either <code>kableExtra</code> or <code>flextable</code> package.</p></li>
</ol>
</div>
<div id="tabulation-tbd" class="section level4 hasAnchor" number="4.5.6.3">
<h4><span class="header-section-number">4.5.6.3</span> Tabulation (TBD)<a href="tidy_data.html#tabulation-tbd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="grouping" class="section level3 hasAnchor" number="4.5.7">
<h3><span class="header-section-number">4.5.7</span> Grouping<a href="tidy_data.html#grouping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="grouped-summaries" class="section level4 hasAnchor" number="4.5.7.1">
<h4><span class="header-section-number">4.5.7.1</span> Grouped summaries<a href="tidy_data.html#grouped-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Calculate the mean of <code>gdpPercap</code>.</p></li>
<li><p>Some functions are designed to work together. For instance, the <code>group_by()</code> function defines the strata you will use for summary statistics. Then, use <code>summarise()</code> to obtain summary statistics.</p></li>
</ul>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="tidy_data.html#cb696-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb696-2"><a href="tidy_data.html#cb696-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb696-3"><a href="tidy_data.html#cb696-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent mean_gdp
##   &lt;fct&gt;        &lt;dbl&gt;
## 1 Africa       2194.
## 2 Americas     7136.
## 3 Asia         7902.
## 4 Europe      14469.
## 5 Oceania     18622.</code></pre>
<ul>
<li>Calculate multiple summary statistics.</li>
</ul>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="tidy_data.html#cb698-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb698-2"><a href="tidy_data.html#cb698-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb698-3"><a href="tidy_data.html#cb698-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb698-4"><a href="tidy_data.html#cb698-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb698-5"><a href="tidy_data.html#cb698-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>()</span>
<span id="cb698-6"><a href="tidy_data.html#cb698-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   continent mean_gdp count
##   &lt;fct&gt;        &lt;dbl&gt; &lt;int&gt;
## 1 Africa       2194.   624
## 2 Americas     7136.   300
## 3 Asia         7902.   396
## 4 Europe      14469.   360
## 5 Oceania     18622.    24</code></pre>
<p><strong>Optional</strong></p>
<ul>
<li>Other summary statistics</li>
</ul>
<ol style="list-style-type: decimal">
<li>Measures of spread: <code>median(x)</code>, <code>sd(x)</code>, <code>IQR(x)</code>, <code>mad(x)</code> (the median absolute deviation)</li>
</ol>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="tidy_data.html#cb700-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The Interquartile Range = The Difference Between 75t and 25t Percentiles</span></span>
<span id="cb700-2"><a href="tidy_data.html#cb700-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb700-3"><a href="tidy_data.html#cb700-3" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb700-4"><a href="tidy_data.html#cb700-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb700-5"><a href="tidy_data.html#cb700-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">IQR_gdp =</span> <span class="fu">IQR</span>(gdpPercap))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent IQR_gdp
##   &lt;fct&gt;       &lt;dbl&gt;
## 1 Africa      1616.
## 2 Americas    4402.
## 3 Asia        7492.
## 4 Europe     13248.
## 5 Oceania     8072.</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Measures of rank: <code>min(x)</code>, <code>quantile(x, 0.25)</code>, <code>max(x)</code></li>
</ol>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="tidy_data.html#cb702-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb702-2"><a href="tidy_data.html#cb702-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb702-3"><a href="tidy_data.html#cb702-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb702-4"><a href="tidy_data.html#cb702-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_gdp =</span> <span class="fu">min</span>(gdpPercap),</span>
<span id="cb702-5"><a href="tidy_data.html#cb702-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_gdp =</span> <span class="fu">max</span>(gdpPercap)</span>
<span id="cb702-6"><a href="tidy_data.html#cb702-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   continent min_gdp max_gdp
##   &lt;fct&gt;       &lt;dbl&gt;   &lt;dbl&gt;
## 1 Africa       241.  21951.
## 2 Americas    1202.  42952.
## 3 Asia         331  113523.
## 4 Europe       974.  49357.
## 5 Oceania    10040.  34435.</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Measures of position: <code>first(x)</code>, <code>last(x)</code>, <code>nth(x, 2)</code></li>
</ol>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="tidy_data.html#cb704-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb704-2"><a href="tidy_data.html#cb704-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb704-3"><a href="tidy_data.html#cb704-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb704-4"><a href="tidy_data.html#cb704-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_gdp =</span> <span class="fu">first</span>(gdpPercap),</span>
<span id="cb704-5"><a href="tidy_data.html#cb704-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">last_gdp =</span> <span class="fu">last</span>(gdpPercap)</span>
<span id="cb704-6"><a href="tidy_data.html#cb704-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   continent first_gdp last_gdp
##   &lt;fct&gt;         &lt;dbl&gt;    &lt;dbl&gt;
## 1 Africa        2449.     470.
## 2 Americas      5911.   11416.
## 3 Asia           779.    2281.
## 4 Europe        1601.   33203.
## 5 Oceania      10040.   25185.</code></pre>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="tidy_data.html#cb706-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb706-2"><a href="tidy_data.html#cb706-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb706-3"><a href="tidy_data.html#cb706-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(gdpPercap) <span class="sc">%&gt;%</span> <span class="co"># Adding arrange</span></span>
<span id="cb706-4"><a href="tidy_data.html#cb706-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb706-5"><a href="tidy_data.html#cb706-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_gdp =</span> <span class="fu">first</span>(gdpPercap),</span>
<span id="cb706-6"><a href="tidy_data.html#cb706-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">last_gdp =</span> <span class="fu">last</span>(gdpPercap)</span>
<span id="cb706-7"><a href="tidy_data.html#cb706-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   continent first_gdp last_gdp
##   &lt;fct&gt;         &lt;dbl&gt;    &lt;dbl&gt;
## 1 Africa         241.   21951.
## 2 Americas      1202.   42952.
## 3 Asia           331   113523.
## 4 Europe         974.   49357.
## 5 Oceania      10040.   34435.</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Measures of counts: <code>n(x)</code> (all rows), <code>sum(!is.na(x))</code> (only non-missing rows) = <code>n_distinct(x)</code></li>
</ol>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="tidy_data.html#cb708-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb708-2"><a href="tidy_data.html#cb708-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb708-3"><a href="tidy_data.html#cb708-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ns =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent    ns
##   &lt;fct&gt;     &lt;int&gt;
## 1 Africa      624
## 2 Americas    300
## 3 Asia        396
## 4 Europe      360
## 5 Oceania      24</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Counts and proportions of logical values: <code>sum(condition about x)</code> (the number of TRUEs in x), <code>mean(condition about x)</code> (the proportion of TRUEs in x)</li>
</ol>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="tidy_data.html#cb710-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb710-2"><a href="tidy_data.html#cb710-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb710-3"><a href="tidy_data.html#cb710-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">rich_countries =</span> <span class="fu">mean</span>(gdpPercap <span class="sc">&gt;</span> <span class="dv">20000</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   continent rich_countries
##   &lt;fct&gt;              &lt;dbl&gt;
## 1 Africa           0.00481
## 2 Americas         0.05   
## 3 Asia             0.111  
## 4 Europe           0.261  
## 5 Oceania          0.333</code></pre>
<p><strong>Additional tips</strong></p>
<p>Also, check out window functions such as <code>cumsum()</code> and <code>lag()</code>. Window functions are a variant of aggregate functions that take a vector as input then return a vector of the same length as an output.</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="tidy_data.html#cb712-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb712-2"><a href="tidy_data.html#cb712-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-3"><a href="tidy_data.html#cb712-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Typical aggregate function</span></span>
<span id="cb712-4"><a href="tidy_data.html#cb712-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(vec) <span class="co"># The output length is one</span></span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="tidy_data.html#cb714-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Window function</span></span>
<span id="cb714-2"><a href="tidy_data.html#cb714-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cumsum</span>(vec) <span class="co"># The output length is ten</span></span></code></pre></div>
<pre><code>##  [1]  1  3  6 10 15 21 28 36 45 55</code></pre>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="tidy_data.html#cb716-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s compare them side-by-side</span></span>
<span id="cb716-2"><a href="tidy_data.html#cb716-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(</span>
<span id="cb716-3"><a href="tidy_data.html#cb716-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(vec),</span>
<span id="cb716-4"><a href="tidy_data.html#cb716-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cumsum</span>(vec)</span>
<span id="cb716-5"><a href="tidy_data.html#cb716-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## `old`: 55                         
## `new`:  1 3 6 10 15 21 28 36 45 55</code></pre>
</div>
</div>
<div id="joining" class="section level3 hasAnchor" number="4.5.8">
<h3><span class="header-section-number">4.5.8</span> Joining<a href="tidy_data.html#joining" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Relational data = multiple tables of data</p>
<div class="figure">
<img src="https://d33wubrfki0l68.cloudfront.net/245292d1ea724f6c3fd8a92063dcd7bfb9758d02/5751b/diagrams/relational-nycflights.png" alt="" />
<p class="caption">Relational data example</p>
</div>
<p><strong>Key ideas</strong></p>
<ul>
<li>A <strong>primary key</strong> “uniquely identifies an observation in its table”</li>
</ul>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="tidy_data.html#cb718-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb718-2"><a href="tidy_data.html#cb718-2" aria-hidden="true" tabindex="-1"></a>planes<span class="sc">$</span>tailnum <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## [1] &quot;N10156&quot; &quot;N102UW&quot; &quot;N103US&quot; &quot;N104UW&quot; &quot;N10575&quot; &quot;N105UW&quot;</code></pre>
<p>Verify primary key</p>
<p><code>tailnum</code> should be unique.</p>
<p><strong>Challenge</strong></p>
<p>What do you expect the outcome?</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="tidy_data.html#cb720-1" aria-hidden="true" tabindex="-1"></a>planes <span class="sc">%&gt;%</span></span>
<span id="cb720-2"><a href="tidy_data.html#cb720-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tailnum) <span class="sc">%&gt;%</span></span>
<span id="cb720-3"><a href="tidy_data.html#cb720-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 0 × 2
## # ℹ 2 variables: tailnum &lt;chr&gt;, n &lt;int&gt;</code></pre>
<p><strong>Optional</strong></p>
<p>If a dataframe doesn’t have a primary key, you can add one called a <strong>surrogate</strong> key.</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="tidy_data.html#cb722-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Toy example</span></span>
<span id="cb722-2"><a href="tidy_data.html#cb722-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb722-3"><a href="tidy_data.html#cb722-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb722-4"><a href="tidy_data.html#cb722-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb722-5"><a href="tidy_data.html#cb722-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb722-6"><a href="tidy_data.html#cb722-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb722-7"><a href="tidy_data.html#cb722-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a row_index column</span></span>
<span id="cb722-8"><a href="tidy_data.html#cb722-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">rowid_to_column</span>(<span class="st">&quot;ID&quot;</span>)</span></code></pre></div>
<ul>
<li>A <strong>foreign</strong> key “uniquely identifies an observation in another table.”</li>
</ul>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="tidy_data.html#cb723-1" aria-hidden="true" tabindex="-1"></a>flights<span class="sc">$</span>tailnum <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## [1] &quot;N14228&quot; &quot;N24211&quot; &quot;N619AA&quot; &quot;N804JB&quot; &quot;N668DN&quot; &quot;N39463&quot;</code></pre>
<p>For joining, don’t be distracted by other details and focus on KEYS!</p>
<div id="mutating-joins" class="section level4 hasAnchor" number="4.5.8.1">
<h4><span class="header-section-number">4.5.8.1</span> Mutating joins<a href="tidy_data.html#mutating-joins" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Add new variables to one data frame from matching observations in another”</p>
</blockquote>
<p>Using a simple toy example is great because it is easy to see how things work in that much narrow context.</p>
<ul>
<li>Toy example</li>
</ul>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="tidy_data.html#cb725-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 1</span></span>
<span id="cb725-2"><a href="tidy_data.html#cb725-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb725-3"><a href="tidy_data.html#cb725-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">key =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb725-4"><a href="tidy_data.html#cb725-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">val_x =</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>, <span class="st">&quot;x4&quot;</span>)</span>
<span id="cb725-5"><a href="tidy_data.html#cb725-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb725-6"><a href="tidy_data.html#cb725-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-7"><a href="tidy_data.html#cb725-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 2</span></span>
<span id="cb725-8"><a href="tidy_data.html#cb725-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb725-9"><a href="tidy_data.html#cb725-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">key =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb725-10"><a href="tidy_data.html#cb725-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">val_y =</span> <span class="fu">c</span>(<span class="st">&quot;y1&quot;</span>, <span class="st">&quot;y2&quot;</span>, <span class="st">&quot;y3&quot;</span>, <span class="st">&quot;y4&quot;</span>, <span class="st">&quot;y5&quot;</span>)</span>
<span id="cb725-11"><a href="tidy_data.html#cb725-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li>Inner Join</li>
</ul>
<p><code>inner_join()</code> keeps the matched values in both tables. If the left table is a subset of the right table, then <code>left_join()</code> is the same as <code>inner_join()</code>.</p>
<p><strong>Challenge</strong></p>
<p>What is going to be the shared keys?</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="tidy_data.html#cb726-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inner_join</span>(x, y)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(key)`</code></pre>
<pre><code>## # A tibble: 4 × 3
##     key val_x val_y
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1   
## 2     2 x2    y2   
## 3     3 x3    y3   
## 4     4 x4    y4</code></pre>
<div class="figure">
<img src="https://d33wubrfki0l68.cloudfront.net/aeab386461820b029b7e7606ccff1286f623bae1/ef0d4/diagrams/join-venn.png" alt="" />
<p class="caption">Mutating joins</p>
</div>
<ul>
<li>Left Join</li>
</ul>
<p><code>left_join()</code>, <code>right_join()</code> and <code>full_join()</code> are outer join functions. Unlike <code>inner_join()</code>, outer join functions keep observations that appear in at least one of the tables.</p>
<p><code>left_join()</code> keeps only the matched observations in the right table.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="tidy_data.html#cb729-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(x, y)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(key)`</code></pre>
<pre><code>## # A tibble: 4 × 3
##     key val_x val_y
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1   
## 2     2 x2    y2   
## 3     3 x3    y3   
## 4     4 x4    y4</code></pre>
<ul>
<li>Right Join</li>
</ul>
<p><code>right_join()</code> does the opposite.</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="tidy_data.html#cb732-1" aria-hidden="true" tabindex="-1"></a><span class="fu">right_join</span>(x, y)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(key)`</code></pre>
<pre><code>## # A tibble: 5 × 3
##     key val_x val_y
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1   
## 2     2 x2    y2   
## 3     3 x3    y3   
## 4     4 x4    y4   
## 5     5 &lt;NA&gt;  y5</code></pre>
<ul>
<li>Full Join</li>
</ul>
<p><code>full_join()</code> keeps the observations from both tables. NAs were recorded in one of the two tables if they were unmatched.</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="tidy_data.html#cb735-1" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(x, y)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(key)`</code></pre>
<pre><code>## # A tibble: 5 × 3
##     key val_x val_y
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1   
## 2     2 x2    y2   
## 3     3 x3    y3   
## 4     4 x4    y4   
## 5     5 &lt;NA&gt;  y5</code></pre>
</div>
<div id="filtering-joins" class="section level4 hasAnchor" number="4.5.8.2">
<h4><span class="header-section-number">4.5.8.2</span> Filtering joins<a href="tidy_data.html#filtering-joins" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Filter observations from one data frame based on whether they match an observation in the other table.</p>
</blockquote>
<ul>
<li>Semi Join</li>
</ul>
<p>In SQL, this type of query is also called subqueries.</p>
<ul>
<li>Filtering without joining</li>
</ul>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="tidy_data.html#cb738-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the list of the top 10 destinations</span></span>
<span id="cb738-2"><a href="tidy_data.html#cb738-2" aria-hidden="true" tabindex="-1"></a>top_dest <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb738-3"><a href="tidy_data.html#cb738-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(dest, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb738-4"><a href="tidy_data.html#cb738-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Selecting by n</code></pre>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="tidy_data.html#cb740-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter</span></span>
<span id="cb740-2"><a href="tidy_data.html#cb740-2" aria-hidden="true" tabindex="-1"></a>filtered <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb740-3"><a href="tidy_data.html#cb740-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dest <span class="sc">%in%</span> top_dest<span class="sc">$</span>dest)</span></code></pre></div>
<ul>
<li>Using semi join: only keep (INCLUDE) the rows that were matched between the two tables</li>
</ul>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="tidy_data.html#cb741-1" aria-hidden="true" tabindex="-1"></a>joined <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb741-2"><a href="tidy_data.html#cb741-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(top_dest)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(dest)`</code></pre>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="tidy_data.html#cb743-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtered <span class="sc">==</span> joined)</span></code></pre></div>
<pre><code>##      year month  day dep_time sched_dep_time dep_delay arr_time sched_arr_time
## [1,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
## [2,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
## [3,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
## [4,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
## [5,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
## [6,] TRUE  TRUE TRUE     TRUE           TRUE      TRUE     TRUE           TRUE
##      arr_delay carrier flight tailnum origin dest air_time distance hour minute
## [1,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
## [2,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
## [3,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
## [4,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
## [5,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
## [6,]      TRUE    TRUE   TRUE    TRUE   TRUE TRUE     TRUE     TRUE TRUE   TRUE
##      time_hour
## [1,]      TRUE
## [2,]      TRUE
## [3,]      TRUE
## [4,]      TRUE
## [5,]      TRUE
## [6,]      TRUE</code></pre>
<ul>
<li>Anti Join</li>
</ul>
<p><code>anti_join()</code> does the opposite. Exclude the rows that were matched between the two tables. A great technique to filter stopwords when you do computational text analysis.</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="tidy_data.html#cb745-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb745-2"><a href="tidy_data.html#cb745-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(planes, <span class="at">by =</span> <span class="st">&quot;tailnum&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb745-3"><a href="tidy_data.html#cb745-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tailnum, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 722 × 2
##    tailnum     n
##    &lt;chr&gt;   &lt;int&gt;
##  1 &lt;NA&gt;     2512
##  2 N725MQ    575
##  3 N722MQ    513
##  4 N723MQ    507
##  5 N713MQ    483
##  6 N735MQ    396
##  7 N0EGMQ    371
##  8 N534MQ    364
##  9 N542MQ    363
## 10 N531MQ    349
## # ℹ 712 more rows</code></pre>
</div>
</div>
</div>
<div id="modeling-broom" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Modeling (broom)<a href="tidy_data.html#modeling-broom" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="nesting" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Nesting<a href="tidy_data.html#nesting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="nest" class="section level4 hasAnchor" number="4.6.1.1">
<h4><span class="header-section-number">4.6.1.1</span> nest<a href="tidy_data.html#nest" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The following example comes from <a href="https://r4ds.had.co.nz/many-models.html">R for Data Science</a> by Garrett Grolemund and Hadley Wickham.</p>
<ul>
<li>How can you run multiple models simultaneously? Using a nested data frame.</li>
</ul>

<iframe width="560" height="315" src="https://www.youtube.com/embed/rz3_FDVt9eg" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p> Hadley Wickham: Managing many models with R </p>
<ul>
<li><p><strong>Grouped data: each row = an observation</strong></p></li>
<li><p><strong>Nested data: each row = a group</strong></p></li>
</ul>
<p><strong>Challenge</strong></p>
<p>Why did we use <code>country</code> and <code>continent</code> for nesting variables in the following example?</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="tidy_data.html#cb747-1" aria-hidden="true" tabindex="-1"></a>nested <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb747-2"><a href="tidy_data.html#cb747-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, continent) <span class="sc">%&gt;%</span></span>
<span id="cb747-3"><a href="tidy_data.html#cb747-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>()</span>
<span id="cb747-4"><a href="tidy_data.html#cb747-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb747-5"><a href="tidy_data.html#cb747-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nested)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
## # Groups:   country, continent [6]
##   country     continent data             
##   &lt;fct&gt;       &lt;fct&gt;     &lt;list&gt;           
## 1 Afghanistan Asia      &lt;tibble [12 × 4]&gt;
## 2 Albania     Europe    &lt;tibble [12 × 4]&gt;
## 3 Algeria     Africa    &lt;tibble [12 × 4]&gt;
## 4 Angola      Africa    &lt;tibble [12 × 4]&gt;
## 5 Argentina   Americas  &lt;tibble [12 × 4]&gt;
## 6 Australia   Oceania   &lt;tibble [12 × 4]&gt;</code></pre>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="tidy_data.html#cb749-1" aria-hidden="true" tabindex="-1"></a>nested<span class="sc">$</span>data <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
##     year lifeExp      pop gdpPercap
##    &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1  1952    28.8  8425333      779.
##  2  1957    30.3  9240934      821.
##  3  1962    32.0 10267083      853.
##  4  1967    34.0 11537966      836.
##  5  1972    36.1 13079460      740.
##  6  1977    38.4 14880372      786.
##  7  1982    39.9 12881816      978.
##  8  1987    40.8 13867957      852.
##  9  1992    41.7 16317921      649.
## 10  1997    41.8 22227415      635.
## 11  2002    42.1 25268405      727.
## 12  2007    43.8 31889923      975.</code></pre>
<ul>
<li>Custom function</li>
</ul>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="tidy_data.html#cb751-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb751-2"><a href="tidy_data.html#cb751-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year, <span class="at">data =</span> df)</span>
<span id="cb751-3"><a href="tidy_data.html#cb751-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>Apply function to the nested data</li>
</ul>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="tidy_data.html#cb752-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply m_model to the nested data</span></span>
<span id="cb752-2"><a href="tidy_data.html#cb752-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb752-3"><a href="tidy_data.html#cb752-3" aria-hidden="true" tabindex="-1"></a>nested <span class="ot">&lt;-</span> nested <span class="sc">%&gt;%</span></span>
<span id="cb752-4"><a href="tidy_data.html#cb752-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">models =</span> <span class="fu">map</span>(data, lm_model)) <span class="co"># Add the list object as a new column</span></span>
<span id="cb752-5"><a href="tidy_data.html#cb752-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb752-6"><a href="tidy_data.html#cb752-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nested)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
## # Groups:   country, continent [6]
##   country     continent data              models
##   &lt;fct&gt;       &lt;fct&gt;     &lt;list&gt;            &lt;list&gt;
## 1 Afghanistan Asia      &lt;tibble [12 × 4]&gt; &lt;lm&gt;  
## 2 Albania     Europe    &lt;tibble [12 × 4]&gt; &lt;lm&gt;  
## 3 Algeria     Africa    &lt;tibble [12 × 4]&gt; &lt;lm&gt;  
## 4 Angola      Africa    &lt;tibble [12 × 4]&gt; &lt;lm&gt;  
## 5 Argentina   Americas  &lt;tibble [12 × 4]&gt; &lt;lm&gt;  
## 6 Australia   Oceania   &lt;tibble [12 × 4]&gt; &lt;lm&gt;</code></pre>
<p>S3 is part of R’s object-oriented systems. If you need further information, check out <a href="http://adv-r.had.co.nz/S3.html">this section</a> in Hadley’s Advanced R.</p>
</div>
<div id="unnest" class="section level4 hasAnchor" number="4.6.1.2">
<h4><span class="header-section-number">4.6.1.2</span> unnest<a href="tidy_data.html#unnest" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>glance()</li>
</ul>
<p><code>glance()</code> function from <code>broom</code> package inspects the quality of a statistical model.</p>
<p><strong>Additional tips</strong></p>
<ul>
<li><code>broom::glance(model)</code>: for evaluating model quality and/or complexity</li>
<li><code>broom::tidy(model)</code>: for extracting each coefficient in the model (the estimates + its variability)</li>
<li><code>broom::augment(model, data)</code>: for getting extra values (residuals, and influence statistics). A convenient tool if you want to plot fitted values and raw data together.</li>
</ul>
<div class="figure">
<img src="https://www.youtube.com/watch?v=7VGPUBWGv6g&amp;ab_channel=Work-Bench" alt="" />
<p class="caption">Broom: Converting Statistical Models to Tidy Data Frames by David Robinson</p>
</div>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="tidy_data.html#cb754-1" aria-hidden="true" tabindex="-1"></a>glanced <span class="ot">&lt;-</span> nested <span class="sc">%&gt;%</span></span>
<span id="cb754-2"><a href="tidy_data.html#cb754-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">glance =</span> <span class="fu">map</span>(models, broom<span class="sc">::</span>glance))</span>
<span id="cb754-3"><a href="tidy_data.html#cb754-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb754-4"><a href="tidy_data.html#cb754-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pluck the first item on the list</span></span>
<span id="cb754-5"><a href="tidy_data.html#cb754-5" aria-hidden="true" tabindex="-1"></a>glanced<span class="sc">$</span>glance <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic      p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.948         0.942  1.22      181. 0.0000000984     1  -18.3  42.7  44.1
## # ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="tidy_data.html#cb756-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull p.value</span></span>
<span id="cb756-2"><a href="tidy_data.html#cb756-2" aria-hidden="true" tabindex="-1"></a>glanced<span class="sc">$</span>glance <span class="sc">%&gt;%</span></span>
<span id="cb756-3"><a href="tidy_data.html#cb756-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb756-4"><a href="tidy_data.html#cb756-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p.value)</span></code></pre></div>
<pre><code>##        value 
## 9.835213e-08</code></pre>
<p><code>unnest()</code> unpacks the list objects stored in the <code>glanced</code> column</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="tidy_data.html#cb758-1" aria-hidden="true" tabindex="-1"></a>glanced <span class="sc">%&gt;%</span></span>
<span id="cb758-2"><a href="tidy_data.html#cb758-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glance) <span class="sc">%&gt;%</span></span>
<span id="cb758-3"><a href="tidy_data.html#cb758-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(r.squared)</span></code></pre></div>
<pre><code>## # A tibble: 142 × 16
## # Groups:   country, continent [142]
##    country     continent data     models r.squared adj.r.squared sigma statistic
##    &lt;fct&gt;       &lt;fct&gt;     &lt;list&gt;   &lt;list&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
##  1 Rwanda      Africa    &lt;tibble&gt; &lt;lm&gt;      0.0172      -0.0811   6.56     0.175
##  2 Botswana    Africa    &lt;tibble&gt; &lt;lm&gt;      0.0340      -0.0626   6.11     0.352
##  3 Zimbabwe    Africa    &lt;tibble&gt; &lt;lm&gt;      0.0562      -0.0381   7.21     0.596
##  4 Zambia      Africa    &lt;tibble&gt; &lt;lm&gt;      0.0598      -0.0342   4.53     0.636
##  5 Swaziland   Africa    &lt;tibble&gt; &lt;lm&gt;      0.0682      -0.0250   6.64     0.732
##  6 Lesotho     Africa    &lt;tibble&gt; &lt;lm&gt;      0.0849      -0.00666  5.93     0.927
##  7 Cote d&#39;Ivo… Africa    &lt;tibble&gt; &lt;lm&gt;      0.283        0.212    3.93     3.95 
##  8 South Afri… Africa    &lt;tibble&gt; &lt;lm&gt;      0.312        0.244    4.74     4.54 
##  9 Uganda      Africa    &lt;tibble&gt; &lt;lm&gt;      0.342        0.276    3.19     5.20 
## 10 Congo, Dem… Africa    &lt;tibble&gt; &lt;lm&gt;      0.348        0.283    2.43     5.34 
## # ℹ 132 more rows
## # ℹ 8 more variables: p.value &lt;dbl&gt;, df &lt;dbl&gt;, logLik &lt;dbl&gt;, AIC &lt;dbl&gt;,
## #   BIC &lt;dbl&gt;, deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="tidy_data.html#cb760-1" aria-hidden="true" tabindex="-1"></a>glanced <span class="sc">%&gt;%</span></span>
<span id="cb760-2"><a href="tidy_data.html#cb760-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(glance) <span class="sc">%&gt;%</span></span>
<span id="cb760-3"><a href="tidy_data.html#cb760-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(continent, r.squared)) <span class="sc">+</span></span>
<span id="cb760-4"><a href="tidy_data.html#cb760-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
<ul>
<li>tidy()</li>
</ul>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="tidy_data.html#cb761-1" aria-hidden="true" tabindex="-1"></a>nested <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb761-2"><a href="tidy_data.html#cb761-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb761-3"><a href="tidy_data.html#cb761-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>()</span>
<span id="cb761-4"><a href="tidy_data.html#cb761-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb761-5"><a href="tidy_data.html#cb761-5" aria-hidden="true" tabindex="-1"></a>nested <span class="ot">&lt;-</span> nested <span class="sc">%&gt;%</span></span>
<span id="cb761-6"><a href="tidy_data.html#cb761-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">models =</span> <span class="fu">map</span>(data, <span class="sc">~</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year <span class="sc">+</span> country, <span class="at">data =</span> .)))</span>
<span id="cb761-7"><a href="tidy_data.html#cb761-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb761-8"><a href="tidy_data.html#cb761-8" aria-hidden="true" tabindex="-1"></a>tidied <span class="ot">&lt;-</span> nested <span class="sc">%&gt;%</span></span>
<span id="cb761-9"><a href="tidy_data.html#cb761-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tidied =</span> <span class="fu">map</span>(models, broom<span class="sc">::</span>tidy))</span>
<span id="cb761-10"><a href="tidy_data.html#cb761-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb761-11"><a href="tidy_data.html#cb761-11" aria-hidden="true" tabindex="-1"></a>model_out <span class="ot">&lt;-</span> tidied <span class="sc">%&gt;%</span></span>
<span id="cb761-12"><a href="tidy_data.html#cb761-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidied) <span class="sc">%&gt;%</span></span>
<span id="cb761-13"><a href="tidy_data.html#cb761-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">str_replace</span>(term, <span class="st">&quot;country&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb761-14"><a href="tidy_data.html#cb761-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(continent, term, estimate, p.value) <span class="sc">%&gt;%</span></span>
<span id="cb761-15"><a href="tidy_data.html#cb761-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_threshold =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb761-16"><a href="tidy_data.html#cb761-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb761-17"><a href="tidy_data.html#cb761-17" aria-hidden="true" tabindex="-1"></a>model_out <span class="sc">%&gt;%</span></span>
<span id="cb761-18"><a href="tidy_data.html#cb761-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_threshold <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb761-19"><a href="tidy_data.html#cb761-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb761-20"><a href="tidy_data.html#cb761-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span></code></pre></div>
<pre><code>##   [1] &quot;(Intercept)&quot;              &quot;year&quot;                    
##   [3] &quot;Bahrain&quot;                  &quot;Bangladesh&quot;              
##   [5] &quot;Cambodia&quot;                 &quot;China&quot;                   
##   [7] &quot;Hong Kong, China&quot;         &quot;India&quot;                   
##   [9] &quot;Indonesia&quot;                &quot;Iran&quot;                    
##  [11] &quot;Iraq&quot;                     &quot;Israel&quot;                  
##  [13] &quot;Japan&quot;                    &quot;Jordan&quot;                  
##  [15] &quot;Korea, Dem. Rep.&quot;         &quot;Korea, Rep.&quot;             
##  [17] &quot;Kuwait&quot;                   &quot;Lebanon&quot;                 
##  [19] &quot;Malaysia&quot;                 &quot;Mongolia&quot;                
##  [21] &quot;Myanmar&quot;                  &quot;Nepal&quot;                   
##  [23] &quot;Oman&quot;                     &quot;Pakistan&quot;                
##  [25] &quot;Philippines&quot;              &quot;Saudi Arabia&quot;            
##  [27] &quot;Singapore&quot;                &quot;Sri Lanka&quot;               
##  [29] &quot;Syria&quot;                    &quot;Taiwan&quot;                  
##  [31] &quot;Thailand&quot;                 &quot;Vietnam&quot;                 
##  [33] &quot;West Bank and Gaza&quot;       &quot;Yemen, Rep.&quot;             
##  [35] &quot;Austria&quot;                  &quot;Belgium&quot;                 
##  [37] &quot;Croatia&quot;                  &quot;Czech Republic&quot;          
##  [39] &quot;Denmark&quot;                  &quot;Finland&quot;                 
##  [41] &quot;France&quot;                   &quot;Germany&quot;                 
##  [43] &quot;Greece&quot;                   &quot;Iceland&quot;                 
##  [45] &quot;Ireland&quot;                  &quot;Italy&quot;                   
##  [47] &quot;Montenegro&quot;               &quot;Netherlands&quot;             
##  [49] &quot;Norway&quot;                   &quot;Poland&quot;                  
##  [51] &quot;Portugal&quot;                 &quot;Slovak Republic&quot;         
##  [53] &quot;Slovenia&quot;                 &quot;Spain&quot;                   
##  [55] &quot;Sweden&quot;                   &quot;Switzerland&quot;             
##  [57] &quot;Turkey&quot;                   &quot;United Kingdom&quot;          
##  [59] &quot;Angola&quot;                   &quot;Benin&quot;                   
##  [61] &quot;Botswana&quot;                 &quot;Burkina Faso&quot;            
##  [63] &quot;Burundi&quot;                  &quot;Cameroon&quot;                
##  [65] &quot;Central African Republic&quot; &quot;Chad&quot;                    
##  [67] &quot;Comoros&quot;                  &quot;Congo, Dem. Rep.&quot;        
##  [69] &quot;Congo, Rep.&quot;              &quot;Cote d&#39;Ivoire&quot;           
##  [71] &quot;Djibouti&quot;                 &quot;Equatorial Guinea&quot;       
##  [73] &quot;Eritrea&quot;                  &quot;Ethiopia&quot;                
##  [75] &quot;Gabon&quot;                    &quot;Gambia&quot;                  
##  [77] &quot;Ghana&quot;                    &quot;Guinea&quot;                  
##  [79] &quot;Guinea-Bissau&quot;            &quot;Kenya&quot;                   
##  [81] &quot;Lesotho&quot;                  &quot;Liberia&quot;                 
##  [83] &quot;Madagascar&quot;               &quot;Malawi&quot;                  
##  [85] &quot;Mali&quot;                     &quot;Mauritania&quot;              
##  [87] &quot;Mauritius&quot;                &quot;Mozambique&quot;              
##  [89] &quot;Namibia&quot;                  &quot;Niger&quot;                   
##  [91] &quot;Nigeria&quot;                  &quot;Reunion&quot;                 
##  [93] &quot;Rwanda&quot;                   &quot;Senegal&quot;                 
##  [95] &quot;Sierra Leone&quot;             &quot;Somalia&quot;                 
##  [97] &quot;South Africa&quot;             &quot;Sudan&quot;                   
##  [99] &quot;Swaziland&quot;                &quot;Tanzania&quot;                
## [101] &quot;Togo&quot;                     &quot;Uganda&quot;                  
## [103] &quot;Zambia&quot;                   &quot;Zimbabwe&quot;                
## [105] &quot;Bolivia&quot;                  &quot;Brazil&quot;                  
## [107] &quot;Canada&quot;                   &quot;Colombia&quot;                
## [109] &quot;Dominican Republic&quot;       &quot;Ecuador&quot;                 
## [111] &quot;El Salvador&quot;              &quot;Guatemala&quot;               
## [113] &quot;Haiti&quot;                    &quot;Honduras&quot;                
## [115] &quot;Mexico&quot;                   &quot;Nicaragua&quot;               
## [117] &quot;Paraguay&quot;                 &quot;Peru&quot;                    
## [119] &quot;Puerto Rico&quot;              &quot;Trinidad and Tobago&quot;     
## [121] &quot;United States&quot;            &quot;Venezuela&quot;               
## [123] &quot;New Zealand&quot;</code></pre>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="tidy_data.html#cb763-1" aria-hidden="true" tabindex="-1"></a>model_out <span class="sc">%&gt;%</span></span>
<span id="cb763-2"><a href="tidy_data.html#cb763-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_threshold <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb763-3"><a href="tidy_data.html#cb763-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb763-4"><a href="tidy_data.html#cb763-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span></code></pre></div>
<pre><code>##  [1] &quot;Bosnia and Herzegovina&quot; &quot;Bulgaria&quot;               &quot;Hungary&quot;               
##  [4] &quot;Romania&quot;                &quot;Serbia&quot;                 &quot;Egypt&quot;                 
##  [7] &quot;Libya&quot;                  &quot;Morocco&quot;                &quot;Sao Tome and Principe&quot; 
## [10] &quot;Tunisia&quot;                &quot;Chile&quot;                  &quot;Costa Rica&quot;            
## [13] &quot;Cuba&quot;                   &quot;Jamaica&quot;                &quot;Panama&quot;                
## [16] &quot;Uruguay&quot;</code></pre>
</div>
</div>
<div id="mapping" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Mapping<a href="tidy_data.html#mapping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We tasted a bit of how <code>map()</code> function works. Let’s dig into it more in-depth, as this family of functions is useful. See Rebecca Barter’s excellent tutorial on the <code>purrr</code> package for more information. In her words, this is “the tidyverse’s answer to apply functions for iteration”. <code>map()</code> function can take a vector (of any type), a list, and a dataframe for input.</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="tidy_data.html#cb765-1" aria-hidden="true" tabindex="-1"></a>multiply <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb765-2"><a href="tidy_data.html#cb765-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">*</span> x</span>
<span id="cb765-3"><a href="tidy_data.html#cb765-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb765-4"><a href="tidy_data.html#cb765-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb765-5"><a href="tidy_data.html#cb765-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb765-6"><a href="tidy_data.html#cb765-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">first_obs =</span> <span class="fu">rnorm</span>(<span class="dv">7</span>, <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb765-7"><a href="tidy_data.html#cb765-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">second_obs =</span> <span class="fu">rnorm</span>(<span class="dv">7</span>, <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb765-8"><a href="tidy_data.html#cb765-8" aria-hidden="true" tabindex="-1"></a>) <span class="co"># normal distribution</span></span></code></pre></div>
<p><strong>Challenge</strong></p>
<p>Try <code>map_df(.x = df, .f = multiply)</code> and tell me what’s the difference between the output you got and what you saw earlier.</p>
<p>If you want to know more about the power and joy of functional programming in R (e.g., <code>purrr::map()</code>), then please take <a href="https://github.com/dlab-berkeley/R-functional-programming">“How to Automate Repeated Things in R”</a> workshop.</p>
</div>
</div>
<div id="visualizing-ggplot2" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Visualizing (ggplot2)<a href="tidy_data.html#visualizing-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>The following material is adapted from Kieran Healy’s excellent book (2019) on <a href="https://socviz.co/">data visualization</a> and Hadley Wickham’s equally excellent book on <a href="https://ggplot2-book.org/">ggplot2</a>. For more theoretical discussions, I recommend you to read <a href="https://link.springer.com/book/10.1007%2F0-387-28695-0">The Grammar of Graphics</a> by Leland Wilkinson.</p></li>
<li><p>Why should we care about data visualization? More precisely, why should we learn the grammar of statistical graphics?</p></li>
<li><p>Sometimes, pictures are better tools than words in 1) exploring, 2) understanding, and 3) explaining data.</p></li>
</ul>
<div id="motivation-2" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Motivation<a href="tidy_data.html#motivation-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://en.wikipedia.org/wiki/Frank_Anscombe">Anscombe</a>’s quarter comprises four datasets, which are so alike in terms of their descriptive statistics but quite different when presented graphically.</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="tidy_data.html#cb766-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set theme</span></span>
<span id="cb766-2"><a href="tidy_data.html#cb766-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code></pre></div>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="tidy_data.html#cb767-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb767-2"><a href="tidy_data.html#cb767-2" aria-hidden="true" tabindex="-1"></a>anscombe</span></code></pre></div>
<pre><code>##    x1 x2 x3 x4    y1   y2    y3    y4
## 1  10 10 10  8  8.04 9.14  7.46  6.58
## 2   8  8  8  8  6.95 8.14  6.77  5.76
## 3  13 13 13  8  7.58 8.74 12.74  7.71
## 4   9  9  9  8  8.81 8.77  7.11  8.84
## 5  11 11 11  8  8.33 9.26  7.81  8.47
## 6  14 14 14  8  9.96 8.10  8.84  7.04
## 7   6  6  6  8  7.24 6.13  6.08  5.25
## 8   4  4  4 19  4.26 3.10  5.39 12.50
## 9  12 12 12  8 10.84 9.13  8.15  5.56
## 10  7  7  7  8  4.82 7.26  6.42  7.91
## 11  5  5  5  8  5.68 4.74  5.73  6.89</code></pre>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="tidy_data.html#cb769-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation</span></span>
<span id="cb769-2"><a href="tidy_data.html#cb769-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anscombe)[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>)]</span></code></pre></div>
<pre><code>##            y1         y2         y3         y4
## x1  0.8164205  0.8162365  0.8162867 -0.3140467
## x2  0.8164205  0.8162365  0.8162867 -0.3140467
## x3  0.8164205  0.8162365  0.8162867 -0.3140467
## x4 -0.5290927 -0.7184365 -0.3446610  0.8165214</code></pre>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="tidy_data.html#cb771-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gather and select</span></span>
<span id="cb771-2"><a href="tidy_data.html#cb771-2" aria-hidden="true" tabindex="-1"></a>anscombe_processed <span class="ot">&lt;-</span> anscombe <span class="sc">%&gt;%</span></span>
<span id="cb771-3"><a href="tidy_data.html#cb771-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(x_name, x_value, x1<span class="sc">:</span>x4) <span class="sc">%&gt;%</span></span>
<span id="cb771-4"><a href="tidy_data.html#cb771-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(y_name, y_value, y1<span class="sc">:</span>y4)</span>
<span id="cb771-5"><a href="tidy_data.html#cb771-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb771-6"><a href="tidy_data.html#cb771-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb771-7"><a href="tidy_data.html#cb771-7" aria-hidden="true" tabindex="-1"></a>anscombe_processed <span class="sc">%&gt;%</span></span>
<span id="cb771-8"><a href="tidy_data.html#cb771-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_value, <span class="at">y =</span> y_value)) <span class="sc">+</span></span>
<span id="cb771-9"><a href="tidy_data.html#cb771-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb771-10"><a href="tidy_data.html#cb771-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb771-11"><a href="tidy_data.html#cb771-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(x_name <span class="sc">~</span> y_name) <span class="sc">+</span></span>
<span id="cb771-12"><a href="tidy_data.html#cb771-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb771-13"><a href="tidy_data.html#cb771-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb771-14"><a href="tidy_data.html#cb771-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X values&quot;</span>,</span>
<span id="cb771-15"><a href="tidy_data.html#cb771-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Y values&quot;</span>,</span>
<span id="cb771-16"><a href="tidy_data.html#cb771-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Anscombe&#39;s quartet&quot;</span></span>
<span id="cb771-17"><a href="tidy_data.html#cb771-17" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
</div>
<div id="the-grammar-of-graphics" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> The grammar of graphics<a href="tidy_data.html#the-grammar-of-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>the grammar of graphics</p>
<ul>
<li>data</li>
<li>aesthetic attributes (color, shape, size)</li>
<li>geometric objects (points, lines, bars)</li>
<li>stats (summary stats)</li>
<li>scales (map values in the data space)</li>
<li>coord (data coordinates)</li>
<li>facet (facetting specifications)</li>
</ul></li>
</ul>
<p>No worries about new terms. We’re going to learn them by actually plotting.</p>
<ul>
<li><p>Workflow:</p>
<ol style="list-style-type: decimal">
<li>Tidy data</li>
<li>Mapping</li>
<li>Geom</li>
<li>Cor_ordinates and scales</li>
<li>Labels and guides</li>
<li>Themes</li>
<li>Save files</li>
</ol></li>
</ul>
</div>
<div id="mapping-and-geom" class="section level3 hasAnchor" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> mapping and geom<a href="tidy_data.html#mapping-and-geom" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><code>aes</code> (aesthetic mappings or aesthetics) tells which variables (x, y) in your data should be represented by which visual elements (color, shape, size) in the plot.</p></li>
<li><p><code>geom_</code> tells the type of plot you are going to use</p></li>
</ul>
</div>
<div id="basic-aes-x-y" class="section level3 hasAnchor" number="4.7.4">
<h3><span class="header-section-number">4.7.4</span> basic aes (x , y)<a href="tidy_data.html#basic-aes-x-y" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="tidy_data.html#cb773-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb773-2"><a href="tidy_data.html#cb773-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gapminder,</span>
<span id="cb773-3"><a href="tidy_data.html#cb773-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)</span>
<span id="cb773-4"><a href="tidy_data.html#cb773-4" aria-hidden="true" tabindex="-1"></a>) <span class="co"># ggplot or R in general takes positional arguments too. So, you don&#39;t need to name data, mapping each time you use ggplot2.</span></span>
<span id="cb773-5"><a href="tidy_data.html#cb773-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb773-6"><a href="tidy_data.html#cb773-6" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="tidy_data.html#cb774-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-174-2.png" width="672" /></p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="tidy_data.html#cb775-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>() <span class="co"># geom_smooth has calculated a smoothed line;</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula = &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-174-3.png" width="672" /></p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="tidy_data.html#cb777-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the shaded area is the standard error for the line</span></span></code></pre></div>
</div>
<div id="univariate-distribution" class="section level3 hasAnchor" number="4.7.5">
<h3><span class="header-section-number">4.7.5</span> Univariate distribution<a href="tidy_data.html#univariate-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><code>geom_histogram()</code>: For the probability distribution of a continuous variable. Bins divide the entire range of values into a series of intervals (see <a href="https://en.wikipedia.org/wiki/Histogram">the Wiki entry</a>).</li>
<li><code>geom_density()</code>: Also for the probability distribution of a continuous variable. It calculates a <a href="https://en.wikipedia.org/wiki/Kernel_density_estimation">kernel density estimate</a> of the underlying distribution.</li>
</ul>
<div id="histogram" class="section level4 hasAnchor" number="4.7.5.1">
<h4><span class="header-section-number">4.7.5.1</span> Histogram<a href="tidy_data.html#histogram" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="tidy_data.html#cb778-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(midwest) <span class="co"># load midwest dataset</span></span>
<span id="cb778-2"><a href="tidy_data.html#cb778-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb778-3"><a href="tidy_data.html#cb778-3" aria-hidden="true" tabindex="-1"></a>midwest</span></code></pre></div>
<pre><code>## # A tibble: 437 × 28
##      PID county  state  area poptotal popdensity popwhite popblack popamerindian
##    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;    &lt;int&gt;      &lt;dbl&gt;    &lt;int&gt;    &lt;int&gt;         &lt;int&gt;
##  1   561 ADAMS   IL    0.052    66090      1271.    63917     1702            98
##  2   562 ALEXAN… IL    0.014    10626       759      7054     3496            19
##  3   563 BOND    IL    0.022    14991       681.    14477      429            35
##  4   564 BOONE   IL    0.017    30806      1812.    29344      127            46
##  5   565 BROWN   IL    0.018     5836       324.     5264      547            14
##  6   566 BUREAU  IL    0.05     35688       714.    35157       50            65
##  7   567 CALHOUN IL    0.017     5322       313.     5298        1             8
##  8   568 CARROLL IL    0.027    16805       622.    16519      111            30
##  9   569 CASS    IL    0.024    13437       560.    13384       16             8
## 10   570 CHAMPA… IL    0.058   173025      2983.   146506    16559           331
## # ℹ 427 more rows
## # ℹ 19 more variables: popasian &lt;int&gt;, popother &lt;int&gt;, percwhite &lt;dbl&gt;,
## #   percblack &lt;dbl&gt;, percamerindan &lt;dbl&gt;, percasian &lt;dbl&gt;, percother &lt;dbl&gt;,
## #   popadults &lt;int&gt;, perchsd &lt;dbl&gt;, percollege &lt;dbl&gt;, percprof &lt;dbl&gt;,
## #   poppovertyknown &lt;int&gt;, percpovertyknown &lt;dbl&gt;, percbelowpoverty &lt;dbl&gt;,
## #   percchildbelowpovert &lt;dbl&gt;, percadultpoverty &lt;dbl&gt;,
## #   percelderlypoverty &lt;dbl&gt;, inmetro &lt;int&gt;, category &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="tidy_data.html#cb780-1" aria-hidden="true" tabindex="-1"></a>midwest <span class="sc">%&gt;%</span></span>
<span id="cb780-2"><a href="tidy_data.html#cb780-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area)) <span class="sc">+</span></span>
<span id="cb780-3"><a href="tidy_data.html#cb780-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co"># not working.</span></span></code></pre></div>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="tidy_data.html#cb781-1" aria-hidden="true" tabindex="-1"></a>midwest <span class="sc">%&gt;%</span></span>
<span id="cb781-2"><a href="tidy_data.html#cb781-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area)) <span class="sc">+</span></span>
<span id="cb781-3"><a href="tidy_data.html#cb781-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="co"># stat_bin argument picks up 30 bins (or &quot;bucket&quot;) by default.</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-177-1.png" width="672" /></p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="tidy_data.html#cb783-1" aria-hidden="true" tabindex="-1"></a>midwest <span class="sc">%&gt;%</span></span>
<span id="cb783-2"><a href="tidy_data.html#cb783-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area)) <span class="sc">+</span></span>
<span id="cb783-3"><a href="tidy_data.html#cb783-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>) <span class="co"># only 10 bins.</span></span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-177-2.png" width="672" /></p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="tidy_data.html#cb784-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb784-2"><a href="tidy_data.html#cb784-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">subset</span>(midwest, state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;OH&quot;</span>, <span class="st">&quot;IN&quot;</span>)),</span>
<span id="cb784-3"><a href="tidy_data.html#cb784-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> percollege, <span class="at">fill =</span> state)</span>
<span id="cb784-4"><a href="tidy_data.html#cb784-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb784-5"><a href="tidy_data.html#cb784-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb784-6"><a href="tidy_data.html#cb784-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-177-3.png" width="672" /></p>
</div>
<div id="density" class="section level4 hasAnchor" number="4.7.5.2">
<h4><span class="header-section-number">4.7.5.2</span> Density<a href="tidy_data.html#density" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="tidy_data.html#cb785-1" aria-hidden="true" tabindex="-1"></a>midwest <span class="sc">%&gt;%</span></span>
<span id="cb785-2"><a href="tidy_data.html#cb785-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area, <span class="at">fill =</span> state, <span class="at">color =</span> state)) <span class="sc">+</span></span>
<span id="cb785-3"><a href="tidy_data.html#cb785-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb785-4"><a href="tidy_data.html#cb785-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb785-5"><a href="tidy_data.html#cb785-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
</div>
</div>
<div id="advanced-aes-size-color" class="section level3 hasAnchor" number="4.7.6">
<h3><span class="header-section-number">4.7.6</span> Advanced aes (size, color)<a href="tidy_data.html#advanced-aes-size-color" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>There’s also <code>fill</code> argument (mostly used in <code>geom_bar()</code>). Color <code>aes</code> affects the appearance of lines and points, fill is for the filled areas of bars, polygons, and in some cases, the interior of a smoother’s standard error ribbon.</p></li>
<li><p>The property size/color/fill represents…</p></li>
</ul>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="tidy_data.html#cb786-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb786-2"><a href="tidy_data.html#cb786-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gapminder,</span>
<span id="cb786-3"><a href="tidy_data.html#cb786-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb786-4"><a href="tidy_data.html#cb786-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp,</span>
<span id="cb786-5"><a href="tidy_data.html#cb786-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> pop</span>
<span id="cb786-6"><a href="tidy_data.html#cb786-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb786-7"><a href="tidy_data.html#cb786-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb786-8"><a href="tidy_data.html#cb786-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="tidy_data.html#cb787-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb787-2"><a href="tidy_data.html#cb787-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gapminder,</span>
<span id="cb787-3"><a href="tidy_data.html#cb787-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb787-4"><a href="tidy_data.html#cb787-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp,</span>
<span id="cb787-5"><a href="tidy_data.html#cb787-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> pop,</span>
<span id="cb787-6"><a href="tidy_data.html#cb787-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> continent</span>
<span id="cb787-7"><a href="tidy_data.html#cb787-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb787-8"><a href="tidy_data.html#cb787-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb787-9"><a href="tidy_data.html#cb787-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb787-10"><a href="tidy_data.html#cb787-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="tidy_data.html#cb788-1" aria-hidden="true" tabindex="-1"></a><span class="co"># try red instead of &quot;red&quot;</span></span>
<span id="cb788-2"><a href="tidy_data.html#cb788-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb788-3"><a href="tidy_data.html#cb788-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gapminder,</span>
<span id="cb788-4"><a href="tidy_data.html#cb788-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb788-5"><a href="tidy_data.html#cb788-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp,</span>
<span id="cb788-6"><a href="tidy_data.html#cb788-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> pop,</span>
<span id="cb788-7"><a href="tidy_data.html#cb788-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb788-8"><a href="tidy_data.html#cb788-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb788-9"><a href="tidy_data.html#cb788-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb788-10"><a href="tidy_data.html#cb788-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-181-1.png" width="672" /></p>
<p>Aesthetics also can be mapped per Geom.</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="tidy_data.html#cb789-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb789-2"><a href="tidy_data.html#cb789-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula = &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-182-1.png" width="672" /></p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="tidy_data.html#cb791-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="co"># alpha controls transparency</span></span>
<span id="cb791-2"><a href="tidy_data.html#cb791-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula = &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-182-2.png" width="672" /></p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="tidy_data.html#cb794-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> <span class="co"># alpha controls transparency</span></span>
<span id="cb794-2"><a href="tidy_data.html#cb794-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-182-3.png" width="672" /></p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="tidy_data.html#cb796-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb796-2"><a href="tidy_data.html#cb796-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gapminder,</span>
<span id="cb796-3"><a href="tidy_data.html#cb796-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb796-4"><a href="tidy_data.html#cb796-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp,</span>
<span id="cb796-5"><a href="tidy_data.html#cb796-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> continent</span>
<span id="cb796-6"><a href="tidy_data.html#cb796-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb796-7"><a href="tidy_data.html#cb796-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb796-8"><a href="tidy_data.html#cb796-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb796-9"><a href="tidy_data.html#cb796-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb796-10"><a href="tidy_data.html#cb796-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb796-11"><a href="tidy_data.html#cb796-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;log GDP&quot;</span>,</span>
<span id="cb796-12"><a href="tidy_data.html#cb796-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life Expectancy&quot;</span>,</span>
<span id="cb796-13"><a href="tidy_data.html#cb796-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;A Gapminder Plot&quot;</span>,</span>
<span id="cb796-14"><a href="tidy_data.html#cb796-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Data points are country-years&quot;</span>,</span>
<span id="cb796-15"><a href="tidy_data.html#cb796-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Source: Gapminder&quot;</span></span>
<span id="cb796-16"><a href="tidy_data.html#cb796-16" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="tidy_data.html#cb798-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb798-2"><a href="tidy_data.html#cb798-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gapminder,</span>
<span id="cb798-3"><a href="tidy_data.html#cb798-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb798-4"><a href="tidy_data.html#cb798-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp,</span>
<span id="cb798-5"><a href="tidy_data.html#cb798-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> continent,</span>
<span id="cb798-6"><a href="tidy_data.html#cb798-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> continent</span>
<span id="cb798-7"><a href="tidy_data.html#cb798-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb798-8"><a href="tidy_data.html#cb798-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb798-9"><a href="tidy_data.html#cb798-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb798-10"><a href="tidy_data.html#cb798-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb798-11"><a href="tidy_data.html#cb798-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb798-12"><a href="tidy_data.html#cb798-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;log GDP&quot;</span>,</span>
<span id="cb798-13"><a href="tidy_data.html#cb798-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life Expectancy&quot;</span>,</span>
<span id="cb798-14"><a href="tidy_data.html#cb798-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;A Gapminder Plot&quot;</span>,</span>
<span id="cb798-15"><a href="tidy_data.html#cb798-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Data points are country-years&quot;</span>,</span>
<span id="cb798-16"><a href="tidy_data.html#cb798-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Source: Gapminder&quot;</span></span>
<span id="cb798-17"><a href="tidy_data.html#cb798-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb798-18"><a href="tidy_data.html#cb798-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb798-19"><a href="tidy_data.html#cb798-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-183-2.png" width="672" /></p>
</div>
<div id="co-ordinates-and-scales" class="section level3 hasAnchor" number="4.7.7">
<h3><span class="header-section-number">4.7.7</span> Co-ordinates and scales<a href="tidy_data.html#co-ordinates-and-scales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="tidy_data.html#cb800-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb800-2"><a href="tidy_data.html#cb800-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="co"># coord_type</span></span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
<p>The data is heavily bunched up against the left side.</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="tidy_data.html#cb801-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="co"># without scaling</span></span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="tidy_data.html#cb802-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb802-2"><a href="tidy_data.html#cb802-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="co"># scales the axis of a plot to a log 10 basis</span></span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-185-2.png" width="672" /></p>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="tidy_data.html#cb803-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb803-2"><a href="tidy_data.html#cb803-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb803-3"><a href="tidy_data.html#cb803-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-185-3.png" width="672" /></p>
</div>
<div id="labels-and-guides" class="section level3 hasAnchor" number="4.7.8">
<h3><span class="header-section-number">4.7.8</span> Labels and guides<a href="tidy_data.html#labels-and-guides" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>scales</code> package has some useful premade formatting functions. You can either load scales or just grab the function you need from the library using <code>scales::</code></p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="tidy_data.html#cb805-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb805-2"><a href="tidy_data.html#cb805-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb805-3"><a href="tidy_data.html#cb805-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb805-4"><a href="tidy_data.html#cb805-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb805-5"><a href="tidy_data.html#cb805-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;log GDP&quot;</span>,</span>
<span id="cb805-6"><a href="tidy_data.html#cb805-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life Expectancy&quot;</span>,</span>
<span id="cb805-7"><a href="tidy_data.html#cb805-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;A Gapminder Plot&quot;</span>,</span>
<span id="cb805-8"><a href="tidy_data.html#cb805-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Data points are country-years&quot;</span>,</span>
<span id="cb805-9"><a href="tidy_data.html#cb805-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Source: Gapminder&quot;</span></span>
<span id="cb805-10"><a href="tidy_data.html#cb805-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-186-1.png" width="672" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Themes</li>
</ol>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="tidy_data.html#cb807-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb807-2"><a href="tidy_data.html#cb807-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb807-3"><a href="tidy_data.html#cb807-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb807-4"><a href="tidy_data.html#cb807-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb807-5"><a href="tidy_data.html#cb807-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;log GDP&quot;</span>,</span>
<span id="cb807-6"><a href="tidy_data.html#cb807-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life Expectancy&quot;</span>,</span>
<span id="cb807-7"><a href="tidy_data.html#cb807-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;A Gapminder Plot&quot;</span>,</span>
<span id="cb807-8"><a href="tidy_data.html#cb807-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Data points are country-years&quot;</span>,</span>
<span id="cb807-9"><a href="tidy_data.html#cb807-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Source: Gapminder&quot;</span></span>
<span id="cb807-10"><a href="tidy_data.html#cb807-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb807-11"><a href="tidy_data.html#cb807-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_economist</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-187-1.png" width="672" /></p>
</div>
<div id="ggsave" class="section level3 hasAnchor" number="4.7.9">
<h3><span class="header-section-number">4.7.9</span> ggsave<a href="tidy_data.html#ggsave" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="tidy_data.html#cb809-1" aria-hidden="true" tabindex="-1"></a>figure_example <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb809-2"><a href="tidy_data.html#cb809-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb809-3"><a href="tidy_data.html#cb809-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb809-4"><a href="tidy_data.html#cb809-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb809-5"><a href="tidy_data.html#cb809-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;log GDP&quot;</span>,</span>
<span id="cb809-6"><a href="tidy_data.html#cb809-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life Expectancy&quot;</span>,</span>
<span id="cb809-7"><a href="tidy_data.html#cb809-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;A Gapminder Plot&quot;</span>,</span>
<span id="cb809-8"><a href="tidy_data.html#cb809-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Data points are country-years&quot;</span>,</span>
<span id="cb809-9"><a href="tidy_data.html#cb809-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Source: Gapminder&quot;</span></span>
<span id="cb809-10"><a href="tidy_data.html#cb809-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb809-11"><a href="tidy_data.html#cb809-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_economist</span>()</span>
<span id="cb809-12"><a href="tidy_data.html#cb809-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb809-13"><a href="tidy_data.html#cb809-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(figure_example, <span class="fu">here</span>(<span class="st">&quot;outputs&quot;</span>, <span class="st">&quot;figure_example.png&quot;</span>))</span></code></pre></div>
</div>
<div id="many-plots" class="section level3 hasAnchor" number="4.7.10">
<h3><span class="header-section-number">4.7.10</span> Many plots<a href="tidy_data.html#many-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Basic ideas:</p>
<ul>
<li>Grouping: tell <code>ggplot2</code> about the structure of your data</li>
<li>Facetting: break up your data into pieces for a plot</li>
</ul>
<div id="grouping-1" class="section level4 hasAnchor" number="4.7.10.1">
<h4><span class="header-section-number">4.7.10.1</span> Grouping<a href="tidy_data.html#grouping-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Can you guess what’s wrong?</li>
</ul>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="tidy_data.html#cb810-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> gdpPercap))</span>
<span id="cb810-2"><a href="tidy_data.html#cb810-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb810-3"><a href="tidy_data.html#cb810-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-189-1.png" width="672" /></p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="tidy_data.html#cb811-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-189-2.png" width="672" /></p>
<p><code>geom_line</code> joins up all the lines for each particular year in the order they appear in the dataset. <code>ggplot2</code> does not know the yearly observations in your data are grouped by country.</p>
<p>You need grouping when the grouping information you need to tell is not built into the mapped variables (like continent).</p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="tidy_data.html#cb812-1" aria-hidden="true" tabindex="-1"></a>gapminder</span></code></pre></div>
<pre><code>## # A tibble: 1,704 × 6
##    country     continent  year lifeExp      pop gdpPercap
##    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1 Afghanistan Asia       1952    28.8  8425333      779.
##  2 Afghanistan Asia       1957    30.3  9240934      821.
##  3 Afghanistan Asia       1962    32.0 10267083      853.
##  4 Afghanistan Asia       1967    34.0 11537966      836.
##  5 Afghanistan Asia       1972    36.1 13079460      740.
##  6 Afghanistan Asia       1977    38.4 14880372      786.
##  7 Afghanistan Asia       1982    39.9 12881816      978.
##  8 Afghanistan Asia       1987    40.8 13867957      852.
##  9 Afghanistan Asia       1992    41.7 16317921      649.
## 10 Afghanistan Asia       1997    41.8 22227415      635.
## # ℹ 1,694 more rows</code></pre>
</div>
<div id="facetting" class="section level4 hasAnchor" number="4.7.10.2">
<h4><span class="header-section-number">4.7.10.2</span> Facetting<a href="tidy_data.html#facetting" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Facetting is to make small multiples.</p>
<ul>
<li><p><code>facet_wrap</code>: based on a single categorical variable like <code>facet_wrap(~single_categorical_variable)</code>. Your panels will be laid out in order and then wrapped into a grid.</p></li>
<li><p><code>facet_grid</code>: when you want to cross-classify some data by two categorical variables like <code>facet_grid(one_cat_variable ~ two_cat_variable)</code>.</p></li>
</ul>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="tidy_data.html#cb814-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> gdpPercap))</span>
<span id="cb814-2"><a href="tidy_data.html#cb814-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-3"><a href="tidy_data.html#cb814-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> country)) <span class="co"># group by, # The outlier is Kuwait.</span></span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-191-1.png" width="672" /></p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="tidy_data.html#cb815-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> country)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>continent) <span class="co"># facetting</span></span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-191-2.png" width="672" /></p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="tidy_data.html#cb816-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> country), <span class="at">color =</span> <span class="st">&quot;gray70&quot;</span>) <span class="sc">+</span></span>
<span id="cb816-2"><a href="tidy_data.html#cb816-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">size =</span> <span class="fl">1.1</span>, <span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb816-3"><a href="tidy_data.html#cb816-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb816-4"><a href="tidy_data.html#cb816-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>continent, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="co"># for single categorical variable; for multiple categorical variables use facet_grid()</span></span>
<span id="cb816-5"><a href="tidy_data.html#cb816-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb816-6"><a href="tidy_data.html#cb816-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb816-7"><a href="tidy_data.html#cb816-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;GDP per capita&quot;</span>,</span>
<span id="cb816-8"><a href="tidy_data.html#cb816-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;GDP per capita on Five continents&quot;</span></span>
<span id="cb816-9"><a href="tidy_data.html#cb816-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb816-10"><a href="tidy_data.html#cb816-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-191-3.png" width="672" /></p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="tidy_data.html#cb818-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> country), <span class="at">color =</span> <span class="st">&quot;gray70&quot;</span>) <span class="sc">+</span></span>
<span id="cb818-2"><a href="tidy_data.html#cb818-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">size =</span> <span class="fl">1.1</span>, <span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb818-3"><a href="tidy_data.html#cb818-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb818-4"><a href="tidy_data.html#cb818-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>continent) <span class="sc">+</span> <span class="co"># for single categorical variable; for multiple categorical variables use facet_grid()</span></span>
<span id="cb818-5"><a href="tidy_data.html#cb818-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb818-6"><a href="tidy_data.html#cb818-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb818-7"><a href="tidy_data.html#cb818-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;GDP per capita&quot;</span>,</span>
<span id="cb818-8"><a href="tidy_data.html#cb818-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;GDP per capita on Five continents&quot;</span></span>
<span id="cb818-9"><a href="tidy_data.html#cb818-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb818-10"><a href="tidy_data.html#cb818-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
</div>
</div>
<div id="transforming" class="section level3 hasAnchor" number="4.7.11">
<h3><span class="header-section-number">4.7.11</span> Transforming<a href="tidy_data.html#transforming" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Transforming: perform some calculations on or summarize your data before producing the plot</li>
</ul>
<div id="use-pipes-to-summarize-data" class="section level4 hasAnchor" number="4.7.11.1">
<h4><span class="header-section-number">4.7.11.1</span> Use pipes to summarize data<a href="tidy_data.html#use-pipes-to-summarize-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Also, we experiment with bar charts here. By default, <code>geom_bar</code> <a href="https://www.rdocumentation.org/packages/ggplot2/versions/1.0.1/topics/geom_bar">uses</a> stat = “bins”, which makes the height of each bar equal to the number of cases in each group. If you have a y column, then you should use <code>stat = "identity"</code> argument. Alternatively, you can use <code>geom_col().</code></p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="tidy_data.html#cb820-1" aria-hidden="true" tabindex="-1"></a>gapminder_formatted <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb820-2"><a href="tidy_data.html#cb820-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">%&gt;%</span></span>
<span id="cb820-3"><a href="tidy_data.html#cb820-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb820-4"><a href="tidy_data.html#cb820-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb820-5"><a href="tidy_data.html#cb820-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb820-6"><a href="tidy_data.html#cb820-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;continent&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="tidy_data.html#cb822-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder_formatted, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp_mean, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb822-2"><a href="tidy_data.html#cb822-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb822-3"><a href="tidy_data.html#cb822-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb822-4"><a href="tidy_data.html#cb822-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb822-5"><a href="tidy_data.html#cb822-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life expectancy&quot;</span>,</span>
<span id="cb822-6"><a href="tidy_data.html#cb822-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Life expectancy on Five continents&quot;</span></span>
<span id="cb822-7"><a href="tidy_data.html#cb822-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-193-1.png" width="672" /></p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="tidy_data.html#cb823-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb823-2"><a href="tidy_data.html#cb823-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb823-3"><a href="tidy_data.html#cb823-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb823-4"><a href="tidy_data.html#cb823-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb823-5"><a href="tidy_data.html#cb823-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb823-6"><a href="tidy_data.html#cb823-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb823-7"><a href="tidy_data.html#cb823-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb823-8"><a href="tidy_data.html#cb823-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp_mean, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb823-9"><a href="tidy_data.html#cb823-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb823-10"><a href="tidy_data.html#cb823-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb823-11"><a href="tidy_data.html#cb823-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb823-12"><a href="tidy_data.html#cb823-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life expectancy&quot;</span>,</span>
<span id="cb823-13"><a href="tidy_data.html#cb823-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Life expectancy in Europe&quot;</span></span>
<span id="cb823-14"><a href="tidy_data.html#cb823-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;country&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-193-2.png" width="672" /></p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="tidy_data.html#cb825-1" aria-hidden="true" tabindex="-1"></a><span class="co"># geom point</span></span>
<span id="cb825-2"><a href="tidy_data.html#cb825-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb825-3"><a href="tidy_data.html#cb825-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb825-4"><a href="tidy_data.html#cb825-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb825-5"><a href="tidy_data.html#cb825-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb825-6"><a href="tidy_data.html#cb825-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb825-7"><a href="tidy_data.html#cb825-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb825-8"><a href="tidy_data.html#cb825-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb825-9"><a href="tidy_data.html#cb825-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp_mean)) <span class="sc">+</span></span>
<span id="cb825-10"><a href="tidy_data.html#cb825-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb825-11"><a href="tidy_data.html#cb825-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb825-12"><a href="tidy_data.html#cb825-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb825-13"><a href="tidy_data.html#cb825-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life expectancy&quot;</span>,</span>
<span id="cb825-14"><a href="tidy_data.html#cb825-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Life expectancy in Europe&quot;</span></span>
<span id="cb825-15"><a href="tidy_data.html#cb825-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb825-16"><a href="tidy_data.html#cb825-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>country)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;country&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-194-1.png" width="672" /></p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="tidy_data.html#cb827-1" aria-hidden="true" tabindex="-1"></a><span class="co"># geom bar</span></span>
<span id="cb827-2"><a href="tidy_data.html#cb827-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb827-3"><a href="tidy_data.html#cb827-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb827-4"><a href="tidy_data.html#cb827-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb827-5"><a href="tidy_data.html#cb827-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb827-6"><a href="tidy_data.html#cb827-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb827-7"><a href="tidy_data.html#cb827-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb827-8"><a href="tidy_data.html#cb827-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb827-9"><a href="tidy_data.html#cb827-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp_mean)) <span class="sc">+</span></span>
<span id="cb827-10"><a href="tidy_data.html#cb827-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb827-11"><a href="tidy_data.html#cb827-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb827-12"><a href="tidy_data.html#cb827-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb827-13"><a href="tidy_data.html#cb827-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life expectancy&quot;</span>,</span>
<span id="cb827-14"><a href="tidy_data.html#cb827-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Life expectancy in Europe&quot;</span></span>
<span id="cb827-15"><a href="tidy_data.html#cb827-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb827-16"><a href="tidy_data.html#cb827-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>country)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;country&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-194-2.png" width="672" /></p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="tidy_data.html#cb829-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no facet</span></span>
<span id="cb829-2"><a href="tidy_data.html#cb829-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb829-3"><a href="tidy_data.html#cb829-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb829-4"><a href="tidy_data.html#cb829-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb829-5"><a href="tidy_data.html#cb829-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb829-6"><a href="tidy_data.html#cb829-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb829-7"><a href="tidy_data.html#cb829-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb829-8"><a href="tidy_data.html#cb829-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb829-9"><a href="tidy_data.html#cb829-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp_mean, <span class="at">fill =</span> country)) <span class="sc">+</span></span>
<span id="cb829-10"><a href="tidy_data.html#cb829-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> <span class="co"># even if you not stack, still the plot looks messy or you can use geom_col()</span></span>
<span id="cb829-11"><a href="tidy_data.html#cb829-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb829-12"><a href="tidy_data.html#cb829-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb829-13"><a href="tidy_data.html#cb829-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life expectancy&quot;</span>,</span>
<span id="cb829-14"><a href="tidy_data.html#cb829-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Life expectancy in Europe&quot;</span></span>
<span id="cb829-15"><a href="tidy_data.html#cb829-15" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;country&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-194-3.png" width="672" /></p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="tidy_data.html#cb831-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb831-2"><a href="tidy_data.html#cb831-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb831-3"><a href="tidy_data.html#cb831-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb831-4"><a href="tidy_data.html#cb831-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb831-5"><a href="tidy_data.html#cb831-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb831-6"><a href="tidy_data.html#cb831-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb831-7"><a href="tidy_data.html#cb831-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb831-8"><a href="tidy_data.html#cb831-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> lifeExp_mean)) <span class="sc">+</span></span>
<span id="cb831-9"><a href="tidy_data.html#cb831-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb831-10"><a href="tidy_data.html#cb831-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb831-11"><a href="tidy_data.html#cb831-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Country&quot;</span>,</span>
<span id="cb831-12"><a href="tidy_data.html#cb831-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life expectancy&quot;</span>,</span>
<span id="cb831-13"><a href="tidy_data.html#cb831-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Life expectancy in Europe&quot;</span></span>
<span id="cb831-14"><a href="tidy_data.html#cb831-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb831-15"><a href="tidy_data.html#cb831-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;country&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-195-1.png" width="672" /></p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="tidy_data.html#cb833-1" aria-hidden="true" tabindex="-1"></a><span class="co"># without ordering</span></span>
<span id="cb833-2"><a href="tidy_data.html#cb833-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb833-3"><a href="tidy_data.html#cb833-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb833-4"><a href="tidy_data.html#cb833-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb833-5"><a href="tidy_data.html#cb833-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb833-6"><a href="tidy_data.html#cb833-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb833-7"><a href="tidy_data.html#cb833-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb833-8"><a href="tidy_data.html#cb833-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb833-9"><a href="tidy_data.html#cb833-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, lifeExp_mean), <span class="at">y =</span> lifeExp_mean)) <span class="sc">+</span></span>
<span id="cb833-10"><a href="tidy_data.html#cb833-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb833-11"><a href="tidy_data.html#cb833-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb833-12"><a href="tidy_data.html#cb833-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Country&quot;</span>,</span>
<span id="cb833-13"><a href="tidy_data.html#cb833-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life expectancy&quot;</span>,</span>
<span id="cb833-14"><a href="tidy_data.html#cb833-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Life expectancy in Europe&quot;</span></span>
<span id="cb833-15"><a href="tidy_data.html#cb833-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb833-16"><a href="tidy_data.html#cb833-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;country&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-196-1.png" width="672" /></p>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="tidy_data.html#cb835-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder</span></span>
<span id="cb835-2"><a href="tidy_data.html#cb835-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb835-3"><a href="tidy_data.html#cb835-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb835-4"><a href="tidy_data.html#cb835-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb835-5"><a href="tidy_data.html#cb835-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb835-6"><a href="tidy_data.html#cb835-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb835-7"><a href="tidy_data.html#cb835-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb835-8"><a href="tidy_data.html#cb835-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb835-9"><a href="tidy_data.html#cb835-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, <span class="sc">-</span>lifeExp_mean), <span class="at">y =</span> lifeExp_mean)) <span class="sc">+</span></span>
<span id="cb835-10"><a href="tidy_data.html#cb835-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb835-11"><a href="tidy_data.html#cb835-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb835-12"><a href="tidy_data.html#cb835-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Country&quot;</span>,</span>
<span id="cb835-13"><a href="tidy_data.html#cb835-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life expectancy&quot;</span>,</span>
<span id="cb835-14"><a href="tidy_data.html#cb835-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Life expectancy in Europe&quot;</span></span>
<span id="cb835-15"><a href="tidy_data.html#cb835-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb835-16"><a href="tidy_data.html#cb835-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;country&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-196-2.png" width="672" /></p>
</div>
<div id="plotting-text" class="section level4 hasAnchor" number="4.7.11.2">
<h4><span class="header-section-number">4.7.11.2</span> Plotting text<a href="tidy_data.html#plotting-text" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="tidy_data.html#cb837-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb837-2"><a href="tidy_data.html#cb837-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Asia&quot;</span> <span class="sc">|</span> continent <span class="sc">==</span> <span class="st">&quot;Americas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb837-3"><a href="tidy_data.html#cb837-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, country) <span class="sc">%&gt;%</span></span>
<span id="cb837-4"><a href="tidy_data.html#cb837-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb837-5"><a href="tidy_data.html#cb837-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb837-6"><a href="tidy_data.html#cb837-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb837-7"><a href="tidy_data.html#cb837-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb837-8"><a href="tidy_data.html#cb837-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdp_mean, <span class="at">y =</span> lifeExp_mean)) <span class="sc">+</span></span>
<span id="cb837-9"><a href="tidy_data.html#cb837-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb837-10"><a href="tidy_data.html#cb837-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb837-11"><a href="tidy_data.html#cb837-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb837-12"><a href="tidy_data.html#cb837-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>continent)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;continent&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="tidy_data.html#cb839-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with label</span></span>
<span id="cb839-2"><a href="tidy_data.html#cb839-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb839-3"><a href="tidy_data.html#cb839-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Asia&quot;</span> <span class="sc">|</span> continent <span class="sc">==</span> <span class="st">&quot;Americas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb839-4"><a href="tidy_data.html#cb839-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, country) <span class="sc">%&gt;%</span></span>
<span id="cb839-5"><a href="tidy_data.html#cb839-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb839-6"><a href="tidy_data.html#cb839-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb839-7"><a href="tidy_data.html#cb839-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb839-8"><a href="tidy_data.html#cb839-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb839-9"><a href="tidy_data.html#cb839-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdp_mean, <span class="at">y =</span> lifeExp_mean)) <span class="sc">+</span></span>
<span id="cb839-10"><a href="tidy_data.html#cb839-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb839-11"><a href="tidy_data.html#cb839-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb839-12"><a href="tidy_data.html#cb839-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb839-13"><a href="tidy_data.html#cb839-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>continent)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;continent&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-198-1.png" width="672" /></p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="tidy_data.html#cb841-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no overlaps</span></span>
<span id="cb841-2"><a href="tidy_data.html#cb841-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb841-3"><a href="tidy_data.html#cb841-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Asia&quot;</span> <span class="sc">|</span> continent <span class="sc">==</span> <span class="st">&quot;Americas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb841-4"><a href="tidy_data.html#cb841-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, country) <span class="sc">%&gt;%</span></span>
<span id="cb841-5"><a href="tidy_data.html#cb841-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb841-6"><a href="tidy_data.html#cb841-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_mean =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb841-7"><a href="tidy_data.html#cb841-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lifeExp_mean =</span> <span class="fu">mean</span>(lifeExp)</span>
<span id="cb841-8"><a href="tidy_data.html#cb841-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb841-9"><a href="tidy_data.html#cb841-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdp_mean, <span class="at">y =</span> lifeExp_mean)) <span class="sc">+</span></span>
<span id="cb841-10"><a href="tidy_data.html#cb841-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb841-11"><a href="tidy_data.html#cb841-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> country)) <span class="sc">+</span> <span class="co"># there&#39;s also geom_label_repel</span></span>
<span id="cb841-12"><a href="tidy_data.html#cb841-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb841-13"><a href="tidy_data.html#cb841-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>continent)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;continent&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre><code>## Warning: ggrepel: 2 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<pre><code>## Warning: ggrepel: 1 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
</div>
</div>
<div id="ploting-models" class="section level3 hasAnchor" number="4.7.12">
<h3><span class="header-section-number">4.7.12</span> Ploting models<a href="tidy_data.html#ploting-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In plotting models, we extensively use David Robinson’s <a href="https://cran.r-project.org/web/packages/broom/vignettes/broom.html">broom package</a> in R. The idea is to transform model outputs (i.e., predictions and estimations) into tidy objects so that we can easily combine, separate, and visualize these elements.</p>
<div id="plotting-several-fits-at-the-same-time" class="section level4 hasAnchor" number="4.7.12.1">
<h4><span class="header-section-number">4.7.12.1</span> Plotting several fits at the same time<a href="tidy_data.html#plotting-several-fits-at-the-same-time" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="tidy_data.html#cb845-1" aria-hidden="true" tabindex="-1"></a>model_colors <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&quot;Set1&quot;</span>) <span class="co"># select three qualitatively different colors from a larger palette.</span></span>
<span id="cb845-2"><a href="tidy_data.html#cb845-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb845-3"><a href="tidy_data.html#cb845-3" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb845-4"><a href="tidy_data.html#cb845-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(gdpPercap), <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb845-5"><a href="tidy_data.html#cb845-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb845-6"><a href="tidy_data.html#cb845-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;OLS&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;OLS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb845-7"><a href="tidy_data.html#cb845-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb845-8"><a href="tidy_data.html#cb845-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> splines<span class="sc">::</span><span class="fu">bs</span>(x, <span class="at">df =</span> <span class="dv">3</span>),</span>
<span id="cb845-9"><a href="tidy_data.html#cb845-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;Cubic Spline&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Cubic Spline&quot;</span>)</span>
<span id="cb845-10"><a href="tidy_data.html#cb845-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb845-11"><a href="tidy_data.html#cb845-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&quot;LOESS&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;LOESS&quot;</span>)) <span class="sc">+</span></span>
<span id="cb845-12"><a href="tidy_data.html#cb845-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb845-13"><a href="tidy_data.html#cb845-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;Models&quot;</span>, <span class="at">values =</span> model_colors) <span class="sc">+</span></span>
<span id="cb845-14"><a href="tidy_data.html#cb845-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Models&quot;</span>, <span class="at">values =</span> model_colors)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;
## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-200-1.png" width="672" /></p>
</div>
<div id="extracting-model-outcomes" class="section level4 hasAnchor" number="4.7.12.2">
<h4><span class="header-section-number">4.7.12.2</span> Extracting model outcomes<a href="tidy_data.html#extracting-model-outcomes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="tidy_data.html#cb847-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regression model</span></span>
<span id="cb847-2"><a href="tidy_data.html#cb847-2" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb847-3"><a href="tidy_data.html#cb847-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> lifeExp <span class="sc">~</span> gdpPercap <span class="sc">+</span> pop <span class="sc">+</span> continent,</span>
<span id="cb847-4"><a href="tidy_data.html#cb847-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gapminder</span>
<span id="cb847-5"><a href="tidy_data.html#cb847-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><code>tidy()</code> is a method in the <code>broom</code> package. It “constructs a dataframe that summarizes the model’s statistical findings”. As the description states, tidy is a function that can be used for various models. For instance, a tidy can extract the following information from a regression model.</p>
<ul>
<li><code>Term</code>: a term being estimated</li>
<li><code>p.value</code></li>
<li><code>statistic</code>: a test statistic used to compute p-value</li>
<li><code>estimate</code></li>
<li><code>conf.low</code>: the low end of a confidence interval</li>
<li><code>conf.high</code>: the high end of a confidence interval</li>
<li><code>df</code>: degrees of freedom</li>
</ul>
<p><strong>Challenge</strong></p>
<p>Try <code>glance(out)</code>; what did you get from these commands? If you’re curious, you can try <code>?glance</code>.</p>
<p>The followings are to show your degree of confidence.</p>
<div id="coefficients" class="section level5 hasAnchor" number="4.7.12.2.1">
<h5><span class="header-section-number">4.7.12.2.1</span> Coefficients<a href="tidy_data.html#coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="tidy_data.html#cb848-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimates</span></span>
<span id="cb848-2"><a href="tidy_data.html#cb848-2" aria-hidden="true" tabindex="-1"></a>out_comp <span class="ot">&lt;-</span> <span class="fu">tidy</span>(out)</span>
<span id="cb848-3"><a href="tidy_data.html#cb848-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb848-4"><a href="tidy_data.html#cb848-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> out_comp <span class="sc">%&gt;%</span></span>
<span id="cb848-5"><a href="tidy_data.html#cb848-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> term, <span class="at">y =</span> estimate))</span>
<span id="cb848-6"><a href="tidy_data.html#cb848-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb848-7"><a href="tidy_data.html#cb848-7" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb848-8"><a href="tidy_data.html#cb848-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb848-9"><a href="tidy_data.html#cb848-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-202-1.png" width="672" /></p>
</div>
<div id="confidence-intervals" class="section level5 hasAnchor" number="4.7.12.2.2">
<h5><span class="header-section-number">4.7.12.2.2</span> Confidence intervals<a href="tidy_data.html#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="tidy_data.html#cb849-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plus confidence intervals</span></span>
<span id="cb849-2"><a href="tidy_data.html#cb849-2" aria-hidden="true" tabindex="-1"></a>out_conf <span class="ot">&lt;-</span> <span class="fu">tidy</span>(out, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb849-3"><a href="tidy_data.html#cb849-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb849-4"><a href="tidy_data.html#cb849-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting coefficients using ggplot2 (pointrange)</span></span>
<span id="cb849-5"><a href="tidy_data.html#cb849-5" aria-hidden="true" tabindex="-1"></a>out_conf <span class="sc">%&gt;%</span></span>
<span id="cb849-6"><a href="tidy_data.html#cb849-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(term, estimate), <span class="at">y =</span> estimate, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high)) <span class="sc">+</span></span>
<span id="cb849-7"><a href="tidy_data.html#cb849-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb849-8"><a href="tidy_data.html#cb849-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb849-9"><a href="tidy_data.html#cb849-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;OLS Estimate&quot;</span>) <span class="sc">+</span></span>
<span id="cb849-10"><a href="tidy_data.html#cb849-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="tidy_data.html#cb850-1" aria-hidden="true" tabindex="-1"></a><span class="co"># another way to do it (errorbar)</span></span>
<span id="cb850-2"><a href="tidy_data.html#cb850-2" aria-hidden="true" tabindex="-1"></a>out_conf <span class="sc">%&gt;%</span></span>
<span id="cb850-3"><a href="tidy_data.html#cb850-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(term, estimate))) <span class="sc">+</span></span>
<span id="cb850-4"><a href="tidy_data.html#cb850-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb850-5"><a href="tidy_data.html#cb850-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high)) <span class="sc">+</span></span>
<span id="cb850-6"><a href="tidy_data.html#cb850-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;OLS Estimate&quot;</span>) <span class="sc">+</span></span>
<span id="cb850-7"><a href="tidy_data.html#cb850-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="03_tidy_data_files/figure-html/unnamed-chunk-203-2.png" width="672" /></p>
<p>You can also calculate marginal effects using the <a href="https://vincentarelbundock.github.io/marginaleffects/"><code>marginaleffects</code></a> package.</p>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="git_bash.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functional_programming.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PS239T.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
