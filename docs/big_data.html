<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Big data | Computational Thinking for Social Scientists</title>
  <meta name="description" content="Chapter 9 Big data | Computational Thinking for Social Scientists. Online textbook for Teaching Computational Tools and Techniques for Social Scientists." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Big data | Computational Thinking for Social Scientists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 9 Big data | Computational Thinking for Social Scientists. Online textbook for Teaching Computational Tools and Techniques for Social Scientists." />
  <meta name="github-repo" content="jaeyk/PS239T" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Big data | Computational Thinking for Social Scientists" />
  <meta name="twitter:site" content="@JaeJaeykim2" />
  <meta name="twitter:description" content="Chapter 9 Big data | Computational Thinking for Social Scientists. Online textbook for Teaching Computational Tools and Techniques for Social Scientists." />
  

<meta name="author" content="Jae Yeon Kim" />


<meta name="date" content="2021-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="machine_learning.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Computational Thinking for Social Scientists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Hello World</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#part-i-fundamentals"><i class="fa fa-check"></i><b>1.1</b> Part I Fundamentals</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#part-ii-applications"><i class="fa fa-check"></i><b>1.2</b> Part II Applications</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#special-thanks"><i class="fa fa-check"></i><b>1.3</b> Special thanks</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#suggestions-questions-or-comments"><i class="fa fa-check"></i><b>1.4</b> Suggestions, questions, or comments</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.5</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Computational thinking</a>
<ul>
<li class="chapter" data-level="2.1" data-path="motivation.html"><a href="motivation.html#why-computational-thinking"><i class="fa fa-check"></i><b>2.1</b> Why computational thinking</a></li>
<li class="chapter" data-level="2.2" data-path="motivation.html"><a href="motivation.html#how-to-teach-and-learn-computational-thinking"><i class="fa fa-check"></i><b>2.2</b> How to teach and learn computational thinking</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="git_bash.html"><a href="git_bash.html"><i class="fa fa-check"></i><b>3</b> Managing data and code</a>
<ul>
<li class="chapter" data-level="3.1" data-path="git_bash.html"><a href="git_bash.html#the-command-line"><i class="fa fa-check"></i><b>3.1</b> The Command Line</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="git_bash.html"><a href="git_bash.html#the-big-picture"><i class="fa fa-check"></i><b>3.1.1</b> The Big Picture</a></li>
<li class="chapter" data-level="3.1.2" data-path="git_bash.html"><a href="git_bash.html#why-bother-using-the-command-line"><i class="fa fa-check"></i><b>3.1.2</b> Why bother using the command line?</a></li>
<li class="chapter" data-level="3.1.3" data-path="git_bash.html"><a href="git_bash.html#unix-shell"><i class="fa fa-check"></i><b>3.1.3</b> UNIX Shell</a></li>
<li class="chapter" data-level="3.1.4" data-path="git_bash.html"><a href="git_bash.html#references"><i class="fa fa-check"></i><b>3.1.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="git_bash.html"><a href="git_bash.html#git-and-github"><i class="fa fa-check"></i><b>3.2</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="git_bash.html"><a href="git_bash.html#the-big-picture-1"><i class="fa fa-check"></i><b>3.2.1</b> The Big Picture</a></li>
<li class="chapter" data-level="3.2.2" data-path="git_bash.html"><a href="git_bash.html#version-control-system"><i class="fa fa-check"></i><b>3.2.2</b> Version control system</a></li>
<li class="chapter" data-level="3.2.3" data-path="git_bash.html"><a href="git_bash.html#setup"><i class="fa fa-check"></i><b>3.2.3</b> Setup</a></li>
<li class="chapter" data-level="3.2.4" data-path="git_bash.html"><a href="git_bash.html#cloning-a-repository"><i class="fa fa-check"></i><b>3.2.4</b> Cloning a repository</a></li>
<li class="chapter" data-level="3.2.5" data-path="git_bash.html"><a href="git_bash.html#making-a-repository"><i class="fa fa-check"></i><b>3.2.5</b> Making a repository</a></li>
<li class="chapter" data-level="3.2.6" data-path="git_bash.html"><a href="git_bash.html#commit-changes"><i class="fa fa-check"></i><b>3.2.6</b> Commit changes</a></li>
<li class="chapter" data-level="3.2.7" data-path="git_bash.html"><a href="git_bash.html#push-and-pull-or-fetch"><i class="fa fa-check"></i><b>3.2.7</b> Push and pull (or fetch)</a></li>
<li class="chapter" data-level="3.2.8" data-path="git_bash.html"><a href="git_bash.html#branching"><i class="fa fa-check"></i><b>3.2.8</b> Branching</a></li>
<li class="chapter" data-level="3.2.9" data-path="git_bash.html"><a href="git_bash.html#other-useful-commands"><i class="fa fa-check"></i><b>3.2.9</b> Other useful commands</a></li>
<li class="chapter" data-level="3.2.10" data-path="git_bash.html"><a href="git_bash.html#collaborations"><i class="fa fa-check"></i><b>3.2.10</b> Collaborations</a></li>
<li class="chapter" data-level="3.2.11" data-path="git_bash.html"><a href="git_bash.html#deployment-github-pages"><i class="fa fa-check"></i><b>3.2.11</b> Deployment: GitHub Pages</a></li>
<li class="chapter" data-level="3.2.12" data-path="git_bash.html"><a href="git_bash.html#tracking-progress-github-issues"><i class="fa fa-check"></i><b>3.2.12</b> Tracking progress: GitHub Issues</a></li>
<li class="chapter" data-level="3.2.13" data-path="git_bash.html"><a href="git_bash.html#project-management-github-dashboards"><i class="fa fa-check"></i><b>3.2.13</b> Project management: GitHub Dashboards</a></li>
<li class="chapter" data-level="3.2.14" data-path="git_bash.html"><a href="git_bash.html#using-git-clients"><i class="fa fa-check"></i><b>3.2.14</b> Using Git clients</a></li>
<li class="chapter" data-level="3.2.15" data-path="git_bash.html"><a href="git_bash.html#the-big-picture-2"><i class="fa fa-check"></i><b>3.2.15</b> The Big Picture</a></li>
<li class="chapter" data-level="3.2.16" data-path="git_bash.html"><a href="git_bash.html#rstudio"><i class="fa fa-check"></i><b>3.2.16</b> RStudio</a></li>
<li class="chapter" data-level="3.2.17" data-path="git_bash.html"><a href="git_bash.html#basic-syntax"><i class="fa fa-check"></i><b>3.2.17</b> Basic Syntax</a></li>
<li class="chapter" data-level="3.2.18" data-path="git_bash.html"><a href="git_bash.html#environment"><i class="fa fa-check"></i><b>3.2.18</b> Environment</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="git_bash.html"><a href="git_bash.html#project-oriented-research"><i class="fa fa-check"></i><b>3.3</b> Project-oriented research</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="git_bash.html"><a href="git_bash.html#the-big-picture-3"><i class="fa fa-check"></i><b>3.3.1</b> The Big Picture</a></li>
<li class="chapter" data-level="3.3.2" data-path="git_bash.html"><a href="git_bash.html#references-1"><i class="fa fa-check"></i><b>3.3.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="git_bash.html"><a href="git_bash.html#writing-code-how-to-code-like-a-professional"><i class="fa fa-check"></i><b>3.4</b> Writing code: How to code like a professional</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="git_bash.html"><a href="git_bash.html#the-bic-piture"><i class="fa fa-check"></i><b>3.4.1</b> The Bic Piture</a></li>
<li class="chapter" data-level="3.4.2" data-path="git_bash.html"><a href="git_bash.html#write-readable-code"><i class="fa fa-check"></i><b>3.4.2</b> Write readable code</a></li>
<li class="chapter" data-level="3.4.3" data-path="git_bash.html"><a href="git_bash.html#write-reusable-code"><i class="fa fa-check"></i><b>3.4.3</b> Write reusable code</a></li>
<li class="chapter" data-level="3.4.4" data-path="git_bash.html"><a href="git_bash.html#test-your-code-systematically"><i class="fa fa-check"></i><b>3.4.4</b> Test your code systematically</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="git_bash.html"><a href="git_bash.html#run-tests"><i class="fa fa-check"></i><b>3.5</b> Run tests</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="git_bash.html"><a href="git_bash.html#asking-questions-minimal-reproducible-example"><i class="fa fa-check"></i><b>3.5.1</b> Asking questions: Minimal reproducible example</a></li>
<li class="chapter" data-level="3.5.2" data-path="git_bash.html"><a href="git_bash.html#references-2"><i class="fa fa-check"></i><b>3.5.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidy_data.html"><a href="tidy_data.html"><i class="fa fa-check"></i><b>4</b> Tidy data and its friends</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidy_data.html"><a href="tidy_data.html#setup-2"><i class="fa fa-check"></i><b>4.1</b> Setup</a></li>
<li class="chapter" data-level="4.2" data-path="tidy_data.html"><a href="tidy_data.html#the-big-picture-4"><i class="fa fa-check"></i><b>4.2</b> The Big Picture</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="tidy_data.html"><a href="tidy_data.html#r-data-structures"><i class="fa fa-check"></i><b>4.2.1</b> R Data structures</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tidy_data.html"><a href="tidy_data.html#d-data-vectors"><i class="fa fa-check"></i><b>4.3</b> 1D data: Vectors</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="tidy_data.html"><a href="tidy_data.html#atomic-classes"><i class="fa fa-check"></i><b>4.3.1</b> Atomic classes</a></li>
<li class="chapter" data-level="4.3.2" data-path="tidy_data.html"><a href="tidy_data.html#data-structures"><i class="fa fa-check"></i><b>4.3.2</b> Data structures</a></li>
<li class="chapter" data-level="4.3.3" data-path="tidy_data.html"><a href="tidy_data.html#attributes"><i class="fa fa-check"></i><b>4.3.3</b> Attributes</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tidy_data.html"><a href="tidy_data.html#d-data-matrices-and-dataframes"><i class="fa fa-check"></i><b>4.4</b> 2D data: Matrices and dataframes</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="tidy_data.html"><a href="tidy_data.html#matrices"><i class="fa fa-check"></i><b>4.4.1</b> Matrices</a></li>
<li class="chapter" data-level="4.4.2" data-path="tidy_data.html"><a href="tidy_data.html#dataframes"><i class="fa fa-check"></i><b>4.4.2</b> Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="tidy_data.html"><a href="tidy_data.html#subset"><i class="fa fa-check"></i><b>4.5</b> Subset</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="tidy_data.html"><a href="tidy_data.html#atomic-vectors"><i class="fa fa-check"></i><b>4.5.1</b> Atomic vectors</a></li>
<li class="chapter" data-level="4.5.2" data-path="tidy_data.html"><a href="tidy_data.html#lists-1"><i class="fa fa-check"></i><b>4.5.2</b> Lists</a></li>
<li class="chapter" data-level="4.5.3" data-path="tidy_data.html"><a href="tidy_data.html#matrices-1"><i class="fa fa-check"></i><b>4.5.3</b> Matrices</a></li>
<li class="chapter" data-level="4.5.4" data-path="tidy_data.html"><a href="tidy_data.html#data-frames"><i class="fa fa-check"></i><b>4.5.4</b> Data frames</a></li>
<li class="chapter" data-level="4.5.5" data-path="tidy_data.html"><a href="tidy_data.html#subsetting-operators"><i class="fa fa-check"></i><b>4.5.5</b> Subsetting operators</a></li>
<li class="chapter" data-level="4.5.6" data-path="tidy_data.html"><a href="tidy_data.html#subassignment"><i class="fa fa-check"></i><b>4.5.6</b> Subassignment</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tidy_data.html"><a href="tidy_data.html#tidyverse"><i class="fa fa-check"></i><b>4.6</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="tidy_data.html"><a href="tidy_data.html#the-big-picture-5"><i class="fa fa-check"></i><b>4.6.1</b> The Big Picture</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="tidy_data.html"><a href="tidy_data.html#tidying-tidyr"><i class="fa fa-check"></i><b>4.7</b> Tidying (tidyr)</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="tidy_data.html"><a href="tidy_data.html#reshaping"><i class="fa fa-check"></i><b>4.7.1</b> Reshaping</a></li>
<li class="chapter" data-level="4.7.2" data-path="tidy_data.html"><a href="tidy_data.html#filling"><i class="fa fa-check"></i><b>4.7.2</b> Filling</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="tidy_data.html"><a href="tidy_data.html#manipulating-dplyr"><i class="fa fa-check"></i><b>4.8</b> Manipulating (dplyr)</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="tidy_data.html"><a href="tidy_data.html#rearranging"><i class="fa fa-check"></i><b>4.8.1</b> Rearranging</a></li>
<li class="chapter" data-level="4.8.2" data-path="tidy_data.html"><a href="tidy_data.html#subset-observations-rows"><i class="fa fa-check"></i><b>4.8.2</b> Subset observations (rows)</a></li>
<li class="chapter" data-level="4.8.3" data-path="tidy_data.html"><a href="tidy_data.html#subset-variables-columns"><i class="fa fa-check"></i><b>4.8.3</b> Subset variables (columns)</a></li>
<li class="chapter" data-level="4.8.4" data-path="tidy_data.html"><a href="tidy_data.html#create-variables"><i class="fa fa-check"></i><b>4.8.4</b> Create variables</a></li>
<li class="chapter" data-level="4.8.5" data-path="tidy_data.html"><a href="tidy_data.html#counting"><i class="fa fa-check"></i><b>4.8.5</b> Counting</a></li>
<li class="chapter" data-level="4.8.6" data-path="tidy_data.html"><a href="tidy_data.html#summarizing"><i class="fa fa-check"></i><b>4.8.6</b> Summarizing</a></li>
<li class="chapter" data-level="4.8.7" data-path="tidy_data.html"><a href="tidy_data.html#grouping"><i class="fa fa-check"></i><b>4.8.7</b> Grouping</a></li>
<li class="chapter" data-level="4.8.8" data-path="tidy_data.html"><a href="tidy_data.html#joining"><i class="fa fa-check"></i><b>4.8.8</b> Joining</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="tidy_data.html"><a href="tidy_data.html#modeling-broom"><i class="fa fa-check"></i><b>4.9</b> Modeling (broom)</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="tidy_data.html"><a href="tidy_data.html#nesting"><i class="fa fa-check"></i><b>4.9.1</b> Nesting</a></li>
<li class="chapter" data-level="4.9.2" data-path="tidy_data.html"><a href="tidy_data.html#mapping"><i class="fa fa-check"></i><b>4.9.2</b> Mapping</a></li>
<li class="chapter" data-level="4.9.3" data-path="tidy_data.html"><a href="tidy_data.html#hypothesis-testing"><i class="fa fa-check"></i><b>4.9.3</b> Hypothesis testing</a></li>
<li class="chapter" data-level="4.9.4" data-path="tidy_data.html"><a href="tidy_data.html#mixed-models"><i class="fa fa-check"></i><b>4.9.4</b> Mixed models</a></li>
<li class="chapter" data-level="4.9.5" data-path="tidy_data.html"><a href="tidy_data.html#design-anaysis-optional"><i class="fa fa-check"></i><b>4.9.5</b> Design Anaysis (optional)</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="tidy_data.html"><a href="tidy_data.html#visualizing-ggplot2"><i class="fa fa-check"></i><b>4.10</b> Visualizing (ggplot2)</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="tidy_data.html"><a href="tidy_data.html#motivation-2"><i class="fa fa-check"></i><b>4.10.1</b> Motivation</a></li>
<li class="chapter" data-level="4.10.2" data-path="tidy_data.html"><a href="tidy_data.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>4.10.2</b> The grammar of graphics</a></li>
<li class="chapter" data-level="4.10.3" data-path="tidy_data.html"><a href="tidy_data.html#mapping-and-geom"><i class="fa fa-check"></i><b>4.10.3</b> mapping and geom</a></li>
<li class="chapter" data-level="4.10.4" data-path="tidy_data.html"><a href="tidy_data.html#basic-aes-x-y"><i class="fa fa-check"></i><b>4.10.4</b> basic aes (x , y)</a></li>
<li class="chapter" data-level="4.10.5" data-path="tidy_data.html"><a href="tidy_data.html#univariate-distribution"><i class="fa fa-check"></i><b>4.10.5</b> Univariate distribution</a></li>
<li class="chapter" data-level="4.10.6" data-path="tidy_data.html"><a href="tidy_data.html#advanced-aes-size-color"><i class="fa fa-check"></i><b>4.10.6</b> Advanced aes (size, color)</a></li>
<li class="chapter" data-level="4.10.7" data-path="tidy_data.html"><a href="tidy_data.html#co-ordinates-and-scales"><i class="fa fa-check"></i><b>4.10.7</b> Co-ordinates and scales</a></li>
<li class="chapter" data-level="4.10.8" data-path="tidy_data.html"><a href="tidy_data.html#labels-and-guides"><i class="fa fa-check"></i><b>4.10.8</b> Labels and guides</a></li>
<li class="chapter" data-level="4.10.9" data-path="tidy_data.html"><a href="tidy_data.html#ggsave"><i class="fa fa-check"></i><b>4.10.9</b> ggsave</a></li>
<li class="chapter" data-level="4.10.10" data-path="tidy_data.html"><a href="tidy_data.html#many-plots"><i class="fa fa-check"></i><b>4.10.10</b> Many plots</a></li>
<li class="chapter" data-level="4.10.11" data-path="tidy_data.html"><a href="tidy_data.html#transforming"><i class="fa fa-check"></i><b>4.10.11</b> Transforming</a></li>
<li class="chapter" data-level="4.10.12" data-path="tidy_data.html"><a href="tidy_data.html#ploting-models"><i class="fa fa-check"></i><b>4.10.12</b> Ploting models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functional_programming.html"><a href="functional_programming.html"><i class="fa fa-check"></i><b>5</b> Automating repeated things</a>
<ul>
<li class="chapter" data-level="5.1" data-path="functional_programming.html"><a href="functional_programming.html#learning-objectives"><i class="fa fa-check"></i><b>5.1</b> Learning objectives</a></li>
<li class="chapter" data-level="5.2" data-path="functional_programming.html"><a href="functional_programming.html#setup-3"><i class="fa fa-check"></i><b>5.2</b> Setup</a></li>
<li class="chapter" data-level="5.3" data-path="functional_programming.html"><a href="functional_programming.html#flow"><i class="fa fa-check"></i><b>5.3</b> Flow control</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="functional_programming.html"><a href="functional_programming.html#if-one-condition"><i class="fa fa-check"></i><b>5.3.1</b> if (one condition)</a></li>
<li class="chapter" data-level="5.3.2" data-path="functional_programming.html"><a href="functional_programming.html#if-else-two-conditions"><i class="fa fa-check"></i><b>5.3.2</b> if + else (two conditions)</a></li>
<li class="chapter" data-level="5.3.3" data-path="functional_programming.html"><a href="functional_programming.html#if-else-if-else-three-conditions"><i class="fa fa-check"></i><b>5.3.3</b> if + else if + else (three conditions)</a></li>
<li class="chapter" data-level="5.3.4" data-path="functional_programming.html"><a href="functional_programming.html#functions"><i class="fa fa-check"></i><b>5.3.4</b> Functions</a></li>
<li class="chapter" data-level="5.3.5" data-path="functional_programming.html"><a href="functional_programming.html#for-loop"><i class="fa fa-check"></i><b>5.3.5</b> for loop</a></li>
<li class="chapter" data-level="5.3.6" data-path="functional_programming.html"><a href="functional_programming.html#apply-family"><i class="fa fa-check"></i><b>5.3.6</b> apply family</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="functional_programming.html"><a href="functional_programming.html#purrr"><i class="fa fa-check"></i><b>5.4</b> purrr</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="functional_programming.html"><a href="functional_programming.html#why-map"><i class="fa fa-check"></i><b>5.4.1</b> Why map?</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="functional_programming.html"><a href="functional_programming.html#map2"><i class="fa fa-check"></i><b>5.5</b> Automote 2 or 2+ tasks</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="functional_programming.html"><a href="functional_programming.html#objectives-1"><i class="fa fa-check"></i><b>5.5.1</b> Objectives</a></li>
<li class="chapter" data-level="5.5.2" data-path="functional_programming.html"><a href="functional_programming.html#problem"><i class="fa fa-check"></i><b>5.5.2</b> Problem</a></li>
<li class="chapter" data-level="5.5.3" data-path="functional_programming.html"><a href="functional_programming.html#for-loop-1"><i class="fa fa-check"></i><b>5.5.3</b> For loop</a></li>
<li class="chapter" data-level="5.5.4" data-path="functional_programming.html"><a href="functional_programming.html#map2-pmap"><i class="fa fa-check"></i><b>5.5.4</b> map2 &amp; pmap</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="functional_programming.html"><a href="functional_programming.html#glue"><i class="fa fa-check"></i><b>5.6</b> Automate plotting</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="functional_programming.html"><a href="functional_programming.html#objective"><i class="fa fa-check"></i><b>5.6.1</b> Objective</a></li>
<li class="chapter" data-level="5.6.2" data-path="functional_programming.html"><a href="functional_programming.html#problem-1"><i class="fa fa-check"></i><b>5.6.2</b> Problem</a></li>
<li class="chapter" data-level="5.6.3" data-path="functional_programming.html"><a href="functional_programming.html#solution"><i class="fa fa-check"></i><b>5.6.3</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="functional_programming.html"><a href="functional_programming.html#reduce"><i class="fa fa-check"></i><b>5.7</b> Automate joining</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="functional_programming.html"><a href="functional_programming.html#objective-1"><i class="fa fa-check"></i><b>5.7.1</b> Objective</a></li>
<li class="chapter" data-level="5.7.2" data-path="functional_programming.html"><a href="functional_programming.html#problem-2"><i class="fa fa-check"></i><b>5.7.2</b> Problem</a></li>
<li class="chapter" data-level="5.7.3" data-path="functional_programming.html"><a href="functional_programming.html#copy-and-paste"><i class="fa fa-check"></i><b>5.7.3</b> Copy and paste</a></li>
<li class="chapter" data-level="5.7.4" data-path="functional_programming.html"><a href="functional_programming.html#reduce-1"><i class="fa fa-check"></i><b>5.7.4</b> reduce</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="functional_programming.html"><a href="functional_programming.html#speed"><i class="fa fa-check"></i><b>5.8</b> Make automation slower or faster</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="functional_programming.html"><a href="functional_programming.html#objectives-2"><i class="fa fa-check"></i><b>5.8.1</b> Objectives</a></li>
<li class="chapter" data-level="5.8.2" data-path="functional_programming.html"><a href="functional_programming.html#how-to-make-automation-slower"><i class="fa fa-check"></i><b>5.8.2</b> How to Make Automation Slower</a></li>
<li class="chapter" data-level="5.8.3" data-path="functional_programming.html"><a href="functional_programming.html#how-to-make-automation-faster"><i class="fa fa-check"></i><b>5.8.3</b> How to Make Automation Faster</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="functional_programming.html"><a href="functional_programming.html#robustness"><i class="fa fa-check"></i><b>5.9</b> Make error handling easier</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="functional_programming.html"><a href="functional_programming.html#learning-objective"><i class="fa fa-check"></i><b>5.9.1</b> Learning objective</a></li>
<li class="chapter" data-level="5.9.2" data-path="functional_programming.html"><a href="functional_programming.html#solution-1"><i class="fa fa-check"></i><b>5.9.2</b> Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="products.html"><a href="products.html"><i class="fa fa-check"></i><b>6</b> Developing data products</a>
<ul>
<li class="chapter" data-level="6.1" data-path="products.html"><a href="products.html#developing-r-packages"><i class="fa fa-check"></i><b>6.1</b> Developing R packages</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="products.html"><a href="products.html#workflow"><i class="fa fa-check"></i><b>6.1.1</b> Workflow</a></li>
<li class="chapter" data-level="6.1.2" data-path="products.html"><a href="products.html#required-components"><i class="fa fa-check"></i><b>6.1.2</b> Required Components</a></li>
<li class="chapter" data-level="6.1.3" data-path="products.html"><a href="products.html#optional-components"><i class="fa fa-check"></i><b>6.1.3</b> Optional Components</a></li>
<li class="chapter" data-level="6.1.4" data-path="products.html"><a href="products.html#building-an-r-package"><i class="fa fa-check"></i><b>6.1.4</b> Building an R package</a></li>
<li class="chapter" data-level="6.1.5" data-path="products.html"><a href="products.html#distributing-an-r-package"><i class="fa fa-check"></i><b>6.1.5</b> Distributing an R package</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="products.html"><a href="products.html#developing-shiny-apps"><i class="fa fa-check"></i><b>6.2</b> Developing Shiny apps</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="products.html"><a href="products.html#workflow-1"><i class="fa fa-check"></i><b>6.2.1</b> Workflow</a></li>
<li class="chapter" data-level="6.2.2" data-path="products.html"><a href="products.html#app.r"><i class="fa fa-check"></i><b>6.2.2</b> app.r</a></li>
<li class="chapter" data-level="6.2.3" data-path="products.html"><a href="products.html#deployment"><i class="fa fa-check"></i><b>6.2.3</b> Deployment</a></li>
<li class="chapter" data-level="6.2.4" data-path="products.html"><a href="products.html#references-3"><i class="fa fa-check"></i><b>6.2.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="products.html"><a href="products.html#other-useful-data-products"><i class="fa fa-check"></i><b>6.3</b> Other useful data products</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="semi_structured_data.html"><a href="semi_structured_data.html"><i class="fa fa-check"></i><b>7</b> Semi-structured data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="semi_structured_data.html"><a href="semi_structured_data.html#setup-4"><i class="fa fa-check"></i><b>7.1</b> Setup</a></li>
<li class="chapter" data-level="7.2" data-path="semi_structured_data.html"><a href="semi_structured_data.html#objectives-3"><i class="fa fa-check"></i><b>7.2</b> Objectives</a></li>
<li class="chapter" data-level="7.3" data-path="semi_structured_data.html"><a href="semi_structured_data.html#what-is-semi-structured-data"><i class="fa fa-check"></i><b>7.3</b> What is semi-structured data?</a></li>
<li class="chapter" data-level="7.4" data-path="semi_structured_data.html"><a href="semi_structured_data.html#workflow-2"><i class="fa fa-check"></i><b>7.4</b> Workflow</a></li>
<li class="chapter" data-level="7.5" data-path="semi_structured_data.html"><a href="semi_structured_data.html#htmlcss-web-scraping"><i class="fa fa-check"></i><b>7.5</b> HTML/CSS: web scraping</a></li>
<li class="chapter" data-level="7.6" data-path="semi_structured_data.html"><a href="semi_structured_data.html#xmljson-government-databasesocial-media-scraping"><i class="fa fa-check"></i><b>7.6</b> XML/JSON: government database/social media scraping</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="semi_structured_data.html"><a href="semi_structured_data.html#governemnt-database-xml"><i class="fa fa-check"></i><b>7.6.1</b> Governemnt database (XML)</a></li>
<li class="chapter" data-level="7.6.2" data-path="semi_structured_data.html"><a href="semi_structured_data.html#social-media-api-json"><i class="fa fa-check"></i><b>7.6.2</b> Social media API (JSON)</a></li>
<li class="chapter" data-level="7.6.3" data-path="semi_structured_data.html"><a href="semi_structured_data.html#next-steps"><i class="fa fa-check"></i><b>7.6.3</b> Next steps</a></li>
<li class="chapter" data-level="7.6.4" data-path="semi_structured_data.html"><a href="semi_structured_data.html#rtweet"><i class="fa fa-check"></i><b>7.6.4</b> rtweet</a></li>
<li class="chapter" data-level="7.6.5" data-path="semi_structured_data.html"><a href="semi_structured_data.html#hydrating"><i class="fa fa-check"></i><b>7.6.5</b> Hydrating</a></li>
<li class="chapter" data-level="7.6.6" data-path="semi_structured_data.html"><a href="semi_structured_data.html#parsing-json"><i class="fa fa-check"></i><b>7.6.6</b> Parsing JSON</a></li>
<li class="chapter" data-level="7.6.7" data-path="semi_structured_data.html"><a href="semi_structured_data.html#getting-api-data-from-scratch"><i class="fa fa-check"></i><b>7.6.7</b> Getting API data from scratch</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="machine_learning.html"><a href="machine_learning.html"><i class="fa fa-check"></i><b>8</b> High-dimensional data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="machine_learning.html"><a href="machine_learning.html#overview"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="machine_learning.html"><a href="machine_learning.html#dataset"><i class="fa fa-check"></i><b>8.2</b> Dataset</a></li>
<li class="chapter" data-level="8.3" data-path="machine_learning.html"><a href="machine_learning.html#workflow-3"><i class="fa fa-check"></i><b>8.3</b> Workflow</a></li>
<li class="chapter" data-level="8.4" data-path="machine_learning.html"><a href="machine_learning.html#tidymodels"><i class="fa fa-check"></i><b>8.4</b> tidymodels</a></li>
<li class="chapter" data-level="8.5" data-path="machine_learning.html"><a href="machine_learning.html#pre-processing"><i class="fa fa-check"></i><b>8.5</b> Pre-processing</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="machine_learning.html"><a href="machine_learning.html#regression-setup"><i class="fa fa-check"></i><b>8.5.1</b> Regression setup</a></li>
<li class="chapter" data-level="8.5.2" data-path="machine_learning.html"><a href="machine_learning.html#classification-setup"><i class="fa fa-check"></i><b>8.5.2</b> Classification setup</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="machine_learning.html"><a href="machine_learning.html#supervised-learning"><i class="fa fa-check"></i><b>8.6</b> Supervised learning</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="machine_learning.html"><a href="machine_learning.html#ols-and-lasso"><i class="fa fa-check"></i><b>8.6.1</b> OLS and Lasso</a></li>
<li class="chapter" data-level="8.6.2" data-path="machine_learning.html"><a href="machine_learning.html#decision-tree"><i class="fa fa-check"></i><b>8.6.2</b> Decision tree</a></li>
<li class="chapter" data-level="8.6.3" data-path="machine_learning.html"><a href="machine_learning.html#bagging-random-forest"><i class="fa fa-check"></i><b>8.6.3</b> Bagging (Random forest)</a></li>
<li class="chapter" data-level="8.6.4" data-path="machine_learning.html"><a href="machine_learning.html#boosting-xgboost"><i class="fa fa-check"></i><b>8.6.4</b> Boosting (XGboost)</a></li>
<li class="chapter" data-level="8.6.5" data-path="machine_learning.html"><a href="machine_learning.html#stacking-superlearner"><i class="fa fa-check"></i><b>8.6.5</b> Stacking (SuperLearner)</a></li>
<li class="chapter" data-level="8.6.6" data-path="machine_learning.html"><a href="machine_learning.html#applications-2"><i class="fa fa-check"></i><b>8.6.6</b> Applications</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="machine_learning.html"><a href="machine_learning.html#unsupervised-learning"><i class="fa fa-check"></i><b>8.7</b> Unsupervised learning</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="machine_learning.html"><a href="machine_learning.html#dimension-reduction"><i class="fa fa-check"></i><b>8.7.1</b> Dimension reduction</a></li>
<li class="chapter" data-level="8.7.2" data-path="machine_learning.html"><a href="machine_learning.html#topic-modeling"><i class="fa fa-check"></i><b>8.7.2</b> Topic modeling</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="machine_learning.html"><a href="machine_learning.html#references-4"><i class="fa fa-check"></i><b>8.8</b> References</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="machine_learning.html"><a href="machine_learning.html#books"><i class="fa fa-check"></i><b>8.8.1</b> Books</a></li>
<li class="chapter" data-level="8.8.2" data-path="machine_learning.html"><a href="machine_learning.html#lecture-slides"><i class="fa fa-check"></i><b>8.8.2</b> Lecture slides</a></li>
<li class="chapter" data-level="8.8.3" data-path="machine_learning.html"><a href="machine_learning.html#blog-posts"><i class="fa fa-check"></i><b>8.8.3</b> Blog posts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="big_data.html"><a href="big_data.html"><i class="fa fa-check"></i><b>9</b> Big data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="big_data.html"><a href="big_data.html#overview-2"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="big_data.html"><a href="big_data.html#sql"><i class="fa fa-check"></i><b>9.2</b> SQL</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="big_data.html"><a href="big_data.html#learning-objectives-1"><i class="fa fa-check"></i><b>9.2.1</b> Learning objectives</a></li>
<li class="chapter" data-level="9.2.2" data-path="big_data.html"><a href="big_data.html#sql-and-r"><i class="fa fa-check"></i><b>9.2.2</b> SQL and R</a></li>
<li class="chapter" data-level="9.2.3" data-path="big_data.html"><a href="big_data.html#setup-7"><i class="fa fa-check"></i><b>9.2.3</b> Setup</a></li>
<li class="chapter" data-level="9.2.4" data-path="big_data.html"><a href="big_data.html#packages-1"><i class="fa fa-check"></i><b>9.2.4</b> Packages</a></li>
<li class="chapter" data-level="9.2.5" data-path="big_data.html"><a href="big_data.html#nyc-flights-data"><i class="fa fa-check"></i><b>9.2.5</b> NYC flights data</a></li>
<li class="chapter" data-level="9.2.6" data-path="big_data.html"><a href="big_data.html#workflow-4"><i class="fa fa-check"></i><b>9.2.6</b> Workflow</a></li>
<li class="chapter" data-level="9.2.7" data-path="big_data.html"><a href="big_data.html#things-we-didnt-cover"><i class="fa fa-check"></i><b>9.2.7</b> Things we didn’t cover</a></li>
<li class="chapter" data-level="9.2.8" data-path="big_data.html"><a href="big_data.html#references-5"><i class="fa fa-check"></i><b>9.2.8</b> References</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/jaeyk/PS239T/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Thinking for Social Scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="big_data" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Big data</h1>
<div id="overview-2" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Overview</h2>
<ul>
<li>Big data problem: data is too big to fit into memory (=local environment).</li>
<li>R reads data into random-access memory (RAM) at once and this object lives in memory entirely. So, if object.size &gt; memory.size, the process will crash R.</li>
<li>Therefore, the key to deal with big data in R is reducing the size of data you want to bring into it.</li>
</ul>
<p><strong>Techniques to deal with big data</strong></p>
<ul>
<li>Medium-sized file (1-2 GB)
<ul>
<li>Try to reduce the size of the file using slicing and dicing</li>
<li>Tools:
<ul>
<li>R:<code>data.table::fread(file path, select = c("column 1", "column 2"))</code>. This command imports data faster than <code>read.csv()</code> does.</li>
<li>Command-line: <a href="https://csvkit.readthedocs.io/en/latest/"><code>csvkit</code></a> - a suite of command-line tools to and working with CSV</li>
</ul></li>
</ul></li>
<li>Large file (&gt; 2-10 GB)
<ul>
<li>Put the data into a database and <strong>ACCESS</strong> it</li>
<li>Explore the data and pull the objects of interest</li>
</ul></li>
</ul>
<p><strong>Databases</strong></p>
<ul>
<li>Types of databases
<ul>
<li>Relational database = a <strong>collection</strong> of <strong>tables</strong> (fixed columns and rows): SQL is a staple tool to define, <strong>query</strong> (the focus of the workshop today), control, and manipulate this type of database</li>
<li>Non-relational database = a collection of documents (MongoDB), key-values (Redis and DyanoDB), wide-column stores (Cassandra and HBase), or graph (Neo4j and JanusGraph). Note that this type of database does not preclude SQL. NoSQL stands for <a href="https://www.mongodb.com/nosql-explained">“not only SQL.”</a></li>
</ul></li>
</ul>
<p><strong>Relational database example</strong></p>
<div class="figure">
<img src="https://sp.mysqltutorial.org/wp-content/uploads/2009/12/MySQL-Sample-Database-Schema.png" alt="" />
<p class="caption">Relational Database. Source: MySQL Tutorial</p>
</div>
</div>
<div id="sql" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> SQL</h2>
<ul>
<li><p>Structured Query Language. Called SEQUEL and developed by IBM Corporation in the 1970s.</p></li>
<li><p>Remains the standard language for a relational database management system.</p></li>
<li><p>It’s a DECLARATIVE language (<a href="https://www.sqlite.org/queryplanner.html">what to do &gt; how to do</a>)</p>
<ul>
<li>Database management systems figure an optimal way to execute a query (query optimization)</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1304"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1304-1"><a href="big_data.html#cb1304-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">COLUMN</span> <span class="kw">FROM</span> <span class="kw">TABLE</span> </span></code></pre></div>
<div id="learning-objectives-1" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Learning objectives</h3>
<ul>
<li><p>Embracing a new mindset: shifting from ownership (opening CSVs stored in your laptop) to access (accessing data stored in a database)</p></li>
<li><p>Learning how to use R and SQL to access and query a database</p></li>
</ul>
</div>
<div id="sql-and-r" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> SQL and R</h3>
<ul>
<li>SQL and R</li>
</ul>
<table>
<colgroup>
<col width="14%" />
<col width="85%" />
</colgroup>
<thead>
<tr class="header">
<th>SQL</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SELECT</td>
<td>select() for columns, mutate() for expressions, summarise() for aggregates</td>
</tr>
<tr class="even">
<td>FROM</td>
<td>which data frame</td>
</tr>
<tr class="odd">
<td>WHERE</td>
<td>filter()</td>
</tr>
<tr class="even">
<td>GROUP BY</td>
<td>group_by()</td>
</tr>
<tr class="odd">
<td>HAVING</td>
<td>filter() <strong>after group_by()</strong></td>
</tr>
<tr class="even">
<td>ORDER BY</td>
<td>arrange()</td>
</tr>
<tr class="odd">
<td>LIMIT</td>
<td>head()</td>
</tr>
</tbody>
</table>
<p><strong>Challenge 1</strong>
1. Can you tell me the difference in the order in which the following <code>R</code> and <code>SQL</code> code were written to manipulate data? For instance, in R, what command comes first? In contrast, in SQL, what command comes first?</p>
<ul>
<li>R example</li>
</ul>
<div class="sourceCode" id="cb1305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1305-1"><a href="big_data.html#cb1305-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1305-2"><a href="big_data.html#cb1305-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="co"># Data </span></span>
<span id="cb1305-3"><a href="big_data.html#cb1305-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>() <span class="sc">%&gt;%</span> <span class="co"># Column</span></span>
<span id="cb1305-4"><a href="big_data.html#cb1305-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>() <span class="sc">%&gt;%</span> <span class="co"># Row </span></span>
<span id="cb1305-5"><a href="big_data.html#cb1305-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>() <span class="sc">%&gt;%</span> <span class="co"># Group by </span></span>
<span id="cb1305-6"><a href="big_data.html#cb1305-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="co"># n() is one of the aggregate functions in r; it&#39;s count() used inside summarise() function </span></span>
<span id="cb1305-7"><a href="big_data.html#cb1305-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>() <span class="sc">%&gt;%</span> <span class="co"># Row </span></span>
<span id="cb1305-8"><a href="big_data.html#cb1305-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">order_by</span>() <span class="co"># Arrange </span></span></code></pre></div>
<ul>
<li>SQL example (in a SQL chunk, use <code>--</code> instead of <code>#</code> to comment)</li>
</ul>
<div class="sourceCode" id="cb1306"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1306-1"><a href="big_data.html#cb1306-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1306-2"><a href="big_data.html#cb1306-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">column</span>, aggregation (<span class="fu">count</span>())` <span class="co">-- Column</span></span>
<span id="cb1306-3"><a href="big_data.html#cb1306-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1306-4"><a href="big_data.html#cb1306-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> <span class="kw">data</span> # <span class="kw">Data</span> </span>
<span id="cb1306-5"><a href="big_data.html#cb1306-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1306-6"><a href="big_data.html#cb1306-6" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> condition <span class="co">-- Filter rows </span></span>
<span id="cb1306-7"><a href="big_data.html#cb1306-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1306-8"><a href="big_data.html#cb1306-8" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="kw">column</span> <span class="co">-- Group by</span></span>
<span id="cb1306-9"><a href="big_data.html#cb1306-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1306-10"><a href="big_data.html#cb1306-10" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> condition <span class="co">-- Filter rows after group by  </span></span>
<span id="cb1306-11"><a href="big_data.html#cb1306-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1306-12"><a href="big_data.html#cb1306-12" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> <span class="kw">column</span> <span class="co">-- Arrange </span></span></code></pre></div>
<div class="figure">
<img src="https://wizardzines.com/zines/sql/samples/from.png" alt="" />
<p class="caption">SQL Zine by by <a href="https://jvns.ca/">Julia Evans</a></p>
</div>
</div>
<div id="setup-7" class="section level3" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Setup</h3>
<p>Let’s get to work.</p>
</div>
<div id="packages-1" class="section level3" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> Packages</h3>
<ul>
<li><code>pacman::p_load()</code> reduces steps for installing and loading several packages simultaneously.</li>
</ul>
<div class="sourceCode" id="cb1307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1307-1"><a href="big_data.html#cb1307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pacman </span></span>
<span id="cb1307-2"><a href="big_data.html#cb1307-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;pacman&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;pacman&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: pacman</code></pre>
<div class="sourceCode" id="cb1309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1309-1"><a href="big_data.html#cb1309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The rest of pkgs </span></span>
<span id="cb1309-2"><a href="big_data.html#cb1309-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1309-3"><a href="big_data.html#cb1309-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1309-4"><a href="big_data.html#cb1309-4" aria-hidden="true" tabindex="-1"></a> tidyverse, <span class="co"># tidyverse packages </span></span>
<span id="cb1309-5"><a href="big_data.html#cb1309-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1309-6"><a href="big_data.html#cb1309-6" aria-hidden="true" tabindex="-1"></a> DBI, <span class="co"># using SQL queries</span></span>
<span id="cb1309-7"><a href="big_data.html#cb1309-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1309-8"><a href="big_data.html#cb1309-8" aria-hidden="true" tabindex="-1"></a> RSQLite, <span class="co"># SQLite</span></span>
<span id="cb1309-9"><a href="big_data.html#cb1309-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1309-10"><a href="big_data.html#cb1309-10" aria-hidden="true" tabindex="-1"></a> dbplyr, <span class="co"># use database with dplyr </span></span>
<span id="cb1309-11"><a href="big_data.html#cb1309-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1309-12"><a href="big_data.html#cb1309-12" aria-hidden="true" tabindex="-1"></a> glue, <span class="co"># glue to automate workflow </span></span>
<span id="cb1309-13"><a href="big_data.html#cb1309-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1309-14"><a href="big_data.html#cb1309-14" aria-hidden="true" tabindex="-1"></a> nycflights13 <span class="co"># toy data </span></span>
<span id="cb1309-15"><a href="big_data.html#cb1309-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="nyc-flights-data" class="section level3" number="9.2.5">
<h3><span class="header-section-number">9.2.5</span> NYC flights data</h3>
<ul>
<li><a href="https://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236">The flight on-time performance data</a> from the Bureau of Transportation Statistics of the U.S. government. The data goes back to 1987, and its size is more than 20 gigabytes. For practice, we only use a small subset of the original data (flight data departing NYC in 2013) provided by RStudio.</li>
</ul>
<div class="figure">
<img src="https://d33wubrfki0l68.cloudfront.net/245292d1ea724f6c3fd8a92063dcd7bfb9758d02/5751b/diagrams/relational-nycflights.png" alt="" />
<p class="caption">From RStudio.</p>
</div>
</div>
<div id="workflow-4" class="section level3" number="9.2.6">
<h3><span class="header-section-number">9.2.6</span> Workflow</h3>
<ol style="list-style-type: decimal">
<li>Create/connect to a database</li>
</ol>
<ul>
<li><p>Note that the server also can be your laptop (called <a href="https://en.wikipedia.org/wiki/Localhost#:~:text=In%20computer%20networking%2C%20localhost%20is,via%20the%20loopback%20network%20interface.">localhost</a>).</p></li>
<li><p>Short answer: To do so, you need interfaces between R and a database. We use <a href="https://github.com/r-dbi/RSQLite"><code>RSQLite</code></a> in this tutorial because it’s easy to set up.</p></li>
<li><p>Long answer: The <code>DBI</code> package in R provides a client-side interface that allows <code>dplyr</code> to work with databases. DBI is automatically installed when you installed <code>dbplyr</code>. However, you need to install a specific backend engine (a tool for communication between R and a database management system) for the database (e.g., <code>RMariaDB</code>, <code>RPostgres</code>, <code>RSQLite</code>). In this workshop, we use SQLite because it is the easiest to get started with. I love PostgreSQL because it’s open-source and also powerful to do <a href="https://www.postgresql.org/docs/current/functions.html">many amazing things</a> (e.g., text mining, geospatial analysis). If you want to build a data warehouse, an analytical platform, consider using Spark (Hadoop).</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Copy a table to the database</li>
</ol>
<ul>
<li><p>Option 1: You can create a table and insert rows manually. To do that, you also need to define the data schema (the database structure).</p></li>
<li><p>Table</p>
<ul>
<li>Collection of rows</li>
<li>Collection of columns (fields or attributes)</li>
<li>Each col has a type:
<ul>
<li>String: <code>VARCHAR(20)</code></li>
<li>Integer: <code>INTEGER</code></li>
<li>Floating-point: <code>FLOAT</code>, <code>DOUBLE</code></li>
<li>Date/time: <code>DATE</code>, <code>TIME</code>, <code>DATETIME</code></li>
</ul></li>
<li><strong>Schema</strong>: the structure of the database
<ul>
<li>The table name</li>
<li>The names and types of its columns</li>
<li>Various optional additional information
<ul>
<li><a href="https://www.w3schools.com/sql/sql_constraints.asp">Constraints</a>
<ul>
<li>Syntax: <code>column datatype constraint</code></li>
<li>Examples: <code>NOT NULL</code>, <code>UNIQUE</code>, <code>INDEX</code></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1310"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1310-1"><a href="big_data.html#cb1310-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1310-2"><a href="big_data.html#cb1310-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create table </span></span>
<span id="cb1310-3"><a href="big_data.html#cb1310-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1310-4"><a href="big_data.html#cb1310-4" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> students (</span>
<span id="cb1310-5"><a href="big_data.html#cb1310-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">id</span> <span class="dt">INT</span> AUTO_INCREMENT,</span>
<span id="cb1310-6"><a href="big_data.html#cb1310-6" aria-hidden="true" tabindex="-1"></a>    name <span class="dt">VARCHAR</span>(<span class="dv">30</span>),</span>
<span id="cb1310-7"><a href="big_data.html#cb1310-7" aria-hidden="true" tabindex="-1"></a>    birth <span class="dt">DATE</span>,</span>
<span id="cb1310-8"><a href="big_data.html#cb1310-8" aria-hidden="true" tabindex="-1"></a>    gpa <span class="dt">FLOAT</span>,</span>
<span id="cb1310-9"><a href="big_data.html#cb1310-9" aria-hidden="true" tabindex="-1"></a>    grad <span class="dt">INT</span>,</span>
<span id="cb1310-10"><a href="big_data.html#cb1310-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">PRIMARY</span> <span class="kw">KEY</span>(<span class="kw">id</span>));</span>
<span id="cb1310-11"><a href="big_data.html#cb1310-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1310-12"><a href="big_data.html#cb1310-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- Insert one additional row </span></span>
<span id="cb1310-13"><a href="big_data.html#cb1310-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1310-14"><a href="big_data.html#cb1310-14" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> students(name, birth, gpa, grad)</span>
<span id="cb1310-15"><a href="big_data.html#cb1310-15" aria-hidden="true" tabindex="-1"></a>      <span class="kw">VALUES</span> (<span class="st">&#39;Adam&#39;</span>, <span class="st">&#39;2000-08-04&#39;</span>, <span class="fl">4.0</span>, <span class="dv">2020</span>);</span></code></pre></div>
<ul>
<li>Option 2: Copy a file (object) to a table in a database using <code>copy_to</code>). We take this option as it’s fast, and we would like to focus on querying in this workshop.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Query the table</li>
</ol>
<ul>
<li>Main focus</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><p>Pull the results of interests (<strong>data</strong>) using <code>collect()</code></p></li>
<li><p>Disconnect the database</p></li>
</ol>
<div id="create-a-database" class="section level4" number="9.2.6.1">
<h4><span class="header-section-number">9.2.6.1</span> Create a database</h4>
<div class="sourceCode" id="cb1311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1311-1"><a href="big_data.html#cb1311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a backend engine </span></span>
<span id="cb1311-2"><a href="big_data.html#cb1311-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1311-3"><a href="big_data.html#cb1311-3" aria-hidden="true" tabindex="-1"></a>drv <span class="ot">&lt;-</span> RSQLite<span class="sc">::</span><span class="fu">SQLite</span>()</span>
<span id="cb1311-4"><a href="big_data.html#cb1311-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1311-5"><a href="big_data.html#cb1311-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty in-memory database </span></span>
<span id="cb1311-6"><a href="big_data.html#cb1311-6" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(drv, </span>
<span id="cb1311-7"><a href="big_data.html#cb1311-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dbname =</span> <span class="st">&quot;:memory:&quot;</span>)</span>
<span id="cb1311-8"><a href="big_data.html#cb1311-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1311-9"><a href="big_data.html#cb1311-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect to an existing database </span></span>
<span id="cb1311-10"><a href="big_data.html#cb1311-10" aria-hidden="true" tabindex="-1"></a><span class="co">#con &lt;- DBI::dbConnect(RMariaDB::MariaDB(), </span></span>
<span id="cb1311-11"><a href="big_data.html#cb1311-11" aria-hidden="true" tabindex="-1"></a> <span class="co"># host = &quot;database.rstudio.com&quot;,</span></span>
<span id="cb1311-12"><a href="big_data.html#cb1311-12" aria-hidden="true" tabindex="-1"></a> <span class="co"># user = &quot;hadley&quot;,</span></span>
<span id="cb1311-13"><a href="big_data.html#cb1311-13" aria-hidden="true" tabindex="-1"></a> <span class="co"># password = rstudioapi::askForPassword(&quot;Database password&quot;)</span></span>
<span id="cb1311-14"><a href="big_data.html#cb1311-14" aria-hidden="true" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb1311-15"><a href="big_data.html#cb1311-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1311-16"><a href="big_data.html#cb1311-16" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListTables</span>(con)</span></code></pre></div>
<pre><code>## character(0)</code></pre>
<div class="sourceCode" id="cb1313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1313-1"><a href="big_data.html#cb1313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># character(0) = NULL</span></span></code></pre></div>
<ul>
<li>Note that <code>con</code> is empty at this stage.</li>
</ul>
</div>
<div id="copy-an-object-as-a-table-to-the-database-push" class="section level4" number="9.2.6.2">
<h4><span class="header-section-number">9.2.6.2</span> Copy an object as a table to the database (push)</h4>
<div class="sourceCode" id="cb1314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1314-1"><a href="big_data.html#cb1314-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy objects to the data </span></span>
<span id="cb1314-2"><a href="big_data.html#cb1314-2" aria-hidden="true" tabindex="-1"></a><span class="co"># copy_to() comes from dplyr</span></span>
<span id="cb1314-3"><a href="big_data.html#cb1314-3" aria-hidden="true" tabindex="-1"></a><span class="fu">copy_to</span>(<span class="at">dest =</span> con, </span>
<span id="cb1314-4"><a href="big_data.html#cb1314-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">df =</span> flights)</span>
<span id="cb1314-5"><a href="big_data.html#cb1314-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1314-6"><a href="big_data.html#cb1314-6" aria-hidden="true" tabindex="-1"></a><span class="fu">copy_to</span>(<span class="at">dest =</span> con, </span>
<span id="cb1314-7"><a href="big_data.html#cb1314-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">df =</span> airports)</span>
<span id="cb1314-8"><a href="big_data.html#cb1314-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1314-9"><a href="big_data.html#cb1314-9" aria-hidden="true" tabindex="-1"></a><span class="fu">copy_to</span>(<span class="at">dest =</span> con,</span>
<span id="cb1314-10"><a href="big_data.html#cb1314-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">df =</span> planes)</span>
<span id="cb1314-11"><a href="big_data.html#cb1314-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1314-12"><a href="big_data.html#cb1314-12" aria-hidden="true" tabindex="-1"></a><span class="fu">copy_to</span>(<span class="at">dest =</span> con, </span>
<span id="cb1314-13"><a href="big_data.html#cb1314-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">df =</span> weather)</span>
<span id="cb1314-14"><a href="big_data.html#cb1314-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1314-15"><a href="big_data.html#cb1314-15" aria-hidden="true" tabindex="-1"></a><span class="co"># If you need, you can also select which columns you would like to copy:</span></span>
<span id="cb1314-16"><a href="big_data.html#cb1314-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1314-17"><a href="big_data.html#cb1314-17" aria-hidden="true" tabindex="-1"></a><span class="co"># copy_to(dest = con, </span></span>
<span id="cb1314-18"><a href="big_data.html#cb1314-18" aria-hidden="true" tabindex="-1"></a><span class="co">#          df = flights, </span></span>
<span id="cb1314-19"><a href="big_data.html#cb1314-19" aria-hidden="true" tabindex="-1"></a><span class="co">#          name = &quot;flights&quot;,</span></span>
<span id="cb1314-20"><a href="big_data.html#cb1314-20" aria-hidden="true" tabindex="-1"></a><span class="co">#          indexes = list(c(&quot;year&quot;, &quot;tailnum&quot;, &quot;dest&quot;)))</span></span></code></pre></div>
<div class="sourceCode" id="cb1315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1315-1"><a href="big_data.html#cb1315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show two tables in the database </span></span>
<span id="cb1315-2"><a href="big_data.html#cb1315-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1315-3"><a href="big_data.html#cb1315-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListTables</span>(con)</span></code></pre></div>
<pre><code>## [1] &quot;airports&quot;     &quot;flights&quot;      &quot;planes&quot;       &quot;sqlite_stat1&quot; &quot;sqlite_stat4&quot;
## [6] &quot;weather&quot;</code></pre>
<div class="sourceCode" id="cb1317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1317-1"><a href="big_data.html#cb1317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the columns/attributes/fields of a table </span></span>
<span id="cb1317-2"><a href="big_data.html#cb1317-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1317-3"><a href="big_data.html#cb1317-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListFields</span>(con, <span class="st">&quot;flights&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;year&quot;           &quot;month&quot;          &quot;day&quot;            &quot;dep_time&quot;      
##  [5] &quot;sched_dep_time&quot; &quot;dep_delay&quot;      &quot;arr_time&quot;       &quot;sched_arr_time&quot;
##  [9] &quot;arr_delay&quot;      &quot;carrier&quot;        &quot;flight&quot;         &quot;tailnum&quot;       
## [13] &quot;origin&quot;         &quot;dest&quot;           &quot;air_time&quot;       &quot;distance&quot;      
## [17] &quot;hour&quot;           &quot;minute&quot;         &quot;time_hour&quot;</code></pre>
<div class="sourceCode" id="cb1319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1319-1"><a href="big_data.html#cb1319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListFields</span>(con, <span class="st">&quot;weather&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;origin&quot;     &quot;year&quot;       &quot;month&quot;      &quot;day&quot;        &quot;hour&quot;      
##  [6] &quot;temp&quot;       &quot;dewp&quot;       &quot;humid&quot;      &quot;wind_dir&quot;   &quot;wind_speed&quot;
## [11] &quot;wind_gust&quot;  &quot;precip&quot;     &quot;pressure&quot;   &quot;visib&quot;      &quot;time_hour&quot;</code></pre>
</div>
<div id="quick-demonstrations" class="section level4" number="9.2.6.3">
<h4><span class="header-section-number">9.2.6.3</span> Quick demonstrations:</h4>
<ul>
<li><p>SELECT desired columns</p></li>
<li><p>FROM tables</p></li>
<li><p>Select all columns (*) from <code>flights</code> table and show the <code>first ten rows</code></p></li>
<li><p>Note that you can combine SQL and R commands thanks to <code>dbplyr</code>.</p></li>
<li><p>Option 1</p></li>
</ul>
<div class="sourceCode" id="cb1321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1321-1"><a href="big_data.html#cb1321-1" aria-hidden="true" tabindex="-1"></a>DBI<span class="sc">::</span><span class="fu">dbGetQuery</span>(con, </span>
<span id="cb1321-2"><a href="big_data.html#cb1321-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;SELECT * FROM flights;&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># SQL</span></span>
<span id="cb1321-3"><a href="big_data.html#cb1321-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="co"># dplyr </span></span></code></pre></div>
<pre><code>##    year month day dep_time sched_dep_time dep_delay arr_time sched_arr_time
## 1  2013     1   1      517            515         2      830            819
## 2  2013     1   1      533            529         4      850            830
## 3  2013     1   1      542            540         2      923            850
## 4  2013     1   1      544            545        -1     1004           1022
## 5  2013     1   1      554            600        -6      812            837
## 6  2013     1   1      554            558        -4      740            728
## 7  2013     1   1      555            600        -5      913            854
## 8  2013     1   1      557            600        -3      709            723
## 9  2013     1   1      557            600        -3      838            846
## 10 2013     1   1      558            600        -2      753            745
##    arr_delay carrier flight tailnum origin dest air_time distance hour minute
## 1         11      UA   1545  N14228    EWR  IAH      227     1400    5     15
## 2         20      UA   1714  N24211    LGA  IAH      227     1416    5     29
## 3         33      AA   1141  N619AA    JFK  MIA      160     1089    5     40
## 4        -18      B6    725  N804JB    JFK  BQN      183     1576    5     45
## 5        -25      DL    461  N668DN    LGA  ATL      116      762    6      0
## 6         12      UA   1696  N39463    EWR  ORD      150      719    5     58
## 7         19      B6    507  N516JB    EWR  FLL      158     1065    6      0
## 8        -14      EV   5708  N829AS    LGA  IAD       53      229    6      0
## 9         -8      B6     79  N593JB    JFK  MCO      140      944    6      0
## 10         8      AA    301  N3ALAA    LGA  ORD      138      733    6      0
##     time_hour
## 1  1357034400
## 2  1357034400
## 3  1357034400
## 4  1357034400
## 5  1357038000
## 6  1357034400
## 7  1357038000
## 8  1357038000
## 9  1357038000
## 10 1357038000</code></pre>
<ul>
<li><p>Option 2 (works faster)</p></li>
<li><p>Option 3 (automating workflow)</p>
<ul>
<li>When local variables are updated, the SQL query is also automatically updated. This approach is called <a href="https://www.php.net/manual/en/pdo.prepared-statements.php">parameterized query</a> (or prepared statement).</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1323-1"><a href="big_data.html#cb1323-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################## PREPARATION ########################</span></span>
<span id="cb1323-2"><a href="big_data.html#cb1323-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1323-3"><a href="big_data.html#cb1323-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Local variables </span></span>
<span id="cb1323-4"><a href="big_data.html#cb1323-4" aria-hidden="true" tabindex="-1"></a>tbl <span class="ot">&lt;-</span> <span class="st">&quot;flights&quot;</span></span>
<span id="cb1323-5"><a href="big_data.html#cb1323-5" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="st">&quot;dep_delay&quot;</span></span>
<span id="cb1323-6"><a href="big_data.html#cb1323-6" aria-hidden="true" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1323-7"><a href="big_data.html#cb1323-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1323-8"><a href="big_data.html#cb1323-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Glue SQL query string </span></span>
<span id="cb1323-9"><a href="big_data.html#cb1323-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that to indicate a numeric value, you don&#39;t need ``</span></span>
<span id="cb1323-10"><a href="big_data.html#cb1323-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1323-11"><a href="big_data.html#cb1323-11" aria-hidden="true" tabindex="-1"></a>sql_query <span class="ot">&lt;-</span> <span class="fu">glue_sql</span>(<span class="st">&quot;</span></span>
<span id="cb1323-12"><a href="big_data.html#cb1323-12" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT {`var`}</span></span>
<span id="cb1323-13"><a href="big_data.html#cb1323-13" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM {`tbl`}</span></span>
<span id="cb1323-14"><a href="big_data.html#cb1323-14" aria-hidden="true" tabindex="-1"></a><span class="st">  LIMIT {num} </span></span>
<span id="cb1323-15"><a href="big_data.html#cb1323-15" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;</span>, <span class="at">.con =</span> con)</span>
<span id="cb1323-16"><a href="big_data.html#cb1323-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1323-17"><a href="big_data.html#cb1323-17" aria-hidden="true" tabindex="-1"></a><span class="do">######################## EXECUTION ########################</span></span>
<span id="cb1323-18"><a href="big_data.html#cb1323-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1323-19"><a href="big_data.html#cb1323-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the query </span></span>
<span id="cb1323-20"><a href="big_data.html#cb1323-20" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(con, sql_query)</span></code></pre></div>
<pre><code>##    dep_delay
## 1          2
## 2          4
## 3          2
## 4         -1
## 5         -6
## 6         -4
## 7         -5
## 8         -3
## 9         -3
## 10        -2</code></pre>
<p><strong>Challenge 2</strong>
Can you rewrite the above code using <code>LIMIT</code> instead of <code>head(10)</code>?</p>
<ul>
<li><p>You may notice that using only SQL code makes querying faster.</p></li>
<li><p>Select <code>dep_delay</code> and <code>arr_delay</code> from flights table, show the first ten rows, then turn the result into a tibble.</p></li>
</ul>
<p><strong>Challenge 3</strong>
Could you remind me how to see the list of attributes of a table? Let’s say you want to see the attributes of <code>flights</code> table. How can you do it?</p>
<ul>
<li>Collect the selected columns and filtered rows</li>
</ul>
<div class="sourceCode" id="cb1325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1325-1"><a href="big_data.html#cb1325-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, </span>
<span id="cb1325-2"><a href="big_data.html#cb1325-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;SELECT dep_delay, arr_delay FROM flights;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1325-3"><a href="big_data.html#cb1325-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1325-4"><a href="big_data.html#cb1325-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>()</span></code></pre></div>
<ul>
<li><p>Counting rows</p>
<ul>
<li>Count all (*)</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1326-1"><a href="big_data.html#cb1326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(con, </span>
<span id="cb1326-2"><a href="big_data.html#cb1326-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;SELECT COUNT(*) </span></span>
<span id="cb1326-3"><a href="big_data.html#cb1326-3" aria-hidden="true" tabindex="-1"></a><span class="st">           FROM flights;&quot;</span>) </span></code></pre></div>
<pre><code>##   COUNT(*)
## 1   336776</code></pre>
<div class="sourceCode" id="cb1328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1328-1"><a href="big_data.html#cb1328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(con, </span>
<span id="cb1328-2"><a href="big_data.html#cb1328-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;SELECT COUNT(dep_delay)</span></span>
<span id="cb1328-3"><a href="big_data.html#cb1328-3" aria-hidden="true" tabindex="-1"></a><span class="st">           FROM flights;&quot;</span>)</span></code></pre></div>
<pre><code>##   COUNT(dep_delay)
## 1           328521</code></pre>
<ul>
<li>Count distinct values</li>
</ul>
<div class="sourceCode" id="cb1330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1330-1"><a href="big_data.html#cb1330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(con, </span>
<span id="cb1330-2"><a href="big_data.html#cb1330-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;SELECT COUNT(DISTINCT dep_delay)</span></span>
<span id="cb1330-3"><a href="big_data.html#cb1330-3" aria-hidden="true" tabindex="-1"></a><span class="st">           FROM flights;&quot;</span>)</span></code></pre></div>
<pre><code>##   COUNT(DISTINCT dep_delay)
## 1                       527</code></pre>
</div>
<div id="tidy-way-dplyr---sql" class="section level4" number="9.2.6.4">
<h4><span class="header-section-number">9.2.6.4</span> Tidy-way: dplyr -&gt; SQL</h4>
<p>Thanks to the <code>dbplyr</code> package you can use the <code>dplyr</code> syntax to query SQL.</p>
<ul>
<li>Note that pipe (%) works.</li>
</ul>
<div class="sourceCode" id="cb1332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1332-1"><a href="big_data.html#cb1332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tbl select tables</span></span>
<span id="cb1332-2"><a href="big_data.html#cb1332-2" aria-hidden="true" tabindex="-1"></a>flights <span class="ot">&lt;-</span> con <span class="sc">%&gt;%</span> <span class="fu">tbl</span>(<span class="st">&quot;flights&quot;</span>)</span>
<span id="cb1332-3"><a href="big_data.html#cb1332-3" aria-hidden="true" tabindex="-1"></a>airports <span class="ot">&lt;-</span> con <span class="sc">%&gt;%</span> <span class="fu">tbl</span>(<span class="st">&quot;airports&quot;</span>)</span>
<span id="cb1332-4"><a href="big_data.html#cb1332-4" aria-hidden="true" tabindex="-1"></a>planes <span class="ot">&lt;-</span> con <span class="sc">%&gt;%</span> <span class="fu">tbl</span>(<span class="st">&quot;planes&quot;</span>)</span>
<span id="cb1332-5"><a href="big_data.html#cb1332-5" aria-hidden="true" tabindex="-1"></a>weather <span class="ot">&lt;-</span> con <span class="sc">%&gt;%</span> <span class="fu">tbl</span>(<span class="st">&quot;weather&quot;</span>)</span></code></pre></div>
<ul>
<li><code>select</code> = <code>SELECT</code></li>
</ul>
<div class="sourceCode" id="cb1333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1333-1"><a href="big_data.html#cb1333-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb1333-2"><a href="big_data.html#cb1333-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;delay&quot;</span>))</span></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 2]
## # Database: sqlite 3.37.0 [:memory:]
##    dep_delay arr_delay
##        &lt;dbl&gt;     &lt;dbl&gt;
##  1         2        11
##  2         4        20
##  3         2        33
##  4        -1       -18
##  5        -6       -25
##  6        -4        12
##  7        -5        19
##  8        -3       -14
##  9        -3        -8
## 10        -2         8
## # … with more rows</code></pre>
<p><strong>Challenge 4</strong>
Your turn: write the same code in SQL. Don’t forget to add <code>connection</code> argument to your SQL code chunk.</p>
<ul>
<li><code>mutate</code> = <code>SELECT</code> <code>AS</code></li>
</ul>
<div class="sourceCode" id="cb1335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1335-1"><a href="big_data.html#cb1335-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb1335-2"><a href="big_data.html#cb1335-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(distance, air_time) <span class="sc">%&gt;%</span>  </span>
<span id="cb1335-3"><a href="big_data.html#cb1335-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">speed =</span> distance <span class="sc">/</span> (air_time <span class="sc">/</span> <span class="dv">60</span>)) </span></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 3]
## # Database: sqlite 3.37.0 [:memory:]
##    distance air_time speed
##       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
##  1     1400      227  370.
##  2     1416      227  374.
##  3     1089      160  408.
##  4     1576      183  517.
##  5      762      116  394.
##  6      719      150  288.
##  7     1065      158  404.
##  8      229       53  259.
##  9      944      140  405.
## 10      733      138  319.
## # … with more rows</code></pre>
<p><strong>Challenge 5</strong>
Your turn: write the same code in SQL. (
Hint: <code>mutate(new_var = var 1 * var2</code> (R) = <code>SELECT var1 * var2 AS near_var</code> (SQL)</p>
<ul>
<li><code>filter</code> = <code>WHERE</code></li>
</ul>
<div class="sourceCode" id="cb1337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1337-1"><a href="big_data.html#cb1337-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb1337-2"><a href="big_data.html#cb1337-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">==</span> <span class="dv">1</span>, day <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># filter(month ==1 &amp; day == 1) Both work in the same way.</span></span></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 19]
## # Database: sqlite 3.37.0 [:memory:]
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # … with more rows, and 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,
## #   flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,
## #   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dbl&gt;</code></pre>
<p><strong>Challenge 6</strong>
Your turn: write the same code in SQL (hint: <code>filter(condition1, condition2)</code> = <code>WHERE condition1 and condition2</code>)</p>
<p><strong>Additional tips</strong></p>
<p>Note that R and SQL operators are not exactly alike. R uses <code>!=</code> for <code>Not equal to</code>. SQL uses <code>&lt;&gt;</code> or <code>!=</code>. Furthermore, there are some cautions about using <code>NULL</code> (NA; unknown or missing): it should be <code>IS NULL</code> or <code>IS NOT NULL</code> not <code>=NULL</code> or <code>!=NULL</code> (this makes sense because NULL represents an absence of a value).</p>
<p>Another pro-tip is <a href="https://www.w3schools.com/sql/sql_like.asp"><code>LIKE</code> operator</a>, used in a <code>WHERE</code> statement to find values based on string patterns.</p>
<div class="sourceCode" id="cb1339"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1339-1"><a href="big_data.html#cb1339-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span>(origin) <span class="co">-- Distinct values from origin column</span></span>
<span id="cb1339-2"><a href="big_data.html#cb1339-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> flights</span>
<span id="cb1339-3"><a href="big_data.html#cb1339-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> origin <span class="kw">LIKE</span> <span class="st">&#39;J%&#39;</span>; <span class="co">-- Find any origin values that start with &quot;J&quot;</span></span></code></pre></div>
<div class="knitsql-table">
<table>
<caption><span id="tab:unnamed-chunk-16">Table 9.1: </span>1 records</caption>
<thead>
<tr class="header">
<th align="left">origin</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">JFK</td>
</tr>
</tbody>
</table>
</div>
<p><code>%</code> is one of the wildcards that you can use for string matching. <code>%</code> matches any number of characters. So, <code>J%</code> matches Jae, JFK, Joseph, etc. <code>_</code> is another useful wildcard and it matches exactly one character. So <code>J_</code> matches only JA, JE, etc. If wildcards are not enough, then you should consider using regular expressions.</p>
<ul>
<li><code>arrange</code> = <code>ORDER BY</code></li>
</ul>
<div class="sourceCode" id="cb1340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1340-1"><a href="big_data.html#cb1340-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb1340-2"><a href="big_data.html#cb1340-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(carrier, <span class="fu">desc</span>(arr_delay)) <span class="sc">%&gt;%</span></span>
<span id="cb1340-3"><a href="big_data.html#cb1340-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show_query</span>()</span></code></pre></div>
<pre><code>## &lt;SQL&gt;
## SELECT *
## FROM `flights`
## ORDER BY `carrier`, `arr_delay` DESC</code></pre>
<p><strong>Challenge 7</strong>
Your turn: write the same code in SQL.
Hint: <code>arrange(var1, desc(var2)</code> (R) = <code>ORDER BY var1, var2 DESC</code> (SQL)</p>
<ul>
<li><code>summarise</code> = <code>SELECT</code> <code>AS</code> and <code>group by</code> = <code>GROUP BY</code></li>
</ul>
<div class="sourceCode" id="cb1342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1342-1"><a href="big_data.html#cb1342-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb1342-2"><a href="big_data.html#cb1342-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month, day) <span class="sc">%&gt;%</span></span>
<span id="cb1342-3"><a href="big_data.html#cb1342-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">delay =</span> <span class="fu">mean</span>(dep_delay)) </span></code></pre></div>
<pre><code>## Warning: Missing values are always removed in SQL.
## Use `mean(x, na.rm = TRUE)` to silence this warning
## This warning is displayed only once per session.</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # Source:   lazy query [?? x 3]
## # Database: sqlite 3.37.0 [:memory:]
## # Groups:   month
##    month   day delay
##    &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
##  1     1     1 11.5 
##  2     1     2 13.9 
##  3     1     3 11.0 
##  4     1     4  8.95
##  5     1     5  5.73
##  6     1     6  7.15
##  7     1     7  5.42
##  8     1     8  2.55
##  9     1     9  2.28
## 10     1    10  2.84
## # … with more rows</code></pre>
<p><strong>Challenge 8</strong>
Your turn: write the same code in SQL (hint: in SQL the order should be <code>SELECT group_var1, group_var2, AVG(old_var) AS new_var</code> -&gt; <code>FROM</code> -&gt; <code>GROUP BY</code>)</p>
<ul>
<li>If you feel too much challenged, here’s a help.</li>
</ul>
<div class="sourceCode" id="cb1346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1346-1"><a href="big_data.html#cb1346-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb1346-2"><a href="big_data.html#cb1346-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month, day) <span class="sc">%&gt;%</span></span>
<span id="cb1346-3"><a href="big_data.html#cb1346-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">delay =</span> <span class="fu">mean</span>(dep_delay)) <span class="sc">%&gt;%</span></span>
<span id="cb1346-4"><a href="big_data.html#cb1346-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show_query</span>() <span class="co"># Show the SQL equivalent!</span></span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## &lt;SQL&gt;
## SELECT `month`, `day`, AVG(`dep_delay`) AS `delay`
## FROM `flights`
## GROUP BY `month`, `day`</code></pre>
<ul>
<li><p>Joins</p></li>
<li><p>Using joins is more straightforward in R than it is in SQL.</p></li>
<li><p>However, more flexible joins exist in SQL, and they are not available in R.</p>
<ul>
<li>Joins involving 3+ tables are not supported.</li>
<li>Some advanced joins available in SQL are not supported.</li>
<li>For more information, check out <a href="https://github.com/ianmcook/tidyquery/issues"><code>tidyquery</code></a> to see the latest developments.</li>
</ul></li>
<li><p>SQL command</p></li>
</ul>
<p><code>FROM one table LEFT JOIN another table ON condition = condition</code> (<code>ON</code> in SQL = <code>BY</code> in R)</p>
<div class="sourceCode" id="cb1349"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1349-1"><a href="big_data.html#cb1349-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb1349-2"><a href="big_data.html#cb1349-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> flights <span class="kw">AS</span> f</span>
<span id="cb1349-3"><a href="big_data.html#cb1349-3" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> weather <span class="kw">AS</span> w </span>
<span id="cb1349-4"><a href="big_data.html#cb1349-4" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> f.<span class="dt">year</span> <span class="op">=</span> w.<span class="dt">year</span> <span class="kw">AND</span> f.<span class="dt">month</span> <span class="op">=</span> w.<span class="dt">month</span></span></code></pre></div>
<div class="knitsql-table">
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-20">Table 9.2: </span>Displaying records 1 - 10</caption>
<colgroup>
<col width="1%" />
<col width="2%" />
<col width="1%" />
<col width="3%" />
<col width="5%" />
<col width="3%" />
<col width="3%" />
<col width="5%" />
<col width="3%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="1%" />
<col width="3%" />
<col width="3%" />
<col width="1%" />
<col width="2%" />
<col width="4%" />
<col width="2%" />
<col width="1%" />
<col width="2%" />
<col width="1%" />
<col width="1%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="3%" />
<col width="4%" />
<col width="3%" />
<col width="2%" />
<col width="3%" />
<col width="2%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">year</th>
<th align="right">month</th>
<th align="right">day</th>
<th align="right">dep_time</th>
<th align="right">sched_dep_time</th>
<th align="right">dep_delay</th>
<th align="right">arr_time</th>
<th align="right">sched_arr_time</th>
<th align="right">arr_delay</th>
<th align="left">carrier</th>
<th align="right">flight</th>
<th align="left">tailnum</th>
<th align="left">origin</th>
<th align="left">dest</th>
<th align="right">air_time</th>
<th align="right">distance</th>
<th align="right">hour</th>
<th align="right">minute</th>
<th align="right">time_hour</th>
<th align="left">origin</th>
<th align="right">year</th>
<th align="right">month</th>
<th align="right">day</th>
<th align="right">hour</th>
<th align="right">temp</th>
<th align="right">dewp</th>
<th align="right">humid</th>
<th align="right">wind_dir</th>
<th align="right">wind_speed</th>
<th align="right">wind_gust</th>
<th align="right">precip</th>
<th align="right">pressure</th>
<th align="right">visib</th>
<th align="right">time_hour</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="right">515</td>
<td align="right">2</td>
<td align="right">830</td>
<td align="right">819</td>
<td align="right">11</td>
<td align="left">UA</td>
<td align="right">1545</td>
<td align="left">N14228</td>
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">1400</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">1357034400</td>
<td align="left">EWR</td>
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">39.02</td>
<td align="right">26.06</td>
<td align="right">59.37</td>
<td align="right">270</td>
<td align="right">10.35702</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">1012.0</td>
<td align="right">10</td>
<td align="right">1357020000</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="right">515</td>
<td align="right">2</td>
<td align="right">830</td>
<td align="right">819</td>
<td align="right">11</td>
<td align="left">UA</td>
<td align="right">1545</td>
<td align="left">N14228</td>
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">1400</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">1357034400</td>
<td align="left">EWR</td>
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">39.02</td>
<td align="right">26.96</td>
<td align="right">61.63</td>
<td align="right">250</td>
<td align="right">8.05546</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">1012.3</td>
<td align="right">10</td>
<td align="right">1357023600</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="right">515</td>
<td align="right">2</td>
<td align="right">830</td>
<td align="right">819</td>
<td align="right">11</td>
<td align="left">UA</td>
<td align="right">1545</td>
<td align="left">N14228</td>
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">1400</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">1357034400</td>
<td align="left">EWR</td>
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">39.02</td>
<td align="right">28.04</td>
<td align="right">64.43</td>
<td align="right">240</td>
<td align="right">11.50780</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">1012.5</td>
<td align="right">10</td>
<td align="right">1357027200</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="right">515</td>
<td align="right">2</td>
<td align="right">830</td>
<td align="right">819</td>
<td align="right">11</td>
<td align="left">UA</td>
<td align="right">1545</td>
<td align="left">N14228</td>
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">1400</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">1357034400</td>
<td align="left">EWR</td>
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">39.92</td>
<td align="right">28.04</td>
<td align="right">62.21</td>
<td align="right">250</td>
<td align="right">12.65858</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">1012.2</td>
<td align="right">10</td>
<td align="right">1357030800</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="right">515</td>
<td align="right">2</td>
<td align="right">830</td>
<td align="right">819</td>
<td align="right">11</td>
<td align="left">UA</td>
<td align="right">1545</td>
<td align="left">N14228</td>
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">1400</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">1357034400</td>
<td align="left">EWR</td>
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">39.02</td>
<td align="right">28.04</td>
<td align="right">64.43</td>
<td align="right">260</td>
<td align="right">12.65858</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">1011.9</td>
<td align="right">10</td>
<td align="right">1357034400</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="right">515</td>
<td align="right">2</td>
<td align="right">830</td>
<td align="right">819</td>
<td align="right">11</td>
<td align="left">UA</td>
<td align="right">1545</td>
<td align="left">N14228</td>
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">1400</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">1357034400</td>
<td align="left">EWR</td>
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">37.94</td>
<td align="right">28.04</td>
<td align="right">67.21</td>
<td align="right">240</td>
<td align="right">11.50780</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">1012.4</td>
<td align="right">10</td>
<td align="right">1357038000</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="right">515</td>
<td align="right">2</td>
<td align="right">830</td>
<td align="right">819</td>
<td align="right">11</td>
<td align="left">UA</td>
<td align="right">1545</td>
<td align="left">N14228</td>
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">1400</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">1357034400</td>
<td align="left">EWR</td>
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">39.02</td>
<td align="right">28.04</td>
<td align="right">64.43</td>
<td align="right">240</td>
<td align="right">14.96014</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">1012.2</td>
<td align="right">10</td>
<td align="right">1357041600</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="right">515</td>
<td align="right">2</td>
<td align="right">830</td>
<td align="right">819</td>
<td align="right">11</td>
<td align="left">UA</td>
<td align="right">1545</td>
<td align="left">N14228</td>
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">1400</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">1357034400</td>
<td align="left">EWR</td>
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="right">39.92</td>
<td align="right">28.04</td>
<td align="right">62.21</td>
<td align="right">250</td>
<td align="right">10.35702</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">1012.2</td>
<td align="right">10</td>
<td align="right">1357045200</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="right">515</td>
<td align="right">2</td>
<td align="right">830</td>
<td align="right">819</td>
<td align="right">11</td>
<td align="left">UA</td>
<td align="right">1545</td>
<td align="left">N14228</td>
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">1400</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">1357034400</td>
<td align="left">EWR</td>
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">9</td>
<td align="right">39.92</td>
<td align="right">28.04</td>
<td align="right">62.21</td>
<td align="right">260</td>
<td align="right">14.96014</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">1012.7</td>
<td align="right">10</td>
<td align="right">1357048800</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">517</td>
<td align="right">515</td>
<td align="right">2</td>
<td align="right">830</td>
<td align="right">819</td>
<td align="right">11</td>
<td align="left">UA</td>
<td align="right">1545</td>
<td align="left">N14228</td>
<td align="left">EWR</td>
<td align="left">IAH</td>
<td align="right">227</td>
<td align="right">1400</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">1357034400</td>
<td align="left">EWR</td>
<td align="right">2013</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">41.00</td>
<td align="right">28.04</td>
<td align="right">59.65</td>
<td align="right">260</td>
<td align="right">13.80936</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">1012.4</td>
<td align="right">10</td>
<td align="right">1357052400</td>
</tr>
</tbody>
</table>
</div>
<p>Can anyone explain why SQL query using <code>dplyr</code> then translated by <code>show_query()</code> looks so complex compared to the above? (<a href="https://stackoverflow.com/questions/36808295/how-to-remove-duplicate-columns-from-join-in-sql">Hint</a>)</p>
<div class="sourceCode" id="cb1350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1350-1"><a href="big_data.html#cb1350-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb1350-2"><a href="big_data.html#cb1350-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(weather, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1350-3"><a href="big_data.html#cb1350-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show_query</span>()</span></code></pre></div>
<pre><code>## &lt;SQL&gt;
## SELECT `LHS`.`year` AS `year`, `LHS`.`month` AS `month`, `LHS`.`day` AS `day.x`, `dep_time`, `sched_dep_time`, `dep_delay`, `arr_time`, `sched_arr_time`, `arr_delay`, `carrier`, `flight`, `tailnum`, `LHS`.`origin` AS `origin.x`, `dest`, `air_time`, `distance`, `LHS`.`hour` AS `hour.x`, `minute`, `LHS`.`time_hour` AS `time_hour.x`, `RHS`.`origin` AS `origin.y`, `RHS`.`day` AS `day.y`, `RHS`.`hour` AS `hour.y`, `temp`, `dewp`, `humid`, `wind_dir`, `wind_speed`, `wind_gust`, `precip`, `pressure`, `visib`, `RHS`.`time_hour` AS `time_hour.y`
## FROM `flights` AS `LHS`
## LEFT JOIN `weather` AS `RHS`
## ON (`LHS`.`year` = `RHS`.`year` AND `LHS`.`month` = `RHS`.`month`)</code></pre>
</div>
<div id="collect-pull" class="section level4" number="9.2.6.5">
<h4><span class="header-section-number">9.2.6.5</span> Collect (pull)</h4>
<ul>
<li><p><code>collect()</code> is used to pull the data. Depending on the data size, it may take a long time to run.</p></li>
<li><p>The following code won’t work.</p></li>
</ul>
<blockquote>
<p>Error in UseMethod(“collect”) : no applicable method for ‘collect’ applied to an object of class “c(‘LayerInstance,’ ‘Layer,’ ‘ggproto,’ ‘gg’)”</p>
</blockquote>
<div class="sourceCode" id="cb1352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1352-1"><a href="big_data.html#cb1352-1" aria-hidden="true" tabindex="-1"></a>origin_flights_plot <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb1352-2"><a href="big_data.html#cb1352-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin) <span class="sc">%&gt;%</span></span>
<span id="cb1352-3"><a href="big_data.html#cb1352-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1352-4"><a href="big_data.html#cb1352-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1352-5"><a href="big_data.html#cb1352-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> origin, <span class="at">y =</span> n)) <span class="sc">%&gt;%</span></span>
<span id="cb1352-6"><a href="big_data.html#cb1352-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>()</span></code></pre></div>
<ul>
<li>This works.</li>
</ul>
<div class="sourceCode" id="cb1353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1353-1"><a href="big_data.html#cb1353-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb1353-2"><a href="big_data.html#cb1353-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin) <span class="sc">%&gt;%</span></span>
<span id="cb1353-3"><a href="big_data.html#cb1353-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1353-4"><a href="big_data.html#cb1353-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>()</span>
<span id="cb1353-5"><a href="big_data.html#cb1353-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1353-6"><a href="big_data.html#cb1353-6" aria-hidden="true" tabindex="-1"></a>origin_flights_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb1353-7"><a href="big_data.html#cb1353-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> origin, <span class="at">y =</span> n))</span>
<span id="cb1353-8"><a href="big_data.html#cb1353-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1353-9"><a href="big_data.html#cb1353-9" aria-hidden="true" tabindex="-1"></a>origin_flights_plot</span></code></pre></div>
<p><img src="08_big_data_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="disconnect" class="section level4" number="9.2.6.6">
<h4><span class="header-section-number">9.2.6.6</span> Disconnect</h4>
<div class="sourceCode" id="cb1354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1354-1"><a href="big_data.html#cb1354-1" aria-hidden="true" tabindex="-1"></a>DBI<span class="sc">::</span><span class="fu">dbDisconnect</span>(con)</span></code></pre></div>
</div>
</div>
<div id="things-we-didnt-cover" class="section level3" number="9.2.7">
<h3><span class="header-section-number">9.2.7</span> Things we didn’t cover</h3>
<div id="subquery" class="section level4" number="9.2.7.1">
<h4><span class="header-section-number">9.2.7.1</span> Subquery</h4>
<p>Subquery = a query nested inside a query</p>
<p>This is a hypothetical example inspired by <a href="https://www.dofactory.com/sql/subquery">dofactory blog post</a>.</p>
<div class="sourceCode" id="cb1355"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1355-1"><a href="big_data.html#cb1355-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> names  <span class="co">-- Outer query </span></span>
<span id="cb1355-2"><a href="big_data.html#cb1355-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> consultants</span>
<span id="cb1355-3"><a href="big_data.html#cb1355-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> <span class="kw">Id</span> <span class="kw">IN</span> (<span class="kw">SELECT</span> ConsultingId</span>
<span id="cb1355-4"><a href="big_data.html#cb1355-4" aria-hidden="true" tabindex="-1"></a>                <span class="kw">FROM</span> consulting_cases </span>
<span id="cb1355-5"><a href="big_data.html#cb1355-5" aria-hidden="true" tabindex="-1"></a>                <span class="kw">WHERE</span> <span class="kw">category</span> <span class="op">=</span> <span class="st">&#39;r&#39;</span> <span class="kw">AND</span> <span class="kw">category</span> <span class="op">=</span> <span class="st">&#39;sql&#39;</span>); <span class="co">-- Subquery </span></span></code></pre></div>
</div>
<div id="common-table-expression-with-clauses" class="section level4" number="9.2.7.2">
<h4><span class="header-section-number">9.2.7.2</span> Common table expression (WITH clauses)</h4>
<p>This is just a hypothetical example inspired by [James LeDoux’s blog post](<a href="https://jamesrledoux.com/code/sql-cte-common-table-expressions" class="uri">https://jamesrledoux.com/code/sql-cte-common-table-expressions</a>.</p>
<div class="sourceCode" id="cb1356"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1356-1"><a href="big_data.html#cb1356-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- cases about R and SQL from dlab-database </span></span>
<span id="cb1356-2"><a href="big_data.html#cb1356-2" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> r_sql_consulting_cases <span class="kw">AS</span> ( <span class="co">-- The name of the CTE expression </span></span>
<span id="cb1356-3"><a href="big_data.html#cb1356-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- The CTE query </span></span>
<span id="cb1356-4"><a href="big_data.html#cb1356-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span></span>
<span id="cb1356-5"><a href="big_data.html#cb1356-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">id</span> </span>
<span id="cb1356-6"><a href="big_data.html#cb1356-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> </span>
<span id="cb1356-7"><a href="big_data.html#cb1356-7" aria-hidden="true" tabindex="-1"></a>    dlab </span>
<span id="cb1356-8"><a href="big_data.html#cb1356-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span></span>
<span id="cb1356-9"><a href="big_data.html#cb1356-9" aria-hidden="true" tabindex="-1"></a>    tags <span class="kw">LIKE</span> <span class="st">&#39;%sql%&#39;</span></span>
<span id="cb1356-10"><a href="big_data.html#cb1356-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">AND</span></span>
<span id="cb1356-11"><a href="big_data.html#cb1356-11" aria-hidden="true" tabindex="-1"></a>    tags <span class="kw">LIKE</span> <span class="st">&#39;%r%&#39;</span></span>
<span id="cb1356-12"><a href="big_data.html#cb1356-12" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb1356-13"><a href="big_data.html#cb1356-13" aria-hidden="true" tabindex="-1"></a><span class="co">-- count the number of open cases about this consulting category </span></span>
<span id="cb1356-14"><a href="big_data.html#cb1356-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- The outer query </span></span>
<span id="cb1356-15"><a href="big_data.html#cb1356-15" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> status, <span class="fu">COUNT</span>(status) <span class="kw">AS</span> open_status_count</span>
<span id="cb1356-16"><a href="big_data.html#cb1356-16" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> dlab <span class="kw">as</span> d </span>
<span id="cb1356-17"><a href="big_data.html#cb1356-17" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> r_sql_consulting_cases <span class="kw">as</span> r</span>
<span id="cb1356-18"><a href="big_data.html#cb1356-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> d.<span class="kw">id</span> <span class="op">=</span> r.<span class="kw">id</span> </span>
<span id="cb1356-19"><a href="big_data.html#cb1356-19" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> status <span class="op">=</span> <span class="st">&#39;open&#39;</span>; </span></code></pre></div>
</div>
</div>
<div id="references-5" class="section level3" number="9.2.8">
<h3><span class="header-section-number">9.2.8</span> References</h3>
<ul>
<li><a href="https://github.com/csv2db/csv2db">csv2db</a> - for loading large CSV files in to a database</li>
<li>R Studio, <a href="https://db.rstudio.com/">Database using R</a></li>
<li>Ian Cook, <a href="https://github.com/ianmcook/rstudioconf2020/blob/master/bridging_the_gap_between_sql_and_r.pdf">“Bridging the Gap between SQL and R”</a> rstudio::conf 2020 slides
<ul>
<li><a href="https://www.youtube.com/watch?v=JwP5KdWSgqE&amp;ab_channel=RStudio">Video recording</a></li>
</ul></li>
<li>Data Carpentry contributors, <a href="https://datacarpentry.org/R-ecology-lesson/05-r-and-databases.html">SQL database and R</a>, Data Carpentry, September 10, 2019.</li>
<li><a href="https://cran.r-project.org/web/packages/dbplyr/vignettes/dbplyr.html">Introduction to dbplyr</a></li>
<li>Josh Erickson, <a href="http://dept.stat.lsa.umich.edu/~jerrick/courses/stat701/notes/sql.html">SQL in R</a>, STAT 701, University of Michigan</li>
<li><a href="https://wizardzines.com/zines/sql/">SQL zine</a> by Julia Evans</li>
<li><a href="http://harelba.github.io/q/">q</a> - a command-line tool that allows direct execution of SQL-like queries on CSVs/TSVs (and any other tabular text files)</li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="machine_learning.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PS239T.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
